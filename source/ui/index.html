<!DOCTYPE html>
<html>
<head>
	<title>Autexys</title>
	<link rel="shortcut icon" type="image/png" href="./icons/Icon.ico"/>
	<!--<link href='https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Material+Icons' rel="stylesheet">-->
	<link href='./css_icons_fonts/material_icons/material_icons.css' rel="stylesheet">
	<link href='./css_icons_fonts/roboto_font/roboto_font.css' rel="stylesheet">
	<link href="./libs/vuetify.css" rel="stylesheet">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
	
	<meta http-equiv="cache-control" content="no-cache, must-revalidate, post-check=0, pre-check=0" />
	<meta http-equiv="cache-control" content="max-age=0" />
	<meta http-equiv="expires" content="0" />
	<meta http-equiv="pragma" content="no-cache" />
	
	<style media="screen" type="text/css">
		html {
			overscroll-behavior: none;
		}
		
		[v-cloak] > * {
			display: none;
		}

		/* === Page Loading Animation === */
		
		.fade-leave-active, .fade-enter-active {
			transition: 0.7s ease;
		}
		.fade-leave-to {
			opacity: 1;
		}
		.fade-enter, .fade-leave {
			opacity: 0;
		}
		
		.loaderfadeaway-enter-active .loaderfadeaway-leave-active {
			transition: opacity .5s;
		}
		.loaderfadeaway-enter, .loaderfadeaway-leave-to {
			opacity: 0;
		}
		
		.spinner {
			margin: 100px auto;
			width: 40px;
			height: 40px;
			position: relative;
			text-align: center;
			
			-webkit-animation: sk-rotate 2.0s infinite linear;
			animation: sk-rotate 2.0s infinite linear;
		}
		.dot1, .dot2 {
			width: 60%;
			height: 60%;
			display: inline-block;
			position: absolute;
			top: 0;
			background-color: #333;
			border-radius: 100%;
			
			-webkit-animation: sk-bounce 2.0s infinite ease-in-out;
			animation: sk-bounce 2.0s infinite ease-in-out;
		}
		.dot2 {
			top: auto;
			bottom: 0;
			-webkit-animation-delay: -1.0s;
			animation-delay: -1.0s;
		}
		
		@-webkit-keyframes sk-rotate { 100% { -webkit-transform: rotate(360deg) }}
		@keyframes sk-rotate { 100% { transform: rotate(360deg); -webkit-transform: rotate(360deg) }}
		@-webkit-keyframes sk-bounce {
			0%, 100% { -webkit-transform: scale(0.0) }
			50% { -webkit-transform: scale(1.0) }
		}
		@keyframes sk-bounce {
			0%, 100% { 
				transform: scale(0.0);
				-webkit-transform: scale(0.0);
			} 50% { 
				transform: scale(1.0);
				-webkit-transform: scale(1.0);
			}
		}
		
		/* === Images === */
		
		img {
			width: auto;
			height: auto;
			max-width: 100%;
			margin-left: auto;
			margin-right: auto;
		}
		.zoomableImage:hover {
			opacity: 0.7;
			transition: opacity 0.5s;
		}
		.zoomedImage {
			position: fixed;
			z-index: 500;
			background-color: rgb(255,255,255);
			max-width: 80vw;
			max-height: 90vh;
			top: 50vh;
			right: 50vw;
			transform: translate(50%, -50%);
		}
		
		/* === Expansion Panels === */
		
		.padlessexpansionpanel .v-expansion-panel-content__wrap {
			padding: 0px;
		}
		
		/* === Layout === */
		
		.roundedcorners {
			border-radius: 7px
		}

	</style>
</head>
<body>
	<div id="app" style="background-color: #3f688c;">
		
		<transition name="loaderfadeaway">
			<div style="height:100%; width: 100%; z-index: 1000; position: absolute; background-color: #3f688c;" v-if="pageLoading">
				<div class="spinner">
					<div class="dot1" style="background-color: #ffffff;"></div>
					<div class="dot2" style="background-color: #ffffff;"></div>
				</div>
			</div>
		</transition>
		
		<transition name="fade" mode="out-in" appear>
			<v-app v-cloak>
				
				<!-- Start of app sidebar/toolbar -->
				
				<v-system-bar app color="color_base darken-1"></v-system-bar>
				
				<v-navigation-drawer app dark clipped fixed v-model="drawer" class="color_base pt-4">
					<v-list dense>
						<v-list-item @click="setTopLevelPage('dashboard')">
							<v-list-item-action><v-icon>dashboard</v-icon></v-list-item-action>
							<v-list-item-content><v-list-item-title>Dashboard</v-list-item-title></v-list-item-content>
						</v-list-item>
						<v-list-item @click="setTopLevelPage('experimentRunner')">
							<v-list-item-action><v-avatar tile size="24" class="roundedcorners" color="color_runner"><v-icon>play_circle_outline</v-icon></v-avatar></v-list-item-action>
							<v-list-item-content><v-list-item-title>Experiment Runner</v-list-item-title></v-list-item-content>
						</v-list-item>
						<v-list-item @click="setTopLevelPage('scheduleBuilder')">
							<v-list-item-action><v-avatar tile size="24" class="roundedcorners" color="color_builder"><v-icon>schedule</v-icon></v-avatar></v-list-item-action>
							<v-list-item-content><v-list-item-title>Schedule Builder</v-list-item-title></v-list-item-content>
						</v-list-item>
						<v-list-item @click="setTopLevelPage('stepper')">
							<v-list-item-action><v-avatar tile size="24" class="roundedcorners" color="color_browser"><v-icon>view_carousel</v-icon></v-avatar></v-list-item-action>
							<v-list-item-content><v-list-item-title>Browser</v-list-item-title></v-list-item-content>
						</v-list-item>
						<v-list-item @click="setTopLevelPage('benchtop')">
							<v-list-item-action><v-avatar tile size="24" class="roundedcorners" color="color_benchtop"><v-icon>speed</v-icon></v-avatar></v-list-item-action>
							<v-list-item-content><v-list-item-title>Benchtop</v-list-item-title></v-list-item-content>
						</v-list-item>
						<template v-if="defaultParameters['Deployment'] === 'Development'">
							<v-divider></v-divider>
							<v-list-group prepend-icon="cloud" color="white">
								<template v-slot:activator>
									<v-list-item-content>
										<v-list-item-title>Applications</v-list-item-title>
									</v-list-item-content>
								</template>
								<v-list-item @click="setTopLevelPage('performance')">
									<v-list-item-action><v-icon>speed</v-icon></v-list-item-action>
									<v-list-item-content><v-list-item-title>Performance</v-list-item-title></v-list-item-content>
								</v-list-item>
								<v-list-item @click="setTopLevelPage('ptSensor')">
									<v-list-item-action><v-icon>opacity</v-icon></v-list-item-action>
									<v-list-item-content><v-list-item-title>PT Sensor</v-list-item-title></v-list-item-content>
								</v-list-item>
							</v-list-group>
						</template>
						<v-divider></v-divider>
						<v-list-item @click="setTopLevelPage('settings')" v-if="defaultParameters['Deployment'] === 'Development'">
							<v-list-item-action><v-icon>settings</v-icon></v-list-item-action>
							<v-list-item-content><v-list-item-title>Settings</v-list-item-title></v-list-item-content>
						</v-list-item>
						<v-list-item @click="setTopLevelPage('about')">
							<v-list-item-action><v-icon>info_outline</v-icon></v-list-item-action>
							<v-list-item-content><v-list-item-title>About</v-list-item-title></v-list-item-content>
						</v-list-item>
						<v-list-item @click="setTopLevelPage('documentation')" v-if="defaultParameters['Deployment'] === 'Development'">
							<v-list-item-action><v-icon>info_outline</v-icon></v-list-item-action>
							<v-list-item-content><v-list-item-title>Documentation</v-list-item-title></v-list-item-content>
						</v-list-item>
					</v-list>
				</v-navigation-drawer>
				
				<v-app-bar app dark dense clipped-left fixed color="color_base darken-1">
					<v-app-bar-nav-icon @click.stop="drawer = !drawer"></v-app-bar-nav-icon>
					<v-toolbar-title>Autexys</v-toolbar-title>
					<v-spacer></v-spacer>
					<v-toolbar-items>
						<v-menu bottom left offset-y :close-on-content-click="false" v-if="topLevelPage === 'stepper'">
							<template v-slot:activator="{ on }">
								<v-btn v-on="on" text><v-icon left>settings</v-icon>Settings</v-btn>
							</template>
							<v-card light tile style="overflow-y: scroll; max-height:65vh">
								<v-list class="pt-4">
									<a-item-edit-group :settings.sync="primaryPlotSettings"></a-item-edit-group>
									<a-item-edit-group :settings.sync="modePlotSettings"></a-item-edit-group>
								</v-list>
							</v-card>
							<v-card light tile>
								<v-list>
									<v-list-item>
										<v-btn @click="resetPlotSettings(); updatePlotSettings();" :disabled="!hasModifiedPlotSettings()">Reset</v-btn>
										<v-spacer></v-spacer>
										<v-btn @click="updatePlotSettings()">Save</v-btn>
									</v-list-item>
								</v-list>
							</v-card>
						</v-menu>
						<v-menu bottom left offset-y min-width="250" :close-on-content-click="false">
							<template v-slot:activator="{ on }">
								<v-btn v-on="on" light icon width="80" @click="getAvailableMeasurementSystems()">
									<v-avatar size="36" color="info">
										<v-icon color="success" v-if="connectedMeasurementSystem">wifi</v-icon>
										<v-icon v-if="!connectedMeasurementSystem">wifi_off</v-icon>
									</v-avatar>
								</v-btn>
							</template>
							<v-card light tile style="overflow-y: scroll; max-height:65vh">
								<v-list>
									<v-list-item v-for="system in availableMeasurementSystems" :key="system.uniqueID" 
										@click="connectToMeasurementSystem(system)">
										<v-list-item-avatar :color="(connectedMeasurementSystem && connectedMeasurementSystem.uniqueID === system.uniqueID)? 'success' : 'info'">
											<v-icon dark>wifi</v-icon>
										</v-list-item-avatar>
										<v-tooltip bottom>
											<template v-slot:activator="{ on: tooltip }">
												<v-list-item-content v-on="{ ...tooltip }">
													<v-list-item-title>{{ system.name }}</v-list-item-title>
												</v-list-item-content>
											</template>
											<span>{{ system.type }}: {{ system.uniqueID }}</span>
										</v-tooltip>
										<v-list-item-action>
											<v-btn icon @click.stop="disconnectFromMeasurementSystem()" v-if="(connectedMeasurementSystem && connectedMeasurementSystem.uniqueID === system.uniqueID)">
												<v-icon color="info">cancel</v-icon>
											</v-btn>
										</v-list-item-action>
									</v-list-item>
									<template v-if="!availableMeasurementSystems.length">
										<v-list-item>
											<v-list-item-content><v-list-item-title>
												{{ noSystemsConnectedMessage }}
											</v-list-item-title></v-list-item-content>
										</v-list-item>
										<v-list-item v-if="true">
											<v-spacer></v-spacer>
											<v-btn @click.stop="getAvailableMeasurementSystems()"><v-icon left>refresh</v-icon>Refresh</v-btn>
											<v-spacer></v-spacer>
										</v-list-item>
									</template>
								</v-list>
							</v-card>
						</v-menu>
						<v-tooltip bottom nudge-top="4" :disabled="!workspaceDataFolderPath">
							<template v-slot:activator="{ on: tooltip }">
								<v-btn depressed small color="color_base darken-1" class="onClickFolderBrowser" v-on="{ ...tooltip }"><v-icon left>folder</v-icon>{{ workspaceDataFolderPath | formatFolderBaseName }}</v-btn>
							</template>
							<span>Workspace: {{ workspaceDataFolderPath }}</span>
						</v-tooltip>
						<v-menu bottom left offset-y min-width="250">
							<template v-slot:activator="{ on }">
								<v-btn v-on="on" text><v-icon left>people</v-icon>{{ user }}</v-btn>
							</template>
							<v-card style="max-height:85vh">
								<v-list light>
									<v-list-item v-for="u in users" :key="u" @click="goToUser(u)">
										<v-list-item-avatar color="color_base"><v-icon dark>account_circle</v-icon></v-list-item-avatar>
										<v-list-item-content><v-list-item-title>{{ u }}</v-list-item-title></v-list-item-content>
									</v-list-item>
								</v-list>
							</v-card>
						</v-menu>
					</v-toolbar-items>
				</v-app-bar>
				
				<!-- End of app sidebar/toolbar -->
				
				<v-content>
					
					<!-- Start of gettingstarted --> 
					
					<v-card flat class="ma-4" v-if="topLevelPage === 'gettingstarted'">
						<v-container class="pt-10">
							<v-row dense class="pb-6">
								<v-col cols="2"></v-col>
								<v-tooltip bottom nudge-top="30">
									<template v-slot:activator="{ on: tooltip }">
										<v-col cols="8" v-on="{ ...tooltip }">
											<v-text-field light filled rounded readonly :disabled="true" label="Workspace Folder" prepend-icon="folder" v-model="workspaceDataFolderPath"></v-text-field>
										</v-col>
									</template>
									<span>This is where all user and data files will be saved.</span>
								</v-tooltip>
								<v-col cols="2">
									<v-btn dark color="color_base" class="onClickFolderBrowser ma-2"><v-icon left>folder</v-icon>Choose</v-btn>
								</v-col>
								<v-spacer></v-spacer>
							</v-row>
							<v-row dense class="pb-6">
								<v-col cols="2"></v-col>
								<v-tooltip bottom nudge-top="30">
									<template v-slot:activator="{ on: tooltip }">
										<v-col cols="8" v-on="{ ...tooltip }">
											<v-text-field light outlined rounded clearable label="User" prepend-icon="account_circle" v-model="user"></v-text-field>
										</v-col>		
									</template>	
									<span>This sets up an initial user folder within your workspace.</span>
								</v-tooltip>	
								<v-spacer></v-spacer>
							</v-row>
							<v-row dense>
								<v-spacer></v-spacer>
								<v-tooltip bottom :color="(workspaceDataFolderPath && user) ? 'success' : 'info'">
									<template v-slot:activator="{ on: tooltip }">
										<v-col cols="4" v-on="{ ...tooltip }">
											<v-btn large block rounded color="success" class="white--text" :disabled="!workspaceDataFolderPath || !user" @click="addUser(user); setTopLevelPage('dashboard');">Get Started</v-btn>
										</v-col>	
									</template>
									<span v-if="!workspaceDataFolderPath || !user">Setup a workspace and username above to get started.</span>
									<span v-if="workspaceDataFolderPath && user">Go to dashboard!</span>
								</v-tooltip>			
								<v-spacer></v-spacer>
							</v-row>
						</v-container>
					</v-card>
					
					<!-- End of gettingstarted -->
					<!-- Start of dashboard -->
					
					<v-card flat class="ma-4" v-if="topLevelPage === 'dashboard'">
						<v-container>
							<v-row class="pa-2">
								<v-col cols="4" class="pa-1">
									<v-tooltip bottom nudge-top="4" color="color_runner">
										<template v-slot:activator="{ on: tooltip }">
											<v-toolbar dark class="color_runner roundedcorners" v-on="{ ...tooltip }" style="cursor: pointer;" @click="setTopLevelPage('experimentRunner')" >
												<v-toolbar-title>
													Experiment Runner
												</v-toolbar-title>
												<v-spacer></v-spacer>
												<v-icon>play_circle_outline</v-icon>
											</v-toolbar>
										</template>
										<span>Get started collecting data</span>
									</v-tooltip>
								</v-col>
								
								<v-col cols="4" class="pa-1">
									<v-tooltip bottom nudge-top="4" color="color_builder">
										<template v-slot:activator="{ on: tooltip }">
											<v-toolbar dark class="color_builder roundedcorners" v-on="{ ...tooltip }" style="cursor: pointer;" @click="setTopLevelPage('scheduleBuilder')">
												<v-toolbar-title>
													Schedule Builder
												</v-toolbar-title>
												<v-spacer></v-spacer>
												<v-icon>schedule</v-icon>
											</v-toolbar>	
										</template>
										<span>Design and refine your custom experiments</span>
									</v-tooltip>
								</v-col>
								
								<v-col cols="4" class="pa-1">
									<v-tooltip bottom nudge-top="4" color="color_browser">
										<template v-slot:activator="{ on: tooltip }">
											<v-toolbar dark class="color_browser roundedcorners" v-on="{ ...tooltip }" style="cursor: pointer;" @click="setTopLevelPage('stepper')">
												<v-toolbar-title>
													Browser
												</v-toolbar-title>
												<v-spacer></v-spacer>
												<v-icon>view_carousel</v-icon>
											</v-toolbar>
										</template>
										<span>View and analyze the results</span>
									</v-tooltip>
								</v-col>
							</v-row>
						</v-container>
						
						<v-card class="ma-3 mt-5" v-if="recentActivity.length">
							<v-toolbar dark dense class="color_base darken-1">
								<v-toolbar-title>
									Recent Activity
								</v-toolbar-title>
								
								<v-spacer></v-spacer>
								
								<v-toolbar-items class="pt-2">
									<v-chip light small class="ma-1" color="white" @click="setRecentActivityCategory('project')" 
									v-model="['project', 'wafer', 'chip', 'device'].includes(recentActivityCategory)">Projects</v-chip>
									<v-chip light small class="ma-1" color="white" @click="setRecentActivityCategory('wafer')" 
									v-model="['wafer', 'chip', 'device'].includes(recentActivityCategory)">Wafers</v-chip>
									<v-chip light small class="ma-1" color="white" @click="setRecentActivityCategory('chip')" 
									v-model="['chip', 'device'].includes(recentActivityCategory)">Chips</v-chip>
									<v-chip light small class="ma-1" color="white" @click="setRecentActivityCategory('device')" 
									v-model="['device'].includes(recentActivityCategory)">Devices</v-chip>
								</v-toolbar-items>
								
								<v-spacer></v-spacer>

								<v-menu bottom left offset-y :close-on-content-click="false">
									<template v-slot:activator="{ on }">
										<v-btn v-on="on" text>Filter</v-btn>
									</template>
									<v-card light>
										<v-list class="pt-4">
											<v-list-item>
												<v-autocomplete dense clearable label="Project" v-model="recentActivityProject" 
												:items="recentActivity.map( entry => entry['project'] )"
												:disabled="false"></v-autocomplete>
											</v-list-item>
											<v-list-item>
												<v-autocomplete dense clearable label="Wafer" v-model="recentActivityWafer" 
												:items="recentActivity.map( entry => entry['wafer'] ).filter( entry => entry !== undefined )"
												:disabled="!recentActivityIncludesCategory(['wafer', 'chip', 'device'])"></v-autocomplete>
											</v-list-item>
											<v-list-item>
												<v-autocomplete dense clearable label="Chip" v-model="recentActivityChip" 
												:items="recentActivity.map( entry => entry['chip'] ).filter( entry => entry !== undefined )"
												:disabled="!recentActivityIncludesCategory(['chip', 'device'])"></v-autocomplete>
											</v-list-item>
											<v-list-item>
												<v-autocomplete dense clearable label="Device" v-model="recentActivityDevice" 
												:items="recentActivity.map( entry => entry['device'] ).filter( entry => entry !== undefined )"
												:disabled="!recentActivityIncludesCategory(['device'])"></v-autocomplete>
											</v-list-item>
										</v-list>
									</v-card>
								</v-menu>
								
								<v-btn icon @click="resetDashboard(); getAll();"><v-icon>refresh</v-icon></v-btn>
							</v-toolbar>
							
							<v-data-table must-sort :items="recentActivity" :headers="dynamicRecentActivityTableHeaders" 
								:sort-by="'modified'" :sort-desc="true"
								:footer-props="{
									itemsPerPageOptions: [10,50,-1],
								}">
								<template v-slot:body="{ items }">
									<tbody>
										<tr v-for="item in items" :key="item.user + item.project + item.wafer + item.chip + item.device" @click="setTopLevelPage('stepper'); goToDirectly(item.project, item.wafer, item.chip, item.device);">
											<td v-if="recentActivityHeaders.find(h => h.value ==='user').visible">{{ item.user }}</td>
											<td v-if="recentActivityHeaders.find(h => h.value ==='project').visible">{{ item.project }}</td>
											<td v-if="recentActivityHeaders.find(h => h.value ==='wafer').visible">{{ item.wafer }}</td>
											<td v-if="recentActivityHeaders.find(h => h.value ==='chip').visible">{{ item.chip }}</td>
											<td v-if="recentActivityHeaders.find(h => h.value ==='device').visible">{{ item.device }}</td>
											<td v-if="recentActivityHeaders.find(h => h.value ==='modified').visible">{{ new Date(item.modified*1000).toLocaleDateString() }}</td>
										</tr>
									</tbody>
								</template>
							</v-data-table>
						</v-card>
						<v-card outlined class="ma-4" v-if="!recentActivity.length">
							<v-card-title>Recent Activity</v-card-title>
							<v-card-subtitle>{{ noDataToShowMessage }}</v-card-subtitle>
						</v-card>
					</v-card>
					
					<!-- End of dashboard -->
					<!-- Start of browser -->
					
					<v-stepper v-if="topLevelPage === 'stepper'" v-model="stepperPage" style="height:100%;">
						<v-stepper-header>
							<v-stepper-step step="1" :complete="stepperPage > 1" :editable="stepperPage > 1" edit-icon="folder" 
											color="color_browser darken-1">Projects</v-stepper-step>
							<v-divider></v-divider>
							<v-stepper-step step="2" :complete="stepperPage > 2" :editable="stepperPage > 2" edit-icon="bubble_chart"
											color="color_browser darken-1">Wafers</v-stepper-step>
							<v-divider></v-divider>
							<v-stepper-step step="3" :complete="stepperPage > 3" :editable="stepperPage > 3" edit-icon="apps"
											color="color_browser darken-1">Chips</v-stepper-step>
							<v-divider></v-divider>
							<v-stepper-step step="4" :complete="stepperPage > 4" :editable="stepperPage > 4" edit-icon="memory"
											color="color_browser darken-1">Devices</v-stepper-step>
							<v-divider></v-divider>
							<v-stepper-step step="5" :complete="stepperPage > 5" :editable="stepperPage > 5" edit-icon="assignment"
											color="color_browser darken-1">Experiments</v-stepper-step>
							<v-divider></v-divider>
							<v-stepper-step step="6" :complete="stepperPage > 6" :editable="stepperPage > 6" 
											color="color_browser darken-1">Experiment</v-stepper-step>
						</v-stepper-header>
						
						<v-stepper-items>
							
							<v-stepper-content step="1">
								<v-card v-if="(stepperPage > 0) && (projects.length)" flat>
									<v-toolbar dark class="color_browser">
										<v-toolbar-title>
											Projects
										</v-toolbar-title>
										<v-spacer></v-spacer>
										<v-text-field v-model="projectTableSearch" class="ma-2" light solo rounded color="color_browser" background-color="info" append-icon="search" label="Search" single-line hide-details clearable></v-text-field>
										<v-btn icon @click="getAll()"><v-icon>refresh</v-icon></v-btn>
									</v-toolbar>
									<v-data-table must-sort :items="projects" :headers="projectTableHeaders" 
										:search="projectTableSearch" no-results-text="Your search did not return any results."
										:custom-filter="caseInsensitiveDataTableFilter"
										:footer-props="{
											itemsPerPageOptions: [10,50,-1],
										}">
										<template v-slot:body="{ items }">
											<tbody>
												<tr v-for="item in items" :key="item.name" @click="goToProject(item.name)">
													<td>{{ item.name }}</td>
												</tr>
											</tbody>
										</template>
									</v-data-table>
								</v-card>
								<v-card outlined v-if="!projects.length">
									<v-card-title>Projects</v-card-title>
									<v-card-subtitle>{{ noDataToShowMessage }}</v-card-subtitle>
								</v-card>
							</v-stepper-content>
							
							<v-stepper-content step="2">
								<v-card v-if="stepperPage > 1" flat>
									<v-toolbar dark class="color_browser">
										<v-btn icon @click="goBack(); getProjects()"><v-icon>arrow_back</v-icon></v-btn>
										<v-toolbar-title>
											Wafers
										</v-toolbar-title>
										<v-spacer></v-spacer>
										<v-text-field v-model="waferTableSearch" class="ma-2" light solo rounded color="color_browser" background-color="info" append-icon="search" label="Search" single-line hide-details clearable></v-text-field>
										<v-btn icon @click="getAll()"><v-icon>refresh</v-icon></v-btn>
									</v-toolbar>
									<v-data-table must-sort :items="wafers" :headers="waferTableHeaders" 
										:search="waferTableSearch" no-results-text="Your search did not return any results."
										:custom-filter="caseInsensitiveDataTableFilter"
										:footer-props="{
											itemsPerPageOptions: [10,50,-1],
										}">
										<template v-slot:body="{ items }">
											<tbody>
												<tr v-for="item in items" :key="item.name" @click="goToWafer(item.name)">
													<td>{{ item.name }}</td>
													<td>{{ item.path }}</td>
													<td>{{ new Date(item.modificationTime*1000).toLocaleDateString() }}</td>
													<td>{{ item.size | formatFileSize }}</td>
													<td><v-chip light>{{ item.chipCount }}</v-chip></td>
													<td>{{ item.indexCount }}</td>
													<td>{{ item.experimentCount }}</td>
												</tr>
											</tbody>
										</template>
									</v-data-table>
								</v-card>
							</v-stepper-content>
							
							<v-stepper-content step="3">
								<v-card v-if="stepperPage > 2" flat>
									<v-toolbar dark class="color_browser">
										<v-btn icon @click="goBack(); getWafers()"><v-icon>arrow_back</v-icon></v-btn>
										<v-toolbar-title>
											"{{ wafer }}" Chips
										</v-toolbar-title>
										<v-spacer></v-spacer>
										<v-text-field v-model="chipTableSearch" class="ma-2" light solo rounded color="color_browser" background-color="info" append-icon="search" label="Search" single-line hide-details clearable></v-text-field>
										<v-btn icon @click="getAll()"><v-icon>refresh</v-icon></v-btn>
									</v-toolbar>
									<v-data-table must-sort :items="chips" :headers="chipTableHeaders" 
										:search="chipTableSearch" no-results-text="Your search did not return any results."
										:custom-filter="caseInsensitiveDataTableFilter"
										:footer-props="{
											itemsPerPageOptions: [10,50,-1],
										}">
										<template v-slot:body="{ items }">
											<tbody>
												<tr v-for="item in items" :key="item.name" @click="goToChip(item.name)">
													<td>{{ item.name }}</td>
													<td>{{ item.path }}</td>
													<td>{{ new Date(item.modificationTime*1000).toLocaleDateString() }}</td>
													<td>{{ item.size | formatFileSize }}</td>
													<td><v-chip light>{{ item.deviceCount }}</v-chip></td>
													<td>{{ item.indexCount }}</td>
													<td>{{ item.experimentCount }}</td>
												</tr>
											</tbody>
										</template>
									</v-data-table>
								</v-card>
							</v-stepper-content>
							
							<v-stepper-content step="4">
								<v-card v-if="stepperPage > 3" flat>
									<v-toolbar dark class="color_browser">
										<v-btn icon @click="goBack(); getChips();"><v-icon>arrow_back</v-icon></v-btn>
										<v-toolbar-title>
											"{{ wafer }}{{ chip }}" Devices
										</v-toolbar-title>
										<v-spacer></v-spacer>
										<v-tooltip left>
											<template v-slot:activator="{ on: tooltip }">
												<v-btn fab small color="info" @click="copyHTMLStringToClip(devices.map(d => d.name))" v-on="{ ...tooltip }"><v-icon color="color_browser">format_list_bulleted</v-icon></v-btn>
											</template>
											<span>Copy device list</span>
										</v-tooltip>
										<v-text-field v-model="deviceTableSearch" class="ma-2" light solo rounded color="color_browser" background-color="info" append-icon="search" label="Search" single-line hide-details clearable></v-text-field>
										<v-btn icon @click="getAll()"><v-icon>refresh</v-icon></v-btn>
									</v-toolbar>
									<v-data-table must-sort :items="devices" :headers="deviceTableHeaders" 
										:search="deviceTableSearch" no-results-text="Your search did not return any results."
										:custom-filter="caseInsensitiveDataTableFilter"
										:footer-props="{
											itemsPerPageOptions: [10,50,-1],
										}">
										<template v-slot:body="{ items }">
											<tbody>
												<tr v-for="item in items" :key="item.name" @click="goToDevice(item.name)">
													<td>{{ item.name }}</td>
													<td>{{ item.path }}</td>
													<td>{{ new Date(item.modificationTime*1000).toLocaleString() }}</td>
													<td>{{ item.size | formatFileSize }}</td>
													<td>{{ item.indexCount }}</td>
													<td><v-chip light>{{ item.experimentCount }}</v-chip></td>
												</tr>
											</tbody>
										</template>
									</v-data-table>
								</v-card>

								<v-card v-if="stepperPage == 4 " flat>
									<v-toolbar dark class="color_browser darken-1">
										<v-toolbar-title>
											"{{ wafer }}{{ chip }}" Chip Summary Plots
										</v-toolbar-title>
										<v-spacer></v-spacer>
										<v-toolbar-items>
											<v-menu bottom left offset-y :close-on-content-click="false" :nudge-width="200">
												<template v-slot:activator="{ on }">
													<v-btn v-on="on" text><v-icon>settings</v-icon></v-btn>
												</template>
												<v-card light tile style="overflow-y: scroll; max-height:65vh">
													<v-list class="pt-4">
														<a-item-edit-group :settings.sync="chipSummarySettings"></a-item-edit-group>
													</v-list>
												</v-card>
												<v-card light tile>
													<v-list>
														<v-list-item>
															<v-btn @click="resetChipSummarySettings(); updatePlotSettings();" :disabled="!hasModifiedPlotSettings()">Reset</v-btn>
															<v-spacer></v-spacer>
															<v-btn @click="updatePlotSettings()">Save</v-btn>
														</v-list-item>
													</v-list>
												</v-card>
											</v-menu>
										</v-toolbar-items>
										<v-toolbar-items class="pt-5 pb-5 ml-6">
											<v-tooltip top>
												<template v-slot:activator="{ on }">
													<v-switch v-on="on" color="white" label="" v-model="enableChipSummaryPlots"></v-switch>
												</template>
												<span>Show</span>
											</v-tooltip>
										</v-toolbar-items>
									</v-toolbar>
									
									<v-container>
										<v-row dense v-if="enableChipSummaryPlots">
											<v-col xs="12" sm="6" md="4" lg="3" xl="2" v-for="possiblePlot in possibleChipPlots" :key="possiblePlot['type']">
												<v-card>
													<v-toolbar dark dense class="color_base">
														<v-toolbar-title>
															 {{ possiblePlot['name']? possiblePlot['name'] : possiblePlot['type'] }}
														</v-toolbar-title>
													</v-toolbar>
													
													<a-zoomable-image src="" :srcdata="'/chipPlots/'+user+'/'+project+'/'+wafer+'/'+chip+'/'+possiblePlot['type'] + cacheBust + '&plotSettings=' + encodeURI(JSON.stringify(plotSettings))"></a-zoomable-image>
												</v-card>
											</v-col>
										</v-row>
									</v-container>
								</v-card>
							</v-stepper-content>

							<v-stepper-content step="5">
								<v-card v-if="stepperPage > 4" flat>
									<v-toolbar dark class="color_browser">
										<v-btn icon @click="goBack(); getDevices();"><v-icon>arrow_back</v-icon></v-btn>
										<v-toolbar-title>
											"{{ wafer }}{{ chip }} {{ device }}" Experiments
										</v-toolbar-title>
										<v-spacer></v-spacer>
										<v-text-field v-model="experimentTableSearch" class="ma-2" light solo rounded color="color_browser" background-color="info" append-icon="search" label="Search" single-line hide-details clearable></v-text-field>
										<v-btn icon @click="getAll()"><v-icon>refresh</v-icon></v-btn>
									</v-toolbar>
									<v-data-table must-sort :items="experimentsWithIndexes" :headers="experimentTableHeaders" 
										:search="experimentTableSearch" no-results-text="Your search did not return any results."
										:custom-filter="caseInsensitiveDataTableFilter"
										:sort-by="'startIndexes.experimentNumber'" :sort-desc="true"
										:footer-props="{
											itemsPerPageOptions: [10,50,-1],
										}">
										<template v-slot:body="{ items }">
											<tbody>
												<tr v-for="item in items" :key="item.name" @click="goToExperiment(item.i)">
													<td>{{ item.startIndexes.experimentNumber }}</td>
													<td><v-chip light :color="getRunTypeColor(item.runType)">{{ item.runType }}<template v-if="item.parametersHistoryGenerated && item.experimentNumber == experiments[experiments.length-1].experimentNumber"> - Running</template></v-chip></td>
													<td>{{ item.MeasurementSystem.systemType }}</td>
													<td>{{ item.uiComputed.indexCount }}</td>
												</tr>
											</tbody>
										</template>
									</v-data-table>
								</v-card>
								
								<v-card v-if="stepperPage == 5" flat>
									<v-toolbar dark class="color_browser darken-1">
										<v-toolbar-title>
											"{{ wafer }}{{ chip }} {{ device }}" Device Summary Plots
										</v-toolbar-title>
										<v-spacer></v-spacer>
										<v-toolbar-items class="pt-5 pb-5 ml-6">
											<v-tooltip top>
												<template v-slot:activator="{ on }">
													<v-switch v-on="on" color="white" label="" v-model="enableDeviceSummaryPlots"></v-switch>
												</template>
												<span>Show</span>
											</v-tooltip>
										</v-toolbar-items>
									</v-toolbar>
									
									<v-container>
										<v-row dense v-if="enableDeviceSummaryPlots">
											<v-col xs="12" sm="6" md="4" lg="3" xl="2" v-for="possiblePlot in possibleDevicePlots" :key="possiblePlot['type']">
												<v-card>
													<v-toolbar dark dense class="color_base">
														<v-toolbar-title>
															  {{ possiblePlot['name']? possiblePlot['name'] : possiblePlot['type'] }}
														</v-toolbar-title>
													</v-toolbar> 
													
													<a-zoomable-image src="" :srcdata="'/devicePlots/'+user+'/'+project+'/'+wafer+'/'+chip+'/'+device+'/'+possiblePlot['type'] + cacheBust + '&plotSettings=' + encodeURI(JSON.stringify(plotSettings))"></a-zoomable-image>
												</v-card>
											</v-col>
										</v-row>
									</v-container>
								</v-card>
								
							</v-stepper-content>
							
							<v-stepper-content step="6">
								<v-card v-if="stepperPage > 5 && experiments.length > experimentIndex" flat>
									<v-toolbar dark class="color_browser ">
										<v-btn icon @click="goBack(); getExperiments();"><v-icon>arrow_back</v-icon></v-btn>
										<v-toolbar-title>
											"{{ wafer }}{{ chip }} {{ device }}" Experiment #{{ experiment.startIndexes.experimentNumber }}
										</v-toolbar-title>
										<v-btn icon @click="goToExperiment(experimentIndex - 1)" :disabled="experimentIndex <= 0" class="ml-4"><v-icon right>arrow_back_ios</v-icon></v-btn>
										<v-btn icon @click="goToExperiment(experimentIndex + 1)" :disabled="experimentIndex >= experiments.length - 1"><v-icon>arrow_forward_ios</v-icon></v-btn>
										<v-spacer></v-spacer>
										<v-tooltip left>
											<template v-slot:activator="{ on: tooltip }">
												<v-btn class="ma-2 color_browser--text" color="info" v-on="{ ...tooltip }" :href="'/saveCSV/'+user+'/'+project+'/'+wafer+'/'+chip+'/'+device+'/'+experiment.startIndexes.experimentNumber+'/data.csv' + cacheBust + '&plotSettings=' + encodeURI(JSON.stringify(plotSettings))">Export<v-icon right color="color_browser">save_alt</v-icon></v-btn>
											</template>
											<span>Download CSV</span>
										</v-tooltip>
										<v-btn icon @click="getAll(); newCacheBust();"><v-icon>refresh</v-icon></v-btn>
									</v-toolbar>
									
									<v-container>
										<v-row dense>
											<v-col xs="12" sm="6" md="4" lg="3" xl="2" v-for="possiblePlot in experiment.possiblePlots" :key="possiblePlot['type'] + experimentIndex">
												<v-card>
													<v-toolbar dark dense class="color_base">
														<v-toolbar-title>
															 {{ possiblePlot['name']? possiblePlot['name'] : possiblePlot['type'] }}
														</v-toolbar-title>
														
														<v-spacer></v-spacer>
														
														<v-menu bottom left offset-y>
															<template v-slot:activator="{ on }">
																<v-btn v-on="on" icon><v-icon>settings</v-icon></v-btn>
															</template>
															<!-- !this.$parent.getElementsByClassName('zoomableImage')[0].complete -->
															<v-list dense light>
																<v-list-item @click="copyHTMLImageToClip('/plots/'+user+'/'+project+'/'+wafer+'/'+chip+'/'+device+'/'+experiment.startIndexes.experimentNumber+'/'+possiblePlot['type'] + cacheBust + '&plotSettings=' + encodeURI(JSON.stringify(plotSettings)))">
																	<v-list-item-action><v-icon dense>photo</v-icon></v-list-item-action>
																	<v-list-item-title>Copy</v-list-item-title>
																</v-list-item>
																<v-list-item @click="disabledPlots.push(possiblePlot['type'])">
																	<v-list-item-action><v-icon dense>photo</v-icon></v-list-item-action>
																	<v-list-item-title>Disable</v-list-item-title>
																</v-list-item>
																<v-list-item @click="removeValueFromArray(possiblePlot['type'], disabledPlots)">
																	<v-list-item-action><v-icon dense>photo</v-icon></v-list-item-action>
																	<v-list-item-title>Enable</v-list-item-content>
																</v-list-item>
															</v-list>
														</v-menu>
													</v-toolbar>
													
													<template v-if="!disabledPlots.includes(possiblePlot['type'])">
														<a-zoomable-image src="" :srcdata="'/plots/'+user+'/'+project+'/'+wafer+'/'+chip+'/'+device+'/'+experiment.startIndexes.experimentNumber+'/'+possiblePlot['type'] + cacheBust + '&plotSettings=' + encodeURI(JSON.stringify(plotSettings))"></a-zoomable-image>
													</template>
												</v-card>
											</v-col>
										</v-row>
									</v-container>
		
									<v-card class="ma-1" color="info">
										<v-toolbar dark dense class="info mb-4">
											<v-toolbar-title>
												Notes
											</v-toolbar-title>
											<v-spacer></v-spacer>
											<v-snackbar absolute shaped v-model="noteClearDialog" color="info darken-1">
												<v-icon dark left>warning</v-icon>
													Are you sure you want to clear the notes for this experiment?
												<v-btn light color="white" @click="noteClearDialog = false">Cancel</v-btn>
												<v-btn color="info darken-2" @click="noteClearDialog = false; clearNote();">Clear</v-btn>
											</v-snackbar>
											<v-tooltip left color="info darken-1" :disabled="!noteContent">
												<template v-slot:activator="{ on: tooltip }">
													<v-btn icon :disabled="!noteContent" v-on="{ ...tooltip }" @click="noteClearDialog = true"><v-icon>clear</v-icon></v-btn>
												</template>
												<span>Clear Notes</span>
											</v-tooltip>
										</v-toolbar>
										<v-textarea readonly solo flat auto-grow rows="1" class="mr-4 ml-4 mb-n8" background-color="info" v-model="noteContent" v-if="noteContent"></v-textarea>
										<v-row class="mr-4 ml-4" align="end">
											<v-textarea solo auto-grow rows="2" class="mr-4 mb-n4" label="Enter a new note here. Press the button to save." v-model="noteAddition"></v-textarea>
										
											<v-btn class="mb-4" dark color="color_browser" @click="addNote(experiment)"><v-icon left>add</v-icon>Add To Notes</v-btn>
										</v-row>
									</v-card>
								
									<v-card class="ma-1 mt-2">
										<v-toolbar dark dense class="color_browser ">
											<v-toolbar-title>
												Data Export
											</v-toolbar-title>
											<v-spacer></v-spacer>
											<v-tooltip left>
												<template v-slot:activator="{ on: tooltip }">
													<v-btn class="ma-2 color_browser--text" color="info" v-on="{ ...tooltip }" :href="'/saveCSV/'+user+'/'+project+'/'+wafer+'/'+chip+'/'+device+'/'+experiment.startIndexes.experimentNumber+'/data.csv' + cacheBust + '&plotSettings=' + encodeURI(JSON.stringify(plotSettings))">Export<v-icon right color="color_browser">save_alt</v-icon></v-btn>
												</template>
												<span>Download CSV</span>
											</v-tooltip>
										</v-toolbar>
										
										<v-card-actions class="ma-1">
											<v-tooltip top>
												<template v-slot:activator="{ on }">
													<v-btn v-on="on" @click="copyHTMLStringToClip(experiment['dataFolderSpecificAbs'])">
														Copy File Location
													</v-btn>
												</template>
												<span>{{ experiment['dataFolderSpecificAbs'] }}</span>
											</v-tooltip>
											
											<v-chip dark class="ma-2" :color="getRunTypeColor(experiment['runType'])" v-for="file in experiment['dataFiles']" :key="file">
												{{file}}
											</v-chip>
										</v-card-actions>
									</v-card>	
									
									<v-card class="ma-1" v-if="experiment.runType.includes('AFM') || experiment.runType.includes('SGM')">
										<v-toolbar dark dense class="color1 ">
											<v-toolbar-title>
												Corresponding AFM Images
											</v-toolbar-title>
										</v-toolbar>
										<div>
											V<sub>GS</sub> = {{_.get(experiment, 'runConfigs.' + experiment['runType'] + '.gateVoltageSetPoint', '')}} V</br>
											V<sub>DS</sub> = {{_.get(experiment, 'runConfigs.' + experiment['runType'] + '.drainVoltageSetPoint', '')}} V</br>
											V<sub>tip</sub> = {{_.get(experiment, 'associatedAFMs.bestMatch.NapTipVoltage', '')}} V</br>
											d<sub>tip</sub> = {{1e9*_.get(experiment, 'associatedAFMs.bestMatch.NapHeight', '')}} nm</br>
										</div>
									</v-card>
									
									<v-card class="ma-1 mt-2 mb-2">
										<v-expansion-panels dark hover accordion>
											<v-expansion-panel class="color_builder" v-for="section in Object.keys(experiment)" :key="section" v-if="['Identifiers', 'runConfigs', 'MeasurementSystem', 'DeviceCycling', 'startIndexes', 'endIndexes'].includes(section)">
												<v-expansion-panel-header>{{ section }}</v-expansion-panel-header>
												<v-expansion-panel-content>
													<v-data-table light hide-default-header hide-default-footer 
														:items="_.toPairs(experiment[section])" :headers="[{'text':'Property'},{'text':'Value'}]">
														<template v-slot:body="{ items }">
															<tbody>
																<tr v-for="item in items" :key="item[0]">
																	<td> {{ item[0] }}</td>
																	<td> {{ item[1] }}</td>
																</tr>
															</tbody>
														</template>
													</v-data-table>
												</v-expansion-panel-content>
											</v-expansion-panel>
										</v-expansion-panels>
									</v-card>
																		
								</v-card>
							</v-stepper-content>
						</v-stepper-items>
					</v-stepper>
					
					<!-- End of browser -->
					<!-- Start of sched builder -->
					
					<v-card flat class="ma-4" v-if="topLevelPage === 'scheduleBuilder'">
						<v-card>
							<v-toolbar dark dense class="color_builder ">
								<v-toolbar-title>
									Schedule Builder
								</v-toolbar-title>
								
								<v-spacer></v-spacer>
								
								<v-menu bottom left offset-y :close-on-content-click="false">
									<template v-slot:activator="{ on }">
										<v-btn v-on="on" icon><v-icon>folder</v-icon></v-btn>
									</template>
									<v-card light>
										<v-toolbar dark dense class="color_builder lighten-1">
											<v-toolbar-title>
												Load Schedule File
											</v-toolbar-title>
											<v-spacer></v-spacer>
											<v-btn icon @click="resetScheduleLoadPath()" :disabled="!isValidScheduleLoadPath()">
												<v-icon>settings_backup_restore</v-icon>
											</v-btn>
										</v-toolbar>
										
										<v-list class="pt-4">
											<v-list-item>
												<v-autocomplete dense clearable v-model="builderLoadUser" label="User" :items="Object.keys(userDefinedScheduleNames)" @change="builderLoadProject = ''; builderLoadFileName = '';"></v-autocomplete>
											</v-list-item>
											<v-list-item>
												<v-autocomplete dense clearable v-model="builderLoadProject" label="Project" :items="Object.keys(_.get(userDefinedScheduleNames, [builderLoadUser], {}))" @change="builderLoadFileName = '';"></v-autocomplete>
											</v-list-item>
											<v-list-item>
												<v-autocomplete dense clearable v-model="builderLoadFileName" label="File Name" :items="_.get(userDefinedScheduleNames, [builderLoadUser, builderLoadProject], [])"></v-autocomplete>
											</v-list-item>
										</v-list>
										
										<v-card light>
											<v-list>
												<v-list-item>
													<v-spacer></v-spacer>
													<v-tooltip top :disabled="!isValidScheduleLoadPath()">
														<template v-slot:activator="{ on }">
															<v-btn v-on="on" @click="loadSchedule()" :disabled="!isValidScheduleLoadPath()">Load Schedule File</v-btn>
														</template>
														<span>Workspace/{{ builderLoadUser }}/{{ builderLoadProject }}/schedules/{{ builderLoadFileName }}.json</span>
													</v-tooltip>
													<v-spacer></v-spacer>
												</v-list-item>
											</v-list>
										</v-card>
									</v-card>
								</v-menu>
								
								<v-btn icon @click="resetScheduleBuilder()" :disabled="!hasModifiedScheduleObjects()"><v-icon>settings_backup_restore</v-icon></v-btn>
							</v-toolbar>
							
							<v-expansion-panels hover accordion>
								<v-expansion-panel v-for="scheduleObject, scheduleObjectIndex in scheduleObjects" :key="scheduleObjectIndex" prepend-icon="expand_more">
									<v-expansion-panel-header>
										<v-row align="center">
											<v-col class="mt-0 mb-0 pt-0 pb-0">
												Job {{ scheduleObjectIndex + 1 }}: {{ _.get(scheduleObjects[scheduleObjectIndex], 'runType.default') }}
											</v-col>
										
											<v-spacer></v-spacer>
										
											<v-col class="mt-0 mb-0 pt-0 pb-0">
												<v-tooltip top>
													<template v-slot:activator="{ on: tooltip }">
														<v-btn icon @click.stop="moveScheduleJobUp(scheduleObjectIndex)" v-on="{ ...tooltip }" :disabled="scheduleObjectIndex == 0"><v-icon>arrow_upward</v-icon></v-btn>
													</template>
													<span>Move job up</span>
												</v-tooltip>
												<v-tooltip top>
													<template v-slot:activator="{ on: tooltip }">
														<v-btn icon @click.stop="moveScheduleJobDown(scheduleObjectIndex)" v-on="{ ...tooltip }"  :disabled="scheduleObjectIndex >= scheduleObjects.length - 1"><v-icon>arrow_downward</v-icon></v-btn>
													</template>
													<span>Move job down</span>
												</v-tooltip>
												<v-tooltip top>
													<template v-slot:activator="{ on: tooltip }">
														<v-btn icon @click.stop="copyScheduleObject(scheduleObjectIndex)" v-on="{ ...tooltip }"><v-icon>file_copy</v-icon></v-btn>
													</template>
													<span>Copy job</span>
												</v-tooltip>
												<v-tooltip top>
													<template v-slot:activator="{ on: tooltip }">
														<v-btn icon @click.stop="pasteScheduleObject(scheduleObjectIndex)" v-on="{ ...tooltip }"><v-icon>save_alt</v-icon></v-btn>
													</template>
													<span>Paste job</span>
												</v-tooltip>
												<v-tooltip top>
													<template v-slot:activator="{ on: tooltip }">
														<v-btn icon @click.stop="addScheduleJob(scheduleObjectIndex)" v-on="{ ...tooltip }"><v-icon>add_circle</v-icon></v-btn>
													</template>
													<span>Add new job after</span>
												</v-tooltip>
												<v-tooltip top>
													<template v-slot:activator="{ on: tooltip }">
														<v-btn icon @click.stop="removeScheduleJob(scheduleObjectIndex)" v-on="{ ...tooltip }"><v-icon>cancel</v-icon></v-btn>
													</template>
													<span>Delete job</span>
												</v-tooltip>
											</v-col>
										</v-row>
									</v-expansion-panel-header>
									
									<v-expansion-panel-content>
										<a-schedule-job-edit :job.sync="scheduleObjects[scheduleObjectIndex]" :job-default="scheduleObjectDefault"></a-schedule-job-edit>
									</v-expansion-panel-content>
								</v-expansion-panel>
							</v-expansion-panels>
							
							<v-card class="ma-4 pb-1" v-if="scheduleBuilderPreview && nonTrivialScheduleObjects()">
								<v-toolbar dark dense class="info">
									<v-toolbar-title>
										Preview Schedule File
									</v-toolbar-title>
								</v-toolbar>
								<v-card outlined class="ma-2 mb-1">
									<v-card-text class="text-no-wrap" style="overflow-x: scroll">
										<template v-for="schedLine in scheduleLines">
											{{ schedLine }} <br>
										</template>
									</v-card-text>
								</v-card>
							</v-card>
							<!-- <v-btn fab small dark bottom right absolute @click="addScheduleJob(0)"><v-icon>add</v-icon></v-btn> -->
						</v-card>
						
						<v-row no-gutters>
							<v-col cols="6">
								<v-card class="mt-3" v-if="nonTrivialScheduleObjects()">
									<v-toolbar dark dense class="color_builder">
										<v-toolbar-title>
											Save Schedule File
										</v-toolbar-title>
										<v-spacer></v-spacer>
										<v-btn icon @click="resetScheduleSavePath()" :disabled="!isValidScheduleSavePath()">
											<v-icon>settings_backup_restore</v-icon>
										</v-btn>
									</v-toolbar>
									
									<v-container>
										<v-row dense>
											<v-col cols="4" class="pt-0 pb-0">
												<v-combobox clearable v-model="builderSaveUser" label="User" :items="Object.keys(userDefinedScheduleNames)">
													<template slot="no-data">
														<v-list-item><v-list-item-content><v-list-item-title>
															No results. Continuing will create a new user.
														</v-list-item-title></v-list-item-content></v-list-item>
													</template>
												</v-combobox>
											</v-col>
											<v-col cols="4" class="pt-0 pb-0">
												<v-combobox clearable v-model="builderSaveProject" label="Project" :items="Object.keys(_.get(userDefinedScheduleNames, [builderSaveUser], {}))">
													<template slot="no-data">
														<v-list-item><v-list-item-content><v-list-item-title>
															No results. Continuing will create a new project.
														</v-list-item-title></v-list-item-content></v-list-item>
													</template>
												</v-combobox>
											</v-col>
											<v-col cols="4" class="pt-0 pb-0"> 
												<v-combobox clearable v-model="builderSaveFileName" label="File Name" :items="_.get(userDefinedScheduleNames, [builderSaveUser, builderSaveProject], [])">
													<template slot="no-data">
														<v-list-item><v-list-item-content><v-list-item-title>
															No results. Continuing will create a new file.
														</v-list-item-title></v-list-item-content></v-list-item>
													</template>
												</v-combobox>
											</v-col>
										</v-row>
									</v-container>
									
									<v-snackbar absolute shaped v-model="scheduleBuilderSaveDialog" color="color_builder" :timeout="2000">
										<v-icon dark left>done</v-icon>
										Save Complete
										<v-btn text @click="scheduleBuilderSaveDialog = false">OK</v-btn>
									</v-snackbar>
									
									<v-card-actions>
										<v-switch class="ml-1" label="Preview" v-model="scheduleBuilderPreview"></v-switch>
										<v-spacer></v-spacer>
										<v-tooltip top :disabled="!isValidScheduleSavePath()" class="ml-2">
											<template v-slot:activator="{ on }">
												<v-btn v-on="on" @click="saveSchedule()" :disabled="!isValidScheduleSavePath()">Save Schedule File</v-btn>
											</template>
											<span>Workspace/{{ builderSaveUser }}/{{ builderSaveProject }}/schedules/{{ builderSaveFileName }}.json</span>
										</v-tooltip>
									</v-card-actions>
								</v-card>
							</v-col>
						</v-row>
					</v-card>
					
					<!-- End of sched builder -->
					<!-- Start of experiment runner -->
					
					<v-card flat class="ma-4" v-if="topLevelPage === 'experimentRunner'">
						<v-card>
							<v-toolbar dark dense class="color_runner">
								<v-toolbar-title>
									Experiment Runner
								</v-toolbar-title>
								<v-spacer></v-spacer>
								<v-btn icon @click="runnerReset()" :disabled="(runnerChoice === '') && (!showProgress)"><v-icon>settings_backup_restore</v-icon></v-btn>
							</v-toolbar>
							
							<v-container class="pa-5">
								<v-row dense>
									<v-col sm="6" md="3" lg="3">
										<v-select filled label="Experiment Type" v-model="runnerChoice" 
										:items="['Schedule File'].concat(standardScheduleNames)"
										:menu-props="{'maxHeight': 450}"></v-select>
									</v-col>
									
									<template v-if="runnerChoice === 'Schedule File'">
										<v-col sm="6" md="3" lg="3">
											<v-autocomplete outlined clearable v-model="runnerUser" label="User" :items="Object.keys(userDefinedScheduleNames)" @change="runnerProject = ''; runnerFileName = '';"></v-autocomplete>
										</v-col>
										<v-col sm="6" md="3" lg="3">
											<v-autocomplete outlined clearable v-model="runnerProject" label="Project" :items="Object.keys(_.get(userDefinedScheduleNames, [runnerUser], {}))" @change="runnerFileName = '';"></v-autocomplete>
										</v-col>
										<v-col sm="6" md="3" lg="3">
											<v-autocomplete outlined clearable v-model="runnerFileName" label="File Name" :items="_.get(userDefinedScheduleNames, [runnerUser, runnerProject], [])"></v-autocomplete>
										</v-col>
									</template>
								</v-row>
							
								<template v-if="(runnerChoice !== '') && (runnerUser && runnerProject && runnerFileName) && (runnerScheduleObjects.length === 1) && (runnerVerboseScheduleObjects.length === 1)">
									<v-expansion-panels>
										<v-expansion-panel class="grey lighten-4">
											<v-expansion-panel-header><div style="font-weight: bold;">Options</div></v-expansion-panel-header>
											
											<v-expansion-panel-content>
												<v-container>
													<v-row dense>
														
														<v-col cols="3">
															<v-list class="roundedcorners">
																<v-list-item>
																	<v-list-item-content><v-list-item-title style="font-weight: bold">
																		Identifiers
																	</v-list-item-title></v-list-item-content>
																</v-list-item>
																<template v-if="!runnerToggleAdvancedSettings && Object.keys(runnerScheduleObjects[0]).includes('Identifiers')">
																	<a-item-edit-group :settings.sync="runnerScheduleObjects[0]['Identifiers']"></a-item-edit-group>
																</template>
																<template v-if="runnerToggleAdvancedSettings || !Object.keys(runnerScheduleObjects[0]).includes('Identifiers')">
																	<a-item-edit-group :settings.sync="runnerVerboseScheduleObjects[0]['Identifiers']"></a-item-edit-group>
																</template>
															</v-list>
															
															<template v-if="runnerToggleAdvancedSettings">
																<v-list class="mt-3 roundedcorners">
																	<v-list-item>
																		<v-list-item-content><v-list-item-title style="font-weight: bold">
																			Measurement System
																		</v-list-item-title></v-list-item-content>
																	</v-list-item>
																	<a-item-edit-group :settings.sync="runnerVerboseScheduleObjects[0]['MeasurementSystem']"></a-item-edit-group>
																</v-list>
															</template>
															
															<template v-if="runnerToggleAdvancedSettings && (!standardScheduleNames.includes(runnerChoice))">
																<v-list class="mt-3 roundedcorners">
																	<v-select filled class="ma-4" label="Run Type" v-model="runnerVerboseScheduleObjects[0]['runType']['default']" :items="Object.keys(JSON.parse(JSON.stringify(runnerVerboseScheduleObjects[0]['runConfigs'] || {})))"></v-select>
																</v-list>
															</template>
														</v-col>
														
														<v-col cols="3" v-if="runnerVerboseScheduleObjects[0]['MeasurementSystem']['deviceCycling']['default']">
															<v-list class="roundedcorners">
																<v-list-item>
																	<v-list-item-content><v-list-item-title style="font-weight: bold">
																		Device Cycling
																	</v-list-item-title></v-list-item-content>
																</v-list-item>
																<template v-if="!runnerToggleAdvancedSettings && Object.keys(runnerScheduleObjects[0]).includes('DeviceCycling')">
																	<a-item-edit-group :settings.sync="runnerScheduleObjects[0]['DeviceCycling']"></a-item-edit-group>
																</template>
																<template v-if="runnerToggleAdvancedSettings">
																	<a-item-edit-group :settings.sync="runnerVerboseScheduleObjects[0]['DeviceCycling']"></a-item-edit-group>
																</template>
															</v-list>
														</v-col>
													
														<v-col cols="3" v-for="runConfig,runType in runnerScheduleObjects[0]['runConfigs']" :key="runType">
															<v-list class="roundedcorners">
																<v-list-item>
																	<v-list-item-content><v-list-item-title style="font-weight: bold">
																		{{ runType }}
																	</v-list-item-title></v-list-item-content>
																</v-list-item>
																<template v-if="!runnerToggleAdvancedSettings">
																	<a-item-edit-group :settings.sync="runnerScheduleObjects[0]['runConfigs'][runType]"></a-item-edit-group>
																</template>
																<template v-if="runnerToggleAdvancedSettings">
																	<a-item-edit-group :settings.sync="runnerVerboseScheduleObjects[0]['runConfigs'][runType]"></a-item-edit-group>
																</template>
															</v-list>
														</v-col>
														
														<template v-if="['GateSweep', 'DrainSweep','StaticBias','RapidBias','SmallSignal','AutoGateSweep','AutoDrainSweep','AutoStaticBias'].includes(runnerScheduleObjects[0]['runType']['default'])">
															<v-spacer></v-spacer>
															<v-col :cols="(runnerVerboseScheduleObjects[0]['MeasurementSystem']['deviceCycling']['default'] || Object.keys(runnerScheduleObjects[0]['runConfigs']).length > 1)? 3 : 4">
																<v-expansion-panels flat class="roundedcorners" v-model="runnerShowPreview">
																	<v-expansion-panel class="roundedcorners">
																		<v-expansion-panel-header>
																			<div style="font-weight:bold;font-size:12pt">Preview</div>
																		</v-expansion-panel-header>
																		<v-expansion-panel-content class="padlessexpansionpanel">
																			<a-zoomable-image class="white roundedcorners" :key="runnerChoice" src="" :srcdata="'/parameterPlots/'+runnerUser+'/'+runnerProject+'/'+runnerFileName+'/'+runnerLoadingFromDefaults+'/' + cacheBust"></a-zoomable-image>
																		</v-expansion-panel-content>
																	</v-expansion-panel>
																</v-expansion-panels>
															</v-col>
														</template>
														
													</v-row>
												</v-container>
												
												<v-row>
													<v-switch class="ml-6 mt-0" label="Advanced" v-model="runnerToggleAdvancedSettings"></v-switch>
													<v-spacer></v-spacer>
													<v-btn class="mr-6" small @click="runnerSaveScheduleFile()" :disabled="!isNecessaryToSaveRunnerScheduleFile()">Save</v-btn>
												</v-row>
											</v-expansion-panel-content>
											
										</v-expansion-panel>
									</v-expansion-panels>
								</template>
								
								<template v-else-if="(runnerChoice !== '') && (runnerUser && runnerProject && runnerFileName) && (runnerScheduleObjects.length > 1) && (runnerVerboseScheduleObjects.length > 1)">
									<v-chip-group>
										<v-menu bottom right offset-y :close-on-content-click="false" v-for="scheduleObject, scheduleObjectIndex in runnerScheduleObjects" :key="scheduleObjectIndex">
											<template v-slot:activator="{ on }">
												<v-chip v-on="on" label :color="getRunTypeColor(scheduleObject['runType']['default'])" class="mr-2">{{ scheduleObjectIndex + 1 }}. {{ scheduleObject['runType']['default'] }}</v-chip>
											</template>
											<v-card>
												<v-row dense>
													<v-col v-if="scheduleObject['Identifiers']">
														<v-list>
															<v-list-item>
																<v-list-item-content><v-list-item-title style="font-weight: bold">
																	Identifiers
																</v-list-item-title></v-list-item-content>
															</v-list-item>
															<a-item-edit-group :settings.sync="runnerScheduleObjects[scheduleObjectIndex]['Identifiers']"></a-item-edit-group>
														</v-list>
													</v-col>
													<v-col v-for="runConfig,runType in scheduleObject['runConfigs']" :key="runType">
														<v-list>
															<v-list-item>
																<v-list-item-content><v-list-item-title style="font-weight: bold">
																	{{ runType }}
																</v-list-item-title></v-list-item-content>
															</v-list-item>
															<a-item-edit-group :settings.sync="runnerScheduleObjects[scheduleObjectIndex]['runConfigs'][runType]"></a-item-edit-group>
														</v-list>
													</v-col>
												</v-row>
												<v-row>
													<v-spacer></v-spacer>
													<v-btn class="mr-6 mb-3" small @click="runnerSaveScheduleFile()" :disabled="!isNecessaryToSaveRunnerScheduleFile()">Save</v-btn>
												</v-row>
											</v-card>
										</v-menu>
									</v-chip-group>
								</template>
								
								<template v-else>
									<v-list class="pa-0">
										<v-list-item>
										</v-list-item>
									</v-list>
								</template>
							
								<template v-if="runnerChoice !== ''">
									<v-list class="mt-2">
										<v-list-item class="pa-0">
											<v-row no-gutters align="center" justify="end">
												<v-list-item-content v-if="runnerChoice === 'Schedule File' && (runnerUser && runnerProject && runnerFileName)" style="overflow-x: scroll">
													Schedule file: Workspace/{{ runnerUser }}/{{ runnerProject }}/schedules/{{ runnerFileName }}.json
												</v-list-item-content>
												<template v-if="runnerChoice === 'Schedule File'">
													<v-btn class="ml-3" @click="runnerClear(); runnerSaveScheduleFile(runnerStart);" 
													:disabled="!(runnerUser && runnerProject && runnerFileName)">Launch Schedule File.</v-btn>
												</template>
												<template v-if="runnerChoice !== 'Schedule File'">
													<v-btn class="ml-3" @click="runnerClear(); runnerSaveScheduleFile(runnerStart);" 
													:disabled="!isPossibleToSaveRunnerScheduleFile()">Launch {{ runnerChoice }}</v-btn>
												</template>
												<v-btn class="ml-3" @click="runnerStop()" 
													:disabled="(!dispatcherRunning) || (dispatcherStopping)">Stop</v-btn>
											</v-row>
										</v-list-item>
									</v-list>
								</template>
								
							</v-container>
						</v-card>
						
						<v-card class="mt-3" v-if="showProgress">
							<v-toolbar dark dense :color="dispatcherRunning? 'color_runner' : 'success'">
								<v-avatar size="36" color="info lighten-1" class="mr-3">
									<v-icon color="color_runner" v-if="dispatcherRunning">hourglass_empty</v-icon>
									<v-icon color="success" v-if="!dispatcherRunning">done</v-icon>
								</v-avatar>
								<v-toolbar-title>
									{{ dispatcherRunning? 'Progress' : 'Complete' }} 
								</v-toolbar-title>
								<v-spacer></v-spacer>		
								<v-toolbar-title>
									{{experimentProgressTimer.current - experimentProgressTimer.start | formatTimestamp}}
									<v-icon class="pb-1">timer</v-icon>
								</v-toolbar-title>
							</v-toolbar>
							
							<v-list>
								<a-progress-bar-timed v-for="barID in ['Dispatcher', 'Group1', 'Group2', 'Sweep']" :key="barID" 
								:visible="experimentProgressModel[barID].visible" 
								:title="experimentProgressModel[barID].title + experimentProgressModel[barID].name" 
								:valuestart="experimentProgressModel[barID].start" 
								:valuecurrent="experimentProgressModel[barID].current" 
								:valuemaximum="experimentProgressModel[barID].end"></a-progress-bar-timed>
								
								<a-progress-bar-timed 
								:visible="experimentProgressModel['Procedure'].visible" 
								:title="experimentProgressModel['Procedure'].title + experimentProgressModel['Procedure'].name" 
								:valuestart="experimentProgressModel['Procedure'].start" 
								:valuecurrent="experimentProgressModel['Procedure'].current" 
								:valuemaximum="experimentProgressModel['Procedure'].end" 
								:time="experimentProgressModel['Procedure'].time_current - experimentProgressModel['Procedure'].time_start"></a-progress-bar-timed>
								
								<v-divider></v-divider>
								
								<!--
								<v-list-item v-if="experimentProgressModel['Dispatcher'].visible">
									<v-list-item-content style="flex-direction:row;align-items:center;" class="mr-3">
										<v-list-item-title>Dispatcher: {{experimentProgressModel['Dispatcher'].name}} {{experimentProgressModel['Dispatcher'].current}} of {{experimentProgressModel['Dispatcher'].end}} </v-list-item-title>
										<v-progress-linear class="roundedcorners" height="10" color="success" v-model="experimentProgressModel['Dispatcher'].percent"></v-progress-linear>
									</v-list-item-content>
									<v-list-item-action style="text-align:right;">	
										<v-list-item-sub-title>{{experimentProgressTimer.current - experimentProgressTimer.start | twoDecimalPoints}}</v-list-item-sub-title>
									</v-list-item-action>
								</v-list-item>
								<v-list-item v-if="experimentProgressModel['Sweep'].visible">
									<v-list-item-title>Sweep: {{experimentProgressModel['Sweep'].name}} {{experimentProgressModel['Sweep'].current}} of {{experimentProgressModel['Sweep'].end}} </v-list-item-title>
									<v-progress-linear v-model="experimentProgressModel['Sweep'].percent"></v-progress-linear>
								</v-list-item>
								<v-list-item v-if="experimentProgressModel['Group1'].visible">
									<v-list-item-title>{{experimentProgressModel['Group1'].name}} {{experimentProgressModel['Group1'].current}} of {{experimentProgressModel['Group1'].end}} </v-list-item-title>
									<v-progress-linear v-model="experimentProgressModel['Group1'].percent"></v-progress-linear>
								</v-list-item>
								<v-list-item v-if="experimentProgressModel['Group2'].visible">
									<v-list-item-title>{{experimentProgressModel['Group2'].name}} {{experimentProgressModel['Group2'].current}} of {{experimentProgressModel['Group2'].end}} </v-list-item-title>
									<v-progress-linear v-model="experimentProgressModel['Group2'].percent"></v-progress-linear>
								</v-list-item>
								<v-list-item v-if="experimentProgressModel['Procedure'].visible">
									<v-list-item-title>Procedure: {{experimentProgressModel['Procedure'].name}} {{experimentProgressModel['Procedure'].current}} of {{experimentProgressModel['Procedure'].end}} </v-list-item-title>
									<v-progress-linear v-model="experimentProgressModel['Procedure'].percent"></v-progress-linear>
								</v-list-item>
								-->
							</v-list>
							
							<v-container>
								<v-row dense >
									<v-col cols="3">
										<v-btn block height="50" class="mb-7" dark color="color_browser" v-if="dispatcherIdentifiers" 
											@click="setTopLevelPage('stepper'); goToIdentifiers(dispatcherIdentifiers);">
											<v-icon left>view_carousel</v-icon>View in Browser</v-btn>
									</v-col>
									<v-spacer></v-spacer>
									<v-spacer ></v-spacer>
									<v-spacer ></v-spacer>
									<v-col cols="3" v-if="jobSelectItems.length >= 2">
										<v-select dense filled rounded label="Job Number" v-model="jobSelectChoice" :items="jobSelectItems"></v-select>
									</v-col>
									<v-col cols="3" v-if="deviceSelectItems.length >= 2">
										<v-select dense filled rounded label="Device Number" v-model="deviceSelectChoice" :items="deviceSelectItems"></v-select>
									</v-col>
								</v-row>
								
								<template v-if="(jobSelectChoice !== '') && (deviceSelectChoice !== '') && (livePlots[jobSelectChoice]) && (livePlots[jobSelectChoice][deviceSelectChoice])">
									<v-row dense>
										<v-col :cols="(Object.entries(livePlots[jobSelectChoice][deviceSelectChoice]).length > 1)? 6 : 12" 
												v-for="[plotID, plot] of Object.entries(livePlots[jobSelectChoice][deviceSelectChoice])" 
												:key="plotID">
											<v-card>
												<v-toolbar dark dense class="color_runner darken-1">
													<v-toolbar-title>
														{{ plotID }} 
													</v-toolbar-title>
												
													<v-spacer></v-spacer>
													
													<v-menu bottom left offset-y :close-on-content-click="false" :max-width="250">
														<template v-slot:activator="{ on }">
															<v-btn v-on="on" icon><v-icon>settings</v-icon></v-btn>
														</template>
														<v-list>
															<v-list-item @click="toggleLivePlotYAxisLog(plot)">
																<v-list-item-avatar><v-icon>timeline</v-icon></v-list-item-avatar>
																<v-list-item-content><v-list-item-title>Toggle Log Scale</v-list-item-title></v-list-item-content>
															</v-list-item>
															<v-list-item>
																<v-list-item-avatar><v-icon>color_lens</v-icon></v-list-item-avatar>
																<v-list-item-content><v-text-field clearable single-line label="Color" v-model="plot['color']"></v-text-field></v-list-item-content>
															</v-list-item>
															<v-list-item>
																<v-list-item-avatar><v-icon>linear_scale</v-icon></v-list-item-avatar>
																<v-list-item-content><v-select clearable single-line label="Style" v-model="plot['plotMode']" :items="['lines', 'markers', 'lines+markers']"></v-text-field></v-list-item-content>
															</v-list-item>
														</v-list>
													</v-menu>
													
													<v-tooltip top>
														<template v-slot:activator="{ on }">
															<v-btn v-on="on" icon @click="clearLivePlot(plot); delete livePlots[jobSelectChoice][deviceSelectChoice][plotID];"><v-icon>clear</v-icon></v-btn>
														</template>
														<span>Clear</span>
													</v-tooltip>
												</v-toolbar>
												
												<div class="text-center">
													<a-plotly v-bind:data="extractPlotlyData(plot)" :layout="extractPlotlyLayout(plot)"></a-plotly>
												</div>
											</v-card>
										</v-col>
									</v-row>
								</template>
							</v-container>
						</v-card>
						
					</v-card>
					
					<!-- End of experiment runner -->
					
					<!-- Start of benchtop -->
					<v-card flat class="ma-4" v-if="topLevelPage === 'benchtop'">
						<v-container>
							<v-card class="pl-3 pr-3" outlined v-if="!availableMeasurementSystems.length">
								<v-row dense>
									<v-col cols="6">
										<v-card-title>Benchtop</v-card-title>
										<v-card-subtitle>{{ noSystemsConnectedMessage }}</v-card-subtitle>
									</v-col>
									<v-spacer></v-spacer>
									<v-spacer></v-spacer>
									<v-col class="pt-7">
										<v-btn @click="getAvailableMeasurementSystems()"><v-icon left>refresh</v-icon>Refresh</v-btn>
									</v-col>
								</v-row>
							</v-card>
							<template v-if="!benchtop.system">
								<v-card light class="pl-3 pr-3" color="info" v-for="system in availableMeasurementSystems" :key="system.uniqueID">
									<v-row dense>
										<v-col cols="6">
											<v-card-title>
												<v-avatar color="info darken-1" class="mr-3"><v-icon dark>wifi</v-icon></v-avatar>
												{{ system.name }}
											</v-card-title>
										</v-col>
										<v-spacer></v-spacer>
										<v-spacer></v-spacer>
										<v-col class="pt-7">
											<v-btn dark color="success" @click="benchtopStart(system)">
												Connect
											</v-btn>
										</v-col>
									</v-row>
								</v-card>
							</template>
							<v-card light class="pl-3 pr-3" color="info" v-if="benchtop.system">
								<v-row dense>
									<v-col cols="6">
										<v-card-title>
											<v-avatar color="success" class="mr-3"><v-icon dark>wifi</v-icon></v-avatar>
											{{ benchtop.system.name }}
										</v-card-title>
									</v-col>
									<v-spacer></v-spacer>
									<v-spacer></v-spacer>
									<v-col class="pt-7">
										<v-btn dark depressed color="info darken-1" @click="benchtopStop();" :disabled="benchtop.system && !connectedMeasurementSystem">
											{{ (benchtop.system && !connectedMeasurementSystem)? 'Connecting' : 'Disconnect' }}
										</v-btn>
									</v-col>
								</v-row>
							</v-card>
							
							<template v-if="benchtop.system && connectedMeasurementSystem">
								<v-row dense class="pt-1">
									<v-col cols="6">
										<v-card class="pa-3" :dark="benchtop.channel1.enabled" :color="benchtop.channel1.enabled? 'color7' : 'info'">
											<v-row dense>
												<v-col cols="6"><v-card-title>Channel 1 (VDS)</v-card-title></v-col>
												<v-spacer></v-spacer>
												<v-col class="pt-6">
													<v-btn small dark @click="benchtopToggleChannel1()"
														:depressed="benchtop.channel1.enabled" 
														:color="benchtop.channel1.enabled? 'info darken-1' : 'color7'">
														Turn {{ benchtop.channel1.enabled? 'Off' : 'On' }}
													</v-btn>
												</v-col>
											</v-row>
											<template v-if="benchtop.channel1.enabled">
												<v-row class="pl-3 pr-3" >
													<v-col cols="6" class="pb-0">
														<v-text-field light filled rounded readonly background-color="info" label="Voltage" :suffix="benchtop.channel1.voltage_units" 
														v-model="benchtop.channel1.voltage_measured"></v-text-field>
													</v-col>
													<v-col cols="6" class="pb-0">
														<v-text-field light filled rounded readonly background-color="info" label="Current" :suffix="benchtop.channel1.current_units" 
														v-model="benchtop.channel1.current_measured"></v-text-field>
													</v-col>
												</v-row>
												<v-card-actions class="pt-0">
													<v-spacer></v-spacer>
													<v-btn color="info darken-1" class="text-none" @click="benchtopIncrementChannel1(-0.05)">-50 mV</v-btn>
													<v-spacer></v-spacer>
													<v-text-field dense light filled rounded class="mt-6" label="Voltage Control" type="number"
														:background-color="(benchtop.channel1.input === benchtop.channel1.setpoint)? 'info lighten-3' : 'info'"
														:suffix="benchtop.channel1.voltage_units" 
														v-model.number="benchtop.channel1.input" @change="benchtopApplyVoltageChannel1()"></v-text-field>
													<v-spacer></v-spacer>
													<v-btn color="info darken-1" class="text-none" @click="benchtopIncrementChannel1(0.05)">+50 mV</v-btn>
													<v-spacer></v-spacer>
												</v-card-actions>
											</template>
										</v-card>
									</v-col>
									<v-col cols="6">
										<v-card class="pa-3" :dark="benchtop.channel2.enabled" :color="benchtop.channel2.enabled? 'color8' : 'info'">
											<v-row dense>
												<v-col cols="6"><v-card-title>Channel 2 (VGS)</v-card-title></v-col>
												<v-spacer></v-spacer>
												<v-col class="pt-6">
													<v-btn small dark @click="benchtopToggleChannel2()" 
														:depressed="benchtop.channel2.enabled" 
														:color="benchtop.channel2.enabled? 'info darken-1' : 'color8'">
														Turn {{ benchtop.channel2.enabled? 'Off' : 'On' }}
													</v-btn>
												</v-col>
											</v-row>
											<template v-if="benchtop.channel2.enabled">
												<v-row class="pl-3 pr-3">
													<v-col cols="6" class="pb-0">
														<v-text-field light filled rounded readonly background-color="info" label="Voltage"
														:suffix="benchtop.channel2.voltage_units" 
														v-model="benchtop.channel2.voltage_measured"></v-text-field>
													</v-col>
													<v-col cols="6" class="pb-0">
														<v-text-field light filled rounded readonly background-color="info" label="Current" 
														:suffix="benchtop.channel2.current_units" 
														v-model="benchtop.channel2.current_measured"></v-text-field>
													</v-col>
												</v-row>
												<v-card-actions class="pt-0">
													<v-spacer></v-spacer>
													<v-btn color="info darken-1" class="text-none" @click="benchtopIncrementChannel2(-0.05)">-50 mV</v-btn>
													<v-spacer></v-spacer>
													<v-text-field dense light filled rounded class="mt-6" label="Voltage Control" type="number"
														:background-color="(benchtop.channel2.input === benchtop.channel2.setpoint)? 'info lighten-3' : 'info'"
														:suffix="benchtop.channel2.voltage_units" 
														v-model.number="benchtop.channel2.input" @change="benchtopApplyVoltageChannel2()"></v-text-field>
													<v-spacer></v-spacer>
													<v-btn color="info darken-1" class="text-none" @click="benchtopIncrementChannel2(0.05)">+50 mV</v-btn>
													<v-spacer></v-spacer>
												</v-card-actions>
											</template>
										</v-card>
									</v-col>
								</v-row>
								
								<template v-if="benchtop.channel1.enabled || benchtop.channel2.enabled">
									<v-row dense class="mb-n4">
										<v-spacer v-if="!benchtop.channel1.enabled"></v-spacer>
										<v-col :cols="(benchtop.channel1.enabled && benchtop.channel2.enabled)? 12 : 6">
											<v-slider thumb-label :min="-5" :max="10" :step="0.1" label="Refresh Rate (Hz)" color="color_benchtop lighten-1" @end="benchtopApplyRefreshRate();" v-model="benchtop.refresh_rate">
												<template v-slot:thumb-label="{ value }">
													{{ benchtopRefreshRate }}
												</template>
											</v-slider>
										</v-col>
									</v-row>
									
									<v-card dark color="#4B4B4B" v-if="(benchtop.plot.traces.channel1.visible || benchtop.plot.traces.channel2.visible) && !(benchtop.plot_info.splitscreen && benchtop.plot.traces.channel1.visible && benchtop.plot.traces.channel2.visible)">
										<a-plotly v-bind:data="extractPlotlyData(benchtop.plot)" :layout="extractPlotlyLayout(benchtop.plot)"></a-plotly>
									</v-card>
									<v-row dense v-if="benchtop.plot_info.splitscreen && benchtop.plot.traces.channel1.visible && benchtop.plot.traces.channel2.visible">
										<v-col cols="6">
											<v-card dark color="color7 darken-2">
												<a-plotly v-bind:data="extractPlotlyData(benchtop.plot, specificTraces='channel1')" :layout="extractPlotlyLayout(benchtop.plot)"></a-plotly>
											</v-card>
										</v-col>
										<v-col cols="6">
											<v-card dark color="color8 darken-2">
												<a-plotly v-bind:data="extractPlotlyData(benchtop.plot, specificTraces='channel2')" :layout="extractPlotlyLayout(benchtop.plot)"></a-plotly>
											</v-card>
										</v-col>
									</v-row>
									
									<v-row dense class="mt-2">
										<v-col cols="2" v-if="benchtop.channel1.enabled">
											<v-checkbox label="Track Channel 1" v-model="benchtop.plot.traces.channel1.visible" 
											color="color7" class="mt-0"></v-checkbox>
										</v-col>
										<v-spacer></v-spacer>
										<v-col cols="6">
											<v-slider thumb-label :min="15" :max="60" :step="1" label="Tracking Window (s)" color="color_benchtop lighten-1" v-model="benchtop.plot_info.tracking_window"></v-slider>
										</v-col>
										<v-col cols="2" v-if="benchtop.channel1.enabled && benchtop.channel2.enabled && benchtop.plot.traces.channel1.visible && benchtop.plot.traces.channel2.visible">
											<v-checkbox label="Split Screen" v-model="benchtop.plot_info.splitscreen" 
											color="#4B4B4B" class="mt-0"></v-checkbox>
										</v-col>
										<v-spacer></v-spacer>
										<v-col cols="2" v-if="benchtop.channel2.enabled" class="d-flex justify-end">
											<v-checkbox label="Track Channel 2" v-model="benchtop.plot.traces.channel2.visible" 
											color="color8" class="mt-0 mr-2"></v-checkbox>
										</v-col>
									</v-row>
								</template>
							</template>
						</v-container>
					</v-card>
					<!-- End of benchtop -->
					
					<!-- Start of applications -->
					
					<v-card flat class="ma-4" v-if="topLevelPage === 'performance'">
						<v-card>
							<v-toolbar dark dense class="color_performance">
								<v-toolbar-title>
									Performance
								</v-toolbar-title>
								<v-spacer></v-spacer>
								<v-btn icon @click="performanceReset()" :disabled="false"><v-icon>settings_backup_restore</v-icon></v-btn>
							</v-toolbar>
							
							<v-container>							
								<v-card class="mb-1 pa-1 grey lighten-4 roundedcorners" v-if="Object.keys(performanceScheduleObject).length > 0">
									<v-container>
										<v-row dense>
											<v-col cols="3">
												<v-list class="roundedcorners">
													<v-list-item class="pb-1">
														<v-list-item-content><v-list-item-title style="font-weight: bold">
															Device ID
														</v-list-item-title></v-list-item-content>
													</v-list-item>
													<v-list-item>
														<a-item-edit :setting.sync="performanceScheduleObject['Identifiers']['device']"></a-item-edit>
													</v-list-item>
												</v-list>
												<v-list class="roundedcorners mt-2">
													<v-list-item class="pb-1">
														<v-list-item-content><v-list-item-title style="font-weight: bold">
															Measurement System
														</v-list-item-title></v-list-item-content>
													</v-list-item>
													<v-list-item>
														<a-item-edit :setting.sync="performanceScheduleObject['MeasurementSystem']['systemType']"></a-item-edit>
													</v-list-item>
												</v-list>
											</v-col>
											
											<v-col cols="3">
												<v-list class="roundedcorners">
													<v-list-item class="pb-1">
														<v-list-item-content><v-list-item-title style="font-weight: bold">
															Voltages
														</v-list-item-title></v-list-item-content>
													</v-list-item>
													<v-list-item>
														<a-item-edit :setting.sync="performanceScheduleObject['runConfigs']['FreeRun']['gateVoltageMinimum']"></a-item-edit>
													</v-list-item>
													<v-list-item>
														<a-item-edit :setting.sync="performanceScheduleObject['runConfigs']['FreeRun']['gateVoltageMaximum']"></a-item-edit>
													</v-list-item>
													<v-list-item>
														<a-item-edit :setting.sync="performanceScheduleObject['runConfigs']['FreeRun']['drainVoltageMinimum']"></a-item-edit>
													</v-list-item>
													<v-list-item>
														<a-item-edit :setting.sync="performanceScheduleObject['runConfigs']['FreeRun']['drainVoltageMaximum']"></a-item-edit>
													</v-list-item>
												</v-list>
											</v-col>
											
											<v-col cols="3">
												<v-expansion-panels flat v-model="performanceShowOptions" class="roundedcorners">
													<v-expansion-panel class="roundedcorners">
														<v-expansion-panel-header>
															<div style="font-weight:bold;font-size:12pt">Options</div>
														</v-expansion-panel-header>
														<v-expansion-panel-content class="padlessexpansionpanel">
															<v-list class="roundedcorners">
																<v-list-item>
																	<a-item-edit :setting.sync="performanceScheduleObject['runConfigs']['FreeRun']['pointLimit']" placeholder="unlimited"></a-item-edit>
																</v-list-item>
																<v-list-item>
																	<a-item-edit :setting.sync="performanceScheduleObject['runConfigs']['FreeRun']['delayBetweenMeasurements']"></a-item-edit>
																</v-list-item>
															</v-list>
														</v-expansion-panel-content>
													</v-expansion-panel>
												</v-expansion-panels>
											</v-col>
											
											<v-col cols="3">
												<v-expansion-panels flat v-model="performanceShowAdvanced" class="roundedcorners">
													<v-expansion-panel class="roundedcorners">
														<v-expansion-panel-header>
															<div  style="font-weight:bold;font-size:12pt">Advanced</div>
														</v-expansion-panel-header>
														<v-expansion-panel-content class="padlessexpansionpanel">
															<v-list class="roundedcorners">
																<v-list-item>
																	<a-item-edit :setting.sync="performanceScheduleObject['runConfigs']['FreeRun']['stepsBetweenMeasurements']"></a-item-edit>
																</v-list-item>
																<v-list-item>
																	<a-item-edit :setting.sync="performanceScheduleObject['runConfigs']['FreeRun']['complianceCurrent']"></a-item-edit>
																</v-list-item>
																<v-list-item>
																	<a-item-edit :setting.sync="performanceScheduleObject['runConfigs']['FreeRun']['gateVoltageDistribution']"></a-item-edit>
																	<v-col cols="2" class="pa-0 ml-1" v-if="performanceScheduleObject['runConfigs']['FreeRun']['gateVoltageDistribution']['default'] !== 'random'"> 
																		<a-item-edit hide_label="true" :setting.sync="performanceScheduleObject['runConfigs']['FreeRun']['gateVoltageDistributionParameter']"></a-item-edit>
																	</v-col>
																</v-list-item>
																<v-list-item>
																	<a-item-edit :setting.sync="performanceScheduleObject['runConfigs']['FreeRun']['drainVoltageDistribution']"></a-item-edit>
																	<v-col cols="2" class="pa-0 ml-1" v-if="performanceScheduleObject['runConfigs']['FreeRun']['drainVoltageDistribution']['default'] !== 'random'">
																		<a-item-edit hide_label="true" :setting.sync="performanceScheduleObject['runConfigs']['FreeRun']['drainVoltageDistributionParameter']"></a-item-edit>
																	</v-col>
																</v-list-item>
															</v-list>
														</v-expansion-panel-content>
													</v-expansion-panel>
												</v-expansion-panels>
											</v-col>
										</v-row>
									</v-container>
								</v-card>
							</v-container>
								
							<v-container class="pa-0">
								<v-row no-gutters>
									<v-col cols="10">
										<v-card flat>
											<v-toolbar dark flat color="color_performance" class="pb-1">
												<v-spacer></v-spacer>
												<v-toolbar-items>
													<v-btn color="color_performance darken-1 roundedcorners" @click="performanceEnablePlots(); performanceSave(performanceStart);" :disabled="performanceRunning"><v-icon>play_arrow</v-icon></v-btn>
												</v-toolbar-items>
												<v-spacer></v-spacer>
												<v-toolbar-items>
													<v-btn color="color_performance darken-1 roundedcorners" @click="performanceStop()" :disabled="!performanceRunning"><v-icon>pause</v-icon></v-btn>
												</v-toolbar-items>
												<v-spacer></v-spacer>
												<v-toolbar-items>
													<v-btn color="color_performance darken-1 roundedcorners" @click="performanceClear()" :disabled="false"><v-icon>refresh</v-icon></v-btn>
												</v-toolbar-items>
												<v-spacer></v-spacer>
											</v-toolbar>
											
											<v-tabs dark grow value="tab-T" background-color="color_performance" slider-color="orange darken-2">
												<v-tabs-slider></v-tabs-slider>
												<v-tab href="#tab-S">Subthreshold Curve</v-tab>
												<v-tab href="#tab-T">Transfer Curve</v-tab>
												<v-tab  href="#tab-O">Output Curve</v-tab>
												<v-tab-item value="tab-S">
													<v-card flat>
														<a-plotly v-bind:data="extractPlotlyData(performancePlots['Subthreshold Curve'])" :layout="extractPlotlyLayout(performancePlots['Subthreshold Curve'])"></a-plotly>
													</v-card>
												</v-tab-item>
												<v-tab-item value="tab-T">
													<v-card flat>
														<a-plotly v-bind:data="extractPlotlyData(performancePlots['Transfer Curve'])" :layout="extractPlotlyLayout(performancePlots['Transfer Curve'])"></a-plotly>
													</v-card>
												</v-tab-item>
												<v-tab-item value="tab-O">
													<v-card flat>
														<a-plotly v-bind:data="extractPlotlyData(performancePlots['Output Curve'])" :layout="extractPlotlyLayout(performancePlots['Output Curve'])"></a-plotly>
													</v-card>
												</v-tab-item>
											</v-tabs>
										</v-card>
									</v-col>
									
									<v-col cols="2">
										<v-card flat class="ml-2">
											<v-toolbar dark flat color="color_performance" class="pb-1">
												<v-spacer></v-spacer>
												<v-toolbar-items><v-icon large>speed</v-icon></v-toolbar-items>
												<v-toolbar-title v-if="liveDataCounter">
													{{ liveDataCounter | formatCounter }}
												</v-toolbar-title>
												<v-spacer></v-spacer>													
											</v-toolbar>
											<v-toolbar dark flat color="color_performance" dense>
												<v-spacer></v-spacer>
												<v-toolbar-items><v-switch class="ml-2" color="white" label="" v-model="performanceMetricsExtract"></v-switch></v-toolbar-items>
												<v-spacer></v-spacer>
											</v-toolbar>
											<v-data-table v-if="performanceMetricsExtract" light hide-default-header hide-default-footer 
												:items="[{'label':'gm', 'value':performanceMetrics['gm'], 'decimals':3, 'units':' S'}, 
														 {'label':'SS', 'value':performanceMetrics['SS'], 'decimals':0, 'units':' mV/dec'},
														 {'label':'VT', 'value':performanceMetrics['VT'], 'decimals':2, 'units':' V'}]">
												<template v-slot:body="{ items }">		
													<tbody>
														<tr v-for="item in items" :key="item.label">
															<td><div style="width:21">{{ item.label }}</div></td>
															<td>{{ item['value'] | scientificPrecision(item.decimals) 
																			   | withUnits(item.units) }}</td>
														</tr>
													</tbody>
												</template>
											</v-data-table>
											<v-checkbox v-if="performanceMetricsExtract" class="ml-1" label="Show on Plot" 
											v-model="performanceMetricsShowOnPlot"></v-checkbox>
										</v-card>
									</v-col>
								</v-row>
							</v-container>
						</v-card>
					</v-card>
					
					<v-card flat class="ma-4" v-if="topLevelPage === 'ptSensor'">
						<v-card>
							<v-toolbar dark dense class="color_ptsensor">
								<v-toolbar-title>
									PT Sensor
								</v-toolbar-title>
								<v-spacer></v-spacer>
								<v-btn icon @click="ptSensorReset()" :disabled="false"><v-icon>settings_backup_restore</v-icon></v-btn>
							</v-toolbar>
							
							<v-container>
								<v-card class="mb-1 pa-1 grey lighten-4 roundedcorners" v-if="Object.keys(ptSensorScheduleObject).length > 0">
									<v-container>
										<v-row dense>
											<v-col cols="3">
												<v-list class="roundedcorners">
													<v-list-item class="pb-1">
														<v-list-item-content><v-list-item-title style="font-weight: bold">
															Device ID
														</v-list-item-title></v-list-item-content>
													</v-list-item>
													<v-list-item>
														<a-item-edit :setting.sync="ptSensorScheduleObject['Identifiers']['device']"></a-item-edit>
													</v-list-item>
												</v-list>
											</v-col>
											<v-col cols="3">
												<v-list class="roundedcorners">
													<v-list-item class="pb-1">
														<v-list-item-content><v-list-item-title style="font-weight: bold">
															Timing
														</v-list-item-title></v-list-item-content>
													</v-list-item>
													<v-list-item>
														<a-item-edit :setting.sync="ptSensorScheduleObject['runConfigs']['PTSensor']['totalSensingTime']"></a-item-edit>
													</v-list-item>
													<v-list-item>
														<a-item-edit :setting.sync="ptSensorScheduleObject['runConfigs']['PTSensor']['delayBetweenMeasurements']"></a-item-edit>
													</v-list-item>
												</v-list>
											</v-col>
											<v-spacer></v-spacer>
										</v-row>
									</v-container>
								</v-card>
							</v-container>
								
							<v-container class="pa-0">
								<v-row no-gutters>
									<v-col cols="10">
										<v-card flat>
											<v-toolbar dark flat color="color_ptsensor" class="pb-1">
												<v-spacer></v-spacer>
												<v-toolbar-items>
													<v-btn color="color_ptsensor darken-1 roundedcorners" @click="ptSensorEnablePlots(); ptSensorSave(ptSensorStart);" :disabled="ptSensorRunning"><v-icon>play_arrow</v-icon></v-btn>
												</v-toolbar-items>
												<v-spacer></v-spacer>
												<v-toolbar-items>
													<v-btn color="color_ptsensor darken-1 roundedcorners" @click="ptSensorStop()" :disabled="!ptSensorRunning"><v-icon>pause</v-icon></v-btn>
												</v-toolbar-items>
												<v-spacer></v-spacer>
												<v-toolbar-items>
													<v-btn color="color_ptsensor darken-1 roundedcorners" @click="ptSensorClear()" :disabled="false"><v-icon>refresh</v-icon></v-btn>
												</v-toolbar-items>
												<v-spacer></v-spacer>
											</v-toolbar>
											
											<v-tabs dark grow value="tab-T" background-color="color_ptsensor" slider-color="color_ptsensor darken-4">
												<v-tab href="#tab-I">Impedance</v-tab>
												<v-tab-item value="tab-I">
													<v-card flat>
														<a-plotly v-bind:data="extractPlotlyData(ptSensorPlots['Impedance'])" :layout="extractPlotlyLayout(ptSensorPlots['Impedance'])"></a-plotly>
													</v-card>
												</v-tab-item>
											</v-tabs>
										</v-card>
									</v-col>
									
									<v-col cols="2">
										<v-card flat class="ml-2">
											<v-toolbar dark flat color="color_ptsensor" class="pb-1">
												<v-spacer></v-spacer>
												<v-toolbar-items><v-icon large>opacity</v-icon></v-toolbar-items>
												<v-spacer></v-spacer>													
											</v-toolbar>
											<v-toolbar dark flat color="color_ptsensor" dense></v-toolbar>
											<v-data-table light hide-default-header hide-default-footer 
												:items="[{'label': 'Max', 'value': ptSensorMaxImpedance,      'decimals': 0, 'units': ' Ohms'}, 
														 {'label': 'PT', 'value': ptSensorTimeOfMaxImpedance, 'decimals': 2, 'units': ' sec'}]">
												<template v-slot:body="{ items }">		
													<tbody>
														<tr v-for="item in items" :key="item.label">
															<td> {{ item.label }}</td>
															<td> {{ item.value | decimalPrecision(item.decimals) 
																			   | withUnits(item.units) }}</td>
														</tr>		
													</tbody>
												</template>
											</v-data-table>
										</v-card>
									</v-col>
								</v-row>
							</v-container>
						</v-card>
					</v-card>
					
					<!-- End of applications -->
					<!-- Start of settings -->
					
					<v-card flat class="ma-4" v-if="topLevelPage === 'settings'">
						<v-card>
							<v-toolbar dark dense class="info darken-2">
								<v-toolbar-title>
									Plot Settings
								</v-toolbar-title>
								<v-spacer></v-spacer>
								<v-btn light small @click="updatePlotSettings()">Save</v-btn>
								<v-btn icon @click="resetAllPlotSettings(); updatePlotSettings();" :disabled="!hasModifiedPlotSettings()"><v-icon>settings_backup_restore</v-icon></v-btn>
							</v-toolbar>
							
							<v-container>
								<v-row dense>
									<v-col cols="3">
										<v-card>
											<v-toolbar dark dense class="color_base">
												<v-toolbar-title>
													Data
												</v-toolbar-title>
											</v-toolbar>
											<v-list class="pt-4">
												<a-item-edit-group :settings.sync="primaryPlotSettings"></a-item-edit-group>
											</v-list>
										</v-card>
									</v-col>
									
									<v-col cols="3">
										<v-card>
											<v-toolbar dark dense class="color_base">
												<v-toolbar-title>
													Plot Options
												</v-toolbar-title>
											</v-toolbar>
											<v-list class="pt-4">
												<a-item-edit-group :settings.sync="modePlotSettings"></a-item-edit-group>
											</v-list>
										</v-card>
									</v-col>
									
									<v-col cols="3">
										<v-card>
											<v-toolbar dark dense class="color_base">
												<v-toolbar-title>
													Chip Summary
												</v-toolbar-title>
											</v-toolbar>
											<v-list class="pt-4">
												<a-item-edit-group :settings.sync="chipSummarySettings"></a-item-edit-group>
											</v-list>
										</v-card>
									</v-col>
									
									<v-col cols="3">
										<v-card>
											<v-toolbar dark dense class="color_base">
												<v-toolbar-title>
													Device Summary
												</v-toolbar-title>
											</v-toolbar>
											<v-list class="pt-4">
												<a-item-edit-group :settings.sync="deviceSummarySettings"></a-item-edit-group>
											</v-list>
										</v-card>
									</v-col>
								</v-row>
							</v-container>
						</v-card>
					</v-card>
					
					<!-- End of settings -->
					<!-- Start of about -->
					
					<v-card flat class="ma-4" v-if="topLevelPage === 'about'">
						<v-card>
							<v-toolbar dark dense class="color_documentation">
								<v-toolbar-title>
									About
								</v-toolbar-title>
							</v-toolbar>
							<v-container>								
								This software was developed by Steven Noyce and Jay Doherty in Dr. Aaron Franklin's lab at Duke University.
							</v-container>
						</v-card>
						
						<v-card class="mt-3">
							<v-toolbar dark dense class="color_documentation">
								<v-toolbar-title>
									Help
								</v-toolbar-title>
							</v-toolbar>
							
							<v-container>
								<v-expansion-panels multiple class="mt-1 mb-2" v-for="(documentationItemText, index) in documentationInfo" :key="index">
									<v-expansion-panel class="grey lighten-4">
										<v-expansion-panel-header class="pt-0 pb-0">
											<template v-slot:default="{ open }">
												<v-row no-gutters>
													<v-avatar tile size="24" class="mt-3 mr-2 roundedcorners" :color="getDocumentationColor(documentationInfo[index]['title'])" v-if="getDocumentationColor(documentationInfo[index]['title'])">
														<v-icon dark>{{ getDocumentationIcon(documentationInfo[index]['title']) }}</v-icon>
													</v-avatar>
													<div style="display:inline; height: 50px; line-height: 50px;">
														{{ documentationInfo[index]['title'] }}
													</div>
													<v-spacer></v-spacer>
													<v-col cols="3" v-if="!documentationInfo[index]['readonly'] || (index == documentationInfo.length - 1)">
														<v-row no-gutters class="pt-2">
															<v-tooltip top>
																<template v-slot:activator="{ on }">
																	<v-btn icon @click.stop="moveDocumentationEntryUp(index)" v-on="on" :disabled="(index == 0) || documentationInfo[index-1]['readonly']"><v-icon>arrow_upward</v-icon></v-btn>
																</template>
																<span>Move entry up</span>
															</v-tooltip>
															<v-tooltip top>
																<template v-slot:activator="{ on }">
																	<v-btn icon @click.stop="moveDocumentationEntryDown(index)" v-on="on" :disabled="index >= documentationInfo.length - 1"><v-icon>arrow_downward</v-icon></v-btn>
																</template>
																<span>Move entry down</span>
															</v-tooltip>
															<v-tooltip top>
																<template v-slot:activator="{ on }">
																	<v-btn icon @click.stop="addDocumentationEntry(index)" v-on="on"><v-icon>add_circle</v-icon></v-btn>
																</template>
																<span>Add new entry after</span>
															</v-tooltip>
															<v-tooltip top>
																<template v-slot:activator="{ on }">
																	<v-btn icon @click.stop="documentationDeleteDialogVisible = true; documentationDeleteIndex=index;" v-on="on" :disabled="(documentationInfo.length == 1) || documentationInfo[index]['readonly']"><v-icon>cancel</v-icon></v-btn>
																</template>
																<span>Delete entry</span>
															</v-tooltip>
														</v-row>
													</v-col>
												</v-row>
											</template>
										</v-expansion-panel-header>
										
										<v-expansion-panel-content>
											<v-container> 
												<p v-if="!documentationInfo[index]['edit_mode']" style="white-space: pre-line;">
													{{ documentationInfo[index]['text'] }}
												</p>
												<v-text-field solo v-if="documentationInfo[index]['edit_mode']" label="Enter documentation title" v-model="documentationProposedInfo[index]['title']" auto-grow></v-text-field>
												<v-textarea solo v-if="documentationInfo[index]['edit_mode']" label="Enter documentation text" v-model="documentationProposedInfo[index]['text']" auto-grow>
												</v-textarea>
												<v-btn v-if="!documentationInfo[index]['edit_mode'] && !documentationInfo[index]['readonly']" class="mb-3 mt-3" @click="documentationEdit(index)">Edit</v-btn>
												<v-btn v-if="documentationInfo[index]['edit_mode']" class="mb-3 mt-3" @click="documentationSave(index)">Save</v-btn>
												<v-btn v-if="documentationInfo[index]['edit_mode']" class="mb-3 mt-3" @click="documentationCancel(index)">Cancel</v-btn>
											</v-container>
										</v-expansion-panel-content>
									</v-expansion-panel>
								</v-expansion-panels>
								
								<v-snackbar bottom v-model="documentationDeleteDialogVisible" color="warning">
									<v-icon dark left>warning</v-icon>
									Are you sure you want to delete this entry?
									<v-btn color="white" @click="documentationDeleteDialogVisible = false">Cancel</v-btn>
									<v-btn color="red" @click="documentationDeleteDialogVisible = false; removeDocumentationEntry(documentationDeleteIndex);">Delete</v-btn>
								</v-snackbar>
							</v-container>
						</v-card>
					</v-card>
					
					<!-- End of about -->
					<!-- Start of documentation -->
					
					<v-card flat class="ma-4" v-if="topLevelPage === 'documentation'">
						<v-card>
							<v-toolbar dark dense class="color_documentation">
								<v-toolbar-title>
									README for Autexys - the Automated Experimentation System
								</v-toolbar-title>
								<v-spacer></v-spacer>
								<v-btn icon><v-icon>info_outline</v-icon></v-btn>
							</v-toolbar>
							<v-container>
								<div v-html="ReadMeHTML"></div>
							</v-container>
						</v-card>
						
						<v-card class="mt-3">
							<v-toolbar dark dense class="color_documentation">
								<v-toolbar-title>
									Developer Documentation
								</v-toolbar-title>
								<v-spacer></v-spacer>
								<v-btn icon><v-icon>info_outline</v-icon></v-btn>
							</v-toolbar>
							
							<v-container> 
								This documentation is intended for developers adding to the Python code. It is built using Sphinx.
							</v-container>
							
							<v-container>
								<v-btn href="https://stevennoyce.github.io/AutexysHost/build/html/" target="_blank">View Documentation</v-btn>
							</v-container>
						</v-card>
					</v-card>

					<!-- End of documentation -->

				</v-content>
				<v-footer inset>
					<v-spacer></v-spacer><span class="pr-4">Created by Steven Noyce. Updated October 2020.</span>
				</v-footer>
			</v-app>
		</transition>
	</div>
	
	<script src="./libs/jquery.js"></script>
	<script src="./libs/lodash.js"></script>
	<script src="./libs/vue.js"></script>
	<script src="./libs/vuetify.js"></script>
	<script src="./libs/showdown.js"></script>
	<script src="./libs/socketio.js"></script>
	<script src="./libs/plotly-v1_52_2.js"></script>
	<script src="./libs/yaml.js"></script>
	
	<% for component in components %>
		<% include component %>
	<% endfor %>
	
	<script type="text/javascript">
		
		// === Setup Server Connection ===
		
		// Open a socketio connection on the URL of this document, then notify the server when successful
		var url = 'http://' + document.domain + ':' + location.port;
		var socket = io.connect(url);
		socket.on('connect', function(s) {
			console.log('Notifying Server that this Client has connected on ' + url);
			socket.emit('Client Notification', {data: 'Client is connected.'});
		});
		
		socket.on('Server Message', function(message) {
			app.handleServerMessage(message);
		});
		
		// === Global Functions ===
		
		function groupBy(elements, groupKey) {
			return elements.reduce(function(rv, x) {
				(rv[x[groupKey]] = rv[x[groupKey]] || []).push(x);
				return rv;
			}, {});
		}
		
		const get = path => object => path.reduce((xs, x) => (xs && xs[x]) ? xs[x] : null, object);
		
		function objectDeepDiff(object, base) {
			function changes(object, base) {
				return _.transform(object, function(result, value, key) {
					if (!_.isEqual(value, base[key])) {
						result[key] = (_.isPlainObject(value) && _.isPlainObject(base[key])) ? changes(value, base[key]) : value;
					}
				});
			}
			return changes(object, base);
		}
		
		function objectDeepMerge(object, additions) {
			function merge(base, added) {
				Object.keys(added).forEach(function(key) {
					if(!Object.keys(base).includes(key)) {
						base[key] = added[key];
					} else if(_.isPlainObject(base[key]) && _.isPlainObject(added[key])) {
						merge(base[key], added[key]);
					} else if(!_.isEqual(added[key], base[key])) {
						base[key] = added[key];
					}
				});
				return base;
			}
			
			var objectCopy = JSON.parse(JSON.stringify(object));
						
			return merge(objectCopy, additions)		
		}
		
		function objectDeepInclude(object, additions) {
			function include(base, added) {
				Object.keys(added).forEach(function(key) {
					if(!Object.keys(base).includes(key)) {
						base[key] = added[key];
					} else if(_.isPlainObject(base[key]) && _.isPlainObject(added[key])) {
						include(base[key], added[key]);
					} 
				});
				return base;
			}
			
			var objectCopy = JSON.parse(JSON.stringify(object));
						
			return include(objectCopy, additions)		
		}
		
		function extractDefaults(obj) {
			var d = JSON.parse(JSON.stringify(obj));
			
			if (!_.isPlainObject(d)) {
				return d;
			}
			if (Object.keys(d).includes('default')) {
				return d['default'];
			}
			if (_.isPlainObject(d) && Object.keys(d).length > 0) {
				return Object.assign(...Object.entries(d)
					.filter(([k, v]) => (!Object.keys(v).includes('ignore')))
					.map(([k, v]) => ({[k]: extractDefaults(v)})));
			}
			return d;
		}
		
		var imageRequestsLoading = 0;
		function loadAvailableImages() {
			if (imageRequestsLoading > 0) return;
			if (imageRequestsLoading < 0) imageRequestsLoading = 0;
			
			let zoomableImages = document.getElementsByClassName("zoomableImage");
			
			for (var i = 0; i < zoomableImages.length; i++) {
				if (zoomableImages[i].getAttribute('srcdata') != zoomableImages[i].getAttribute('src')) {
					// Setup callbacks for when the <img> loads
					imageRequestsLoading++;
					zoomableImages[i].addEventListener('load',  (event) => {imageRequestsLoading--; loadAvailableImages();});
					zoomableImages[i].addEventListener('error', (event) => {imageRequestsLoading--; loadAvailableImages();});
					
					// Tell the <img> to start loading
					zoomableImages[i].setAttribute('src', zoomableImages[i].getAttribute('srcdata'));
				}
				if (!zoomableImages[i].complete) return;
			}
		}
		
		var imageLoaderTimer = setInterval(loadAvailableImages, 100);
		
		
		
		// === Build Vue/Vuetify App ===
	
		console.log('Building Vuetify app...');
		
		var app = new Vue({
			vuetify: new Vuetify({icons:{iconfont:'md'}}), // new syntax for vuetify v2.0.x (not previously required in v1.5.x)
			el: '#app',
			data: {
				// === Web Browser Status ===
				
				online: navigator.onLine,  // true when the browser detects an internet connection
							
				// === Server Status ===
				
				serverDomain: document.domain,
				serverPort: location.port,
				
				// === Navigation ===
				
				colors: [],
				pageLoading: true,
				drawer: null,
				currentPage: window.location.hash.substr(1) || "",
				stepperPage: localStorage.stepperPage ? JSON.parse(localStorage.stepperPage) : 1,
				topLevelPage: localStorage.user ? 'dashboard' : 'gettingstarted',
				
				// === Alert Messages ===
				
				noDataToShowMessage: 'Check back here after running a few experiments.',
				noSystemsConnectedMessage: 'Searching for connections...',
				
				// === System Parameters ===
				
				workspaceDataFolderPath: localStorage.workspaceDataFolderPath ? JSON.parse(localStorage.workspaceDataFolderPath) : '',
				
				connectedMeasurementSystem: undefined,
				availableMeasurementSystems: [],
				acquiringMeasurementSystem: {
					status: undefined,
					callback: undefined,	
				},
				
				defaultParameters: {},
				defaultParametersDescription: {},
				defaultIdentifiers: {},
				paths: {},
				cacheBust: '',
				
				standardScheduleNames: [],
				userDefinedScheduleNames: {},
								
				// === Plot Settings ===
								
				plotSettings: {'primary':{}, 'mode_parameters':{}, 'chip':{}, 'device':{}},
				
				primaryPlotSettings: {
					'minExperiment':      {'type': 'int',   'default':undefined, 'title':'Min Experiment',   'description':'Show mult on plot.'},
					'maxExperiment':      {'type': 'int',   'default':undefined, 'title':'Max Experiment',   'description':'Show mult on plot.'},
					'minRelativeIndex':   {'type': 'int',   'default':undefined, 'title':'Min Rel. Index',   'description':'Within experiment.'},
					'maxRelativeIndex':   {'type': 'int',   'default':undefined, 'title':'Max Rel. Index',   'description':'Within experiment.'},
				},
				primaryPlotSettingDefaults: undefined,
				
				modePlotSettings: {
					'sweepDirection':     {'type': 'choice','default':'both',    'title':'Sweep Direction',  'description':'', 'choices': ['both', 'forward', 'reverse']},
					'plotInRealTime':     {'type': 'bool',  'default':true,      'title':'Show Real Time',   'description':'Show gaps in time.'},
					'timescale':          {'type': 'choice','default':'',        'title':'Time Scale',       'description':'X-axis time scale.', 'choices': ['','seconds','min','hr','days','weeks','months']},
					'boxPlotBarChart':    {'type': 'bool',  'default':true,      'title':'Bar Charts',       'description':'Bar vs. Box plot.'},
					'boxPlotShowPoints':  {'type': 'bool',  'default':true,      'title':'Show Points on Bar Charts','description':''},
					
					'enableLegend':       {'type': 'bool',  'default':true,      'title':'Enable Legend',    'description':'Show/Hide Legend.'},
					'enableErrorBars':    {'type': 'bool',  'default':false,     'title':'Enable Error Bars','description':'Show/Hide.'},
					'enableColorBar':     {'type': 'bool',  'default':true,      'title':'Enable Color Bar', 'description':'Show/Hide.'},
					'enableGradient':     {'type': 'bool',  'default':false,     'title':'Enable Gradient',  'description':'Color gradient.'},
					
					'xlim':               {'type': 'array', 'default':undefined, 'title':'X Limits','description':'X-axis limits [low,high].'},
					'ylim':               {'type': 'array', 'default':undefined, 'title':'Y Limits','description':'Y-axis limits [low,high].'},
					'xscale':             {'type': 'float', 'default':undefined, 'title':'X Scale', 'description':'X-axis set manual scale.'},
					'yscale':             {'type': 'float', 'default':undefined, 'title':'Y Scale', 'description':'Y-axis set manual scale.'},
					'xticks':             {'type': 'array', 'default':undefined, 'title':'X Ticks', 'description':'X-axis tick mark locations.'},
					'yticks':             {'type': 'array', 'default':undefined, 'title':'Y Ticks', 'description':'Y-axis tick mark locations.'},
					
					'publication_mode':   {'type': 'bool',  'default':false,     'title':'Publication Mode', 'description':'Hide identifiers.'},
					'default_png_dpi':    {'type': 'int',   'default':300,       'title':'Default PNG DPI',  'description':'Image resolution.'},
					'figureSizeOverride': {'type': 'array', 'default':undefined, 'title':'Figure Size',      'description':'[W,H] in inches.'},
					'colorsOverride':     {'type': 'array', 'default':[],        'title':'Colors Override',  'description':'One per line.'},
					'legendLoc':          {'type': 'choice','default':'best',    'title':'Legend Location',  'description':'', 'choices': ['best', 'lower left', 'lower center', 'lower right', 'upper left', 'upper center', 'upper right', 'center left', 'center', 'center right']},
					'legendLabels':       {'type': 'array', 'default':[],        'title':'Legend Labels',    'description':'Legend entries.'},
					'legendTitleOverride':{'type': 'string','default':'',        'title':'Legend Title',     'description':'Legend heading.'},
				},
				modePlotSettingDefaults: undefined,
				
				chipSummarySettings: {
					'specificDeviceList':       {'type': 'array', 'default':[],         'title':'Specific Devices',     'description':''},
					'numberOfRecentIndexes':    {'type': 'int',   'default':1,          'title':'Data Sets per Device', 'description':''},
					'minOnCurrent':             {'type': 'float', 'default':undefined,  'title':'Min On-Current',       'description':'Filter.'},
					'maxOnCurrent':             {'type': 'float', 'default':undefined,  'title':'Max On-Current',       'description':'Filter.'},
					'maxOffCurrent':            {'type': 'float', 'default':undefined,  'title':'Max Off-Current',      'description':'Filter.'},
					'maxGateCurrent':           {'type': 'float', 'default':undefined,  'title':'Max Gate Current',     'description':'Filter.'},
				},
				chipSummarySettingDefaults: undefined,
				
				deviceSummarySettings: {
					'numberOfRecentExperiments': {'type': 'int',   'default':1,     'title':'Recent Experiments to Show', 'description':''},
				},
				deviceSummarySettingDefaults: undefined,
				
				// === Dashboard ===
				
				recentActivityCategory: 'chip',
				
				recentActivityProject: undefined,
				recentActivityWafer:   undefined,
				recentActivityChip:    undefined,
				recentActivityDevice:  undefined,
				
				recentActivity: [],
				recentActivityHeaders: [
					{'text':'User',    'value':'user',     'visible':true},
					{'text':'Project', 'value':'project',  'visible':true},
					{'text':'Wafer',   'value':'wafer',    'visible':true},
					{'text':'Chip',    'value':'chip',     'visible':true},
					{'text':'Device',  'value':'device',   'visible':true},
					{'text':'Modified','value':'modified', 'visible':true},
				],
								
				// === Browser ===
				
				runTypeThemeColors: {
					'GateSweep':'blue accent-1',
					'DrainSweep':'pink accent-1',
					'StaticBias':'deep-purple accent-1',
					'AutoGateSweep':'blue accent-1',
					'AutoDrainSweep':'pink accent-1',
					'AutoStaticBias':'deep-purple accent-1',
				},
				
				users: [],
				user: localStorage.user ? JSON.parse(localStorage.user) : '',
				
				projects: [],
				project: localStorage.project ? JSON.parse(localStorage.project) : '',
				projectTableHeaders: [
					{'text':'Name', 'value':'name'}],
				projectTableSearch: '',
				
				wafers: [],
				wafer: localStorage.wafer ? JSON.parse(localStorage.wafer) : '',
				waferTableHeaders: [
					{'text':'Name', 		'value':'name'},
					{'text':'Path', 		'value':'path', 			'filterable':false},
					{'text':'Date Modified','value':'modificationTime', 'filterable':false},
					{'text':'Size', 		'value':'size', 			'filterable':false},
					{'text':'Chips', 		'value':'chipCount', 		'filterable':false},
					{'text':'Indexes', 		'value':'indexCount', 		'filterable':false},
					{'text':'Experiments', 	'value':'experimentCount', 	'filterable':false}],
				waferTableSearch: '',
				
				chips: [],
				chip: localStorage.chip ? JSON.parse(localStorage.chip) : '',
				chipTableHeaders: [
					{'text':'Name', 		'value':'name'},
					{'text':'Path', 		'value':'path', 			'filterable':false},
					{'text':'Date Modified','value':'modificationTime', 'filterable':false},
					{'text':'Size', 		'value':'size', 			'filterable':false},
					{'text':'Devices', 		'value':'deviceCount', 		'filterable':false},
					{'text':'Indexes', 		'value':'indexCount', 		'filterable':false},
					{'text':'Experiments', 	'value':'experimentCount', 	'filterable':false}],
				chipTableSearch: '',
				
				devices: [],
				device: localStorage.device ? JSON.parse(localStorage.device) : '',
				deviceTableHeaders: [
					{'text':'Name', 		'value':'displayName'},
					{'text':'Path', 		'value':'path', 			'filterable':false},
					{'text':'Date Modified','value':'modificationTime', 'filterable':false},
					{'text':'Size', 		'value':'size', 			'filterable':false},
					{'text':'Indexes', 		'value':'indexCount', 		'filterable':false},
					{'text':'Experiments', 	'value':'experimentCount', 	'filterable':false}],
				deviceTableSearch: '',
				
				experiments: [],
				experimentIndex: localStorage.experimentIndex ? JSON.parse(localStorage.experimentIndex) : 0,
				experimentTableHeaders: [
					{'text':'Experiment Number', 	'value':'startIndexes.experimentNumber'},
					{'text':'Run Type', 			'value':'runType'},
					{'text':'Measurement System', 	'value':'MeasurementSystem.systemType'},
					{'text':'Indexes', 				'value':'uiComputed.indexCount'}],
				experimentTableSearch: '',
				
				indexes: [],
				
				enableChipSummaryPlots: false,
				enableDeviceSummaryPlots: false,
				possibleChipPlots: [],
				possibleDevicePlots: [],
				
				disabledPlots: localStorage.disabledPlots ? JSON.parse(localStorage.disabledPlots) : [],
				
				noteAddition: '',
				noteContent: '',
				noteClearDialog: false,
				
				// === Schedule Builder ===
								
				scheduleObjects: localStorage.scheduleObjects ? JSON.parse(localStorage.scheduleObjects) : {},
				scheduleObjectDefault: {},
				scheduleObjectClipboard: localStorage.scheduleObjectClipboard ? JSON.parse(localStorage.scheduleObjectClipboard) : {},
				
				essentialScheduleParameters: {},
				
				scheduleBuilderPreview: false,
				scheduleBuilderSaveDialog: false,
				
				builderSaveUser: '',
				builderSaveProject: '',
				builderSaveFileName: '',
				builderLoadUser: '',
				builderLoadProject: '',
				builderLoadFileName: '',
				
				// === Experiment Runner ===
				
				dispatcherRunning: false,
				dispatcherStopping: false,
				dispatcherIdentifiers: undefined,
				
				runnerChoice: '',
				runnerLoadingFromDefaults: false, 
				
				runnerUser: '',
				runnerProject: '',
				runnerFileName: '',
				
				runnerScheduleObjects: [],
				runnerScheduleObjectDefaults: [],
				runnerVerboseScheduleObjects: [],
				runnerVerboseScheduleObjectDefaults: [],
				
				runnerShowPreview: 0,
				runnerToggleAdvancedSettings: false,
				runnerScheduleObjectsHasBeenModified: false,
				
				// === Progress Bars ===
				
				showProgress: false,
				
				experimentProgressTimer: {
					start: 0,
					current: 0
				},
				
				experimentProgressModel: {
					'Dispatcher': {
						title: '',
						visible: false,
						name: '',
						start: 0,
						current: 0,
						end: 0,
					},
					'Sweep': {
						title: 'Sweep: ',
						visible: false,
						name: '',
						start: 0,
						current: 0,
						end: 0,
					},
					'Group1': {
						title: '',
						visible: false,
						name: '',
						start: 0,
						current: 0,
						end: 0,
					},
					'Group2': {
						title: '',
						visible: false,
						name: '',
						start: 0,
						current: 0,
						end: 0,
					},
					'Procedure': {
						title: 'Procedure: ',
						visible: false,
						name: '',
						start: 0,
						current: 0,
						end: 0,
						time_start: 0,
						time_current: 0
					}
				},

				// === Live Plots ===
				
				livePlots: {'exampleJob':{'exampleDevice':{'examplePlotID':{traces:{'exampleTraceID':{xData:[],yData:[]}}}}}},   
				liveDataCounter: 0,   
				
				jobSelectChoice: '',
				jobSelectActive: '',
				jobSelectItems: [],
				
				deviceSelectChoice: '',
				deviceSelectActive: '',
				deviceSelectItems: [],

				// === Benchtop ===
				
				benchtop: {
					system: undefined,
					refresh_rate: 1,
					channel1: {
						enabled: false,
						setpoint: 0,
						input: 0,
						voltage_measured: 0,
						current_measured: 0,
						voltage_units: 'V',
						current_units: 'µA',
					},
					channel2: {
						enabled: false,
						setpoint: 0,
						input: 0,
						voltage_measured: 0,
						current_measured: 0,
						voltage_units: 'V',
						current_units: 'µA',
					},
					plot_info:{
						start_time: undefined,
						tracking_window: 30,
						splitscreen: false,
						
						peak_value: 0,
						min_ylimit: 1e-9,	
						max_data_length: 500,
					},
					plot: {
						'plotID': 'Benchtop',
						'xAxisTitle':'Time',
						'yAxisTitle':'Current (A)',
						'yScale':'linear',
						'plotMode':'lines+markers',
						'color': '',
						'theme': 'dark',
						'xRange': [0, 30],
						'yRange': undefined,
						'traces':{
							'channel1':{xData:[], yData:[], color:'#3F51B5', traceID:'CH1', visible:false},
							'channel2':{xData:[], yData:[], color:'#880E7F', traceID:'CH2', visible:false},
						},
					},
				},

				// === Performance App ===
				
				performanceRunning: false,
				
				performanceShowOptions: undefined,
				performanceShowAdvanced: undefined,
				
				performanceMetricsExtract: true,
				performanceMetricsShowOnPlot: true,
				
				performanceScheduleObject: {},
				
				performancePlots: {
					'Transfer Curve':{
						'plotID': 'Transfer Curve',
						'xAxisTitle':'Gate Voltage (V)',
						'yAxisTitle':'Drain Current (A)',
						'yScale':'linear',
						'plotMode':'markers',
						'color': '',
						'traces':{},
					},
					'Subthreshold Curve':{
						'plotID': 'Subthreshold Curve',
						'xAxisTitle':'Gate Voltage (V)',
						'yAxisTitle':'Drain Current (A)',
						'yScale':'log',
						'plotMode':'markers',
						'color': '',
						'traces':{},
					},
					'Output Curve':{
						'plotID': 'Output Curve',
						'xAxisTitle':'Drain Voltage (V)',
						'yAxisTitle':'Drain Current (A)',
						'yScale':'linear',
						'plotMode':'markers',
						'color': '',
						'traces':{},
					},
				},
				
				// === PT Sensor App ===
				
				ptSensorRunning: false,
				ptSensorScheduleObject: {},
				ptSensorPlots: {
					'Impedance': {
						'xAxisTitle':'Time (s)',
						'yAxisTitle':'Impedance (Ohms)',
						'yScale':'linear',
						'plotMode':'lines',
						'traces':{},
					},
				},
				
				// === About ===
				
				ReadMeHTML: '',
				
				// === Documentation ===

				documentationThemes: {
					'Dashboard': 		{'color': 'color_base',    'icon':'dashboard'},
					'Experiment Runner':{'color': 'color_runner',  'icon':'play_circle_outline'},
					'Schedule Builder': {'color': 'color_builder', 'icon':'schedule'},
					'Browser': 			{'color': 'color_browser', 'icon':'view_carousel'},
					'Benchtop': 		{'color': 'color_benchtop','icon':'speed'},
					'Settings': 		{'color': 'info', 		   'icon':'settings'},
				},

				documentationInfo: [],
				documentationProposedInfo: [],
				documentationDeleteDialogVisible: false,
				documentationDeleteIndex: -1
			},
			methods: {
				// === Server Requests ===
				serverAddress: function() {
					return '';
					//return 'http://' + this.serverDomain + ':' + this.serverPort;
				},
				getJSON: function(path, callback, errorMessage) {
					if (path) {
						$.getJSON(this.serverAddress() + path, callback).fail(() => {console.log(errorMessage)});
					}
				},
				postJSON: function(path, data, callback, errorMessage) {
					if(path) {
						$.post(this.serverAddress() + path, data, callback).fail(() => {console.log(errorMessage)});
					}
				},
				fetchJSON: function(path, callback) {
					if(path) {
						fetch(this.serverAddress() + path).then(response => response.json()).then(callback);
					}
				},
				fetchText: function(path, callback) {
					if(path) {
						fetch(this.serverAddress() + path).then(response => response.text()).then(callback);
					}
				},
				
				// === Initialization ===
				
				initialize: function() {
					// Call this method once on start-up to get everything ready
					
					this.getAll();
					this.initializePlotSettingDefaults();
					this.initializeDocumentation();
				},
				
				// === Refresh ===
				
				getAll: function() {
					this.getWorkspace();
					this.getUsers();
					this.getProjects();
					this.getWafers();
					this.getChips();
					this.getDevices();
					this.getExperiments();
					this.getRecentActivity();
					
					this.getDefaultParameters();
					this.getPaths();
					
					this.getAvailableMeasurementSystems();
					this.getScheduleNames();
					
					this.pageLoading = false;
					this.getPossibleChipPlots();
					this.getPossibleDevicePlots();
					this.getReadMe();
					this.getAssociatedAFMs();
					
					this.newCacheBust();
				},
				
				getWorkspace: function() {
					this.setWorkspaceDataFolder(this.workspaceDataFolderPath);
				},
				getUsers: function() {
					var path = "/users.json" + this.cacheBust;
					this.getJSON(path, (response => {this.users = response}), "Error getting users");
				},
				getProjects: function() {
					var path = '/' + this.user + '/projects.json' + this.cacheBust;
					this.getJSON(path, (response => {this.projects = response}), "Error getting projects");
				},
				getWafers: function() {
					var path = '/' + this.user + '/' + this.project + '/wafers.json' + this.cacheBust;
					this.getJSON(path, (response => {this.wafers = response}), "Error getting wafers");
					
					this.getIndexes();
				},
				getIndexes: function() {
					var path = '/' + this.user + '/' + this.project + '/indexes.json' + this.cacheBust;
					this.getJSON(path, (response => {this.indexes = response}), "Error getting indexes");
				},
				getChips: function() {
					var path = '/' + this.user + '/' + this.project + '/' + this.wafer + '/chips.json' + this.cacheBust;
					this.getJSON(path, (response => {this.chips = response}), "Error getting chips");
				},
				getDevices: function() {
					var path = '/' + this.user + '/' + this.project + '/' + this.wafer + '/' + this.chip + '/devices.json' + this.cacheBust;
					this.getJSON(path, (response => {
						response.map(function(device) {
							var contacts = device.name.match(/\d+/g)
							if(contacts != null) {
								contacts = contacts.map(num => num.padStart(2, '0'));
								device.displayName = contacts.join('-');
							} else {
								device.displayName = device.name;
							}
							return device;
						});
						this.devices = response;
					}), "Error getting devices");
				},
				getExperiments: function() {
					var path = '/' + this.user + '/' + this.project + '/' + this.wafer + '/' + this.chip + '/' + this.device + '/experiments.json' + this.cacheBust;
					this.getJSON(path, (response => {
						for (var i = 0; i < response.length; i++) {
							response[i]['uiComputed'] = {};
							response[i]['uiComputed']['indexCount'] = response[i]['endIndexes']['index'] - response[i]['startIndexes']['index'];
						}
						this.experiments = response;
						console.log("Loaded experiments.");
						
						// getNote depends on this.experiments being up-to-date, so we should refresh it any time this.experiments changes
						this.getNote();
					}), "Error getting experiments");
				},
				getRecentActivity: function() {
					var path = '/' + this.user + '/' + this.recentActivityProject + '/' + this.recentActivityWafer + '/' + this.recentActivityChip + '/' + this.recentActivityDevice + '/' + this.recentActivityCategory + '/recentActivity.json' + this.cacheBust;
					this.getJSON(path, (response => {this.recentActivity = response}), "Error getting recent activity");
				},
				
				getDefaultParameters() {
					var path1 = "/defaultParameters.json" + this.cacheBust;
					this.getJSON(path1, (response => {this.defaultParameters = response;}), "Error getting default parameters");
					
					var path2 = "/defaultParametersDescription.json" + this.cacheBust;
					this.getJSON(path2, (response => {
						this.defaultParametersDescription = response;
						this.scheduleObjectDefault     = JSON.parse(JSON.stringify(response));
						this.scheduleObjects          = [JSON.parse(JSON.stringify(response))];
						this.performanceScheduleObject = JSON.parse(JSON.stringify(response));
						this.ptSensorScheduleObject = JSON.parse(JSON.stringify(response));
					}), "Error getting default parameters description");
					
					var path3 = "/defaultEssentialParameters.json" + this.cacheBust;
					this.getJSON(path3, (response => {this.essentialScheduleParameters = response;}), "Error getting essential defaults");
					
					var path4 = "/defaultIdentifiers.json" + this.cacheBust;
					this.getJSON(path4, (response => {this.defaultIdentifiers = response;}), "Error getting identifier defaults");
				},
				getPaths: function() {
					var path = '/paths.json' + this.cacheBust;
					this.getJSON(path, (response => {this.paths = response}), "Error getting paths");
				},
				getScheduleNames: function() {
					var path1 = '/userDefinedScheduleNames.json' + this.cacheBust;
					this.getJSON(path1, (response => {this.userDefinedScheduleNames = response}), "Error getting all user-defined schedule names");
					
					var path2 = '/standardScheduleNames.json' + this.cacheBust;
					this.getJSON(path2, (response => {this.standardScheduleNames = response}), "Error getting standard schedule names");
				},
				
				getPossibleChipPlots: function() {
					var path = '/' + this.user + '/' + this.project + '/' + this.wafer + '/' + this.chip + '/availableChipPlots.json' + this.cacheBust;
					this.getJSON(path, (response => {this.possibleChipPlots = response}), "Error getting possible chip plots");
				},
				getPossibleDevicePlots: function() {
					var path = '/' + this.user + '/' + this.project + '/' + this.wafer + '/' + this.chip + '/' + this.device + '/availableDevicePlots.json' + this.cacheBust;
					this.getJSON(path, (response => {this.possibleDevicePlots = response}), "Error getting possible device plots");
				},
				getReadMe: function() {
					var path = '/readme.md';
					this.fetchText(path, (text => {
						var converter = new showdown.Converter();
						this.ReadMeHTML = converter.makeHtml(text);
					}));
				},
				getAssociatedAFMs: function() {
					var experiment = this.experiments[this.experimentIndex];
					
					if (!experiment) return;
					
					if (!(experiment.runType.includes('AFM') || experiment.runType.includes('SGM'))) {
						experiment.associatedAFMs = {};
						return;
					}
					
					startTime = experiment.startIndexes.timestamp;
					endTime = experiment.endIndexes.timestamp;
					var path = '/AFMFilesInTimestampRange/' + startTime + '/' + endTime + '/associatedAFMs.json' + this.cacheBust;
					this.getJSON(path, (response => {Vue.set(experiment, 'associatedAFMs', response)}), "Error getting associated AFMs");
				},
				
				newCacheBust: function() {
					var cacheBust = '?cb=' + new Date().getTime();
					this.cacheBust = cacheBust;
					return cacheBust;
				},
				
				// === System Configuration ===
				
				setWorkspaceDataFolder: function(newWorkspaceDataFolderPath) {
					if(newWorkspaceDataFolderPath) {
						var path = '/setWorkspaceDataFolderPath' + this.cacheBust;
						this.postJSON(path, JSON.stringify(newWorkspaceDataFolderPath), (response => {
							console.log("Set workspace data folder to: " + newWorkspaceDataFolderPath);
						}), "Error setting workspace data folder.");
						
						localStorage.workspaceDataFolderPath = JSON.stringify(newWorkspaceDataFolderPath);
					}
				},
				
				getAvailableMeasurementSystems: function() {
					var path = '/availableMeasurementSystems.json' + this.cacheBust;
					this.getJSON(path, (response => {
						console.log("Requested updated connection status.");
					}), "Error getting measurement systems.");
				},
				connectToMeasurementSystem: function(system) {
					var path = '/connectToMeasurementSystem' + this.cacheBust;
					this.postJSON(path, JSON.stringify(system), (response => {
						console.log("Requested connection to new measurement system.");
					}), "Error connecting to measurement system.");					
				},
				disconnectFromMeasurementSystem: function() {
					var path = '/disconnectFromMeasurementSystem.json' + this.cacheBust;
					this.getJSON(path, (response => {
						console.log("Requested disconnection from measurement system.");
						
						// Also disconnect from benchtop system (if applicable)
						if(this.benchtop.system) this.benchtopDisconnectFromMeasurementSystem();
					}), "Error disconnecting from measurement systems.");
				},
				
				autoAcquireMeasurementSystem: function(callback=undefined, timeout=3000) {
					// Immediately start the clock: if this process takes too long, we will just give up and trigger the callback
					this.initializeAcquiringMeasurementSystem(callback, timeout);
					
					// Enable "scanning" mode and start with Step 1: requesting an update on which systems are available
					this.acquiringMeasurementSystem.status = 'scanning';
					this.getAvailableMeasurementSystems();
				},
				specificallyAcquireMeasurementSystem: function(system, callback=undefined, timeout=3000) {
					// Immediately start the clock: if this process takes too long, we will just give up and trigger the callback
					this.initializeAcquiringMeasurementSystem(callback, timeout);
					
					// Enable "connecting" mode and skip straight to Step 2: a connection request
					this.acquiringMeasurementSystem.status = 'connecting';
					this.connectToMeasurementSystem(system);
				},
				initializeAcquiringMeasurementSystem: function(callback=undefined, timeout=3000) {
					if(callback) {
						this.acquiringMeasurementSystem.callback = callback;
						if(timeout !== undefined) setTimeout(this.finishAcquiringMeasurementSystem, timeout);
					}
				},
				finishAcquiringMeasurementSystem: function() {					
					// Check if a callback is still scheduled to trigger, if so trigger it (if not, do nothing)
					var callback = this.acquiringMeasurementSystem.callback;
					if(callback) {
						this.acquiringMeasurementSystem.callback = undefined;
						callback();
					}
				},
				
				// === Navigate ===
				
				setTopLevelPage: function(name) {
					this.topLevelPage = name;
					localStorage.topLevelPage = JSON.stringify(name);
				},
				addUser: function(userName) {
					var path = '/' + userName + '/addUser.json' + this.cacheBust;
					this.getJSON(path, (response => {
						console.log('Successfully created new user: ' + userName);
					}), "Error creating new user");
					
					this.goToUser(userName);
				},
				
				goToBeginning: function() {
					this.stepperPage = 1;
				},
				goBack: function() {
					this.stepperPage--;
				},
				goToDirectly: function(projectName, waferName, chipName, deviceName) {
					this.goToBeginning();
					if(projectName) { this.goToProject(projectName); } else { return; }
					if(waferName)   { this.goToWafer(waferName);     } else { return; }
					if(chipName)    { this.goToChip(chipName);       } else { return; }
					if(deviceName)  { this.goToDevice(deviceName);   } else { return; }
				},
				goToIdentifiers: function(identifiers) {
					var userName    = identifiers['user']?    identifiers['user']    : this.defaultIdentifiers['user']['default'];
					if(this.user !== userName) this.goToUser(userName);
					var projectName = identifiers['project']? identifiers['project'] : this.defaultIdentifiers['project']['default'];
					var waferName   = identifiers['wafer']?   identifiers['wafer']   : this.defaultIdentifiers['wafer']['default'];
					var chipName    = identifiers['chip']?    identifiers['chip']    : this.defaultIdentifiers['chip']['default'];
					var deviceName  = identifiers['device']?  identifiers['device']  : this.defaultIdentifiers['device']['default'];
					this.goToDirectly(projectName, waferName, chipName, deviceName);
				},
				goToUser: function(userName) {
					this.user = userName;
					localStorage.user = JSON.stringify(userName);
					this.getAll();
					this.goToBeginning();
				},
				goToProject: function(projectName) {
					this.project = projectName;
					localStorage.project = JSON.stringify(projectName);
					this.getWafers();
					this.stepperPage = 2;
				},
				goToWafer: function(waferName) {
					this.wafer = waferName;
					localStorage.wafer = JSON.stringify(waferName);
					this.getChips();
					this.stepperPage = 3;
				},
				goToChip: function(chipName) {
					this.chip = chipName;
					localStorage.chip = JSON.stringify(chipName);
					this.getDevices();
					this.getPossibleChipPlots()
					this.stepperPage = 4;
				},
				goToDevice: function(deviceName) {
					this.device = deviceName;
					localStorage.device = JSON.stringify(deviceName);
					this.getExperiments();
					this.getPossibleDevicePlots()
					this.stepperPage = 5;
				},
				goToExperiment: function(experimentIndex) {
					this.experimentIndex = experimentIndex;
					localStorage.experimentIndex = JSON.stringify(experimentIndex);
					this.getNote();
					this.stepperPage = 6;
				},
								
				
				// === Schedule File (Loading/Saving/Launching) ===
				
				scheduleFilePath: function(user, project, fileName) {
					return user + '/' + project + '/' + fileName + '.json';
				},
				
				loadSchedulePath: function(user, project, fileName, requestFromDefaults=false) {
					if(requestFromDefaults) return '/loadStandardSchedule/' + fileName + '.json' + this.cacheBust;
					return '/loadSchedule/'      + this.scheduleFilePath(user, project, fileName) + this.cacheBust;
				},
				loadBriefSchedulePath: function(user, project, fileName, requestFromDefaults=false) {
					if(requestFromDefaults) return '/loadBriefStandardSchedule/' + fileName + '.json' + this.cacheBust;
					return '/loadBriefSchedule/' + this.scheduleFilePath(user, project, fileName) + this.cacheBust;
				},
				saveSchedulePath: function(user, project, fileName) {
					return '/saveSchedule/'      + this.scheduleFilePath(user, project, fileName) + this.cacheBust;
				},
			
				launchDispatcherPath: function(user, project, fileName) {
					return '/dispatchSchedule/'  + this.scheduleFilePath(user, project, fileName) + this.cacheBust;
				},
				launchDispatcherRunTypePath: function(runType) {
					return '/dispatchRunType/' + runType + '.json' + this.cacheBust;	
				},
				stopDispatcherPath: function() {
					return '/stopDispatcher' + this.cacheBust;
				},
				
				// === Dashboard ===
				
				resetDashboard: function() {
					this.resetRecentActivityFilter();
					this.recentActivityCategory = 'chip';
				},
				resetRecentActivityFilter: function() {
					this.recentActivityProject = undefined;	
					this.recentActivityWafer   = undefined;
					this.recentActivityChip    = undefined;
					this.recentActivityDevice  = undefined;
				},
				hasModifiedRecentActivityFilter : function() {
					return (this.recentActivityProject || this.recentActivityWafer || this.recentActivityChip || this.recentActivityDevice);
				},
				setRecentActivityCategory: function(category) {
					this.recentActivityCategory = category;
					this.getRecentActivity();
				},
				recentActivityIncludesCategory: function(category_list) {
					return (category_list.includes(this.recentActivityCategory));
				},
				
				// === Experiment Runner ===
				
				runnerReset: function() {
					this.runnerChoice = '';
					this.showProgress = false;
					this.getAvailableMeasurementSystems();
				},
				runnerClear: function() {
					this.clearProgressBars();
					this.clearLivePlots();
				},
				runnerUpdateChoice: function() {									
					if((this.runnerChoice === 'Schedule File') || (this.runnerChoice === '')) { 
						this.runnerLoadingFromDefaults = false;
						this.runnerScheduleObjectsHasBeenModified = false;
						this.runnerUser = '';
						this.runnerProject = '';
						this.runnerFileName = '';
						return; 
					}
					
					this.runnerLoadingFromDefaults = true;
					this.runnerScheduleObjectsHasBeenModified = true;
					this.runnerUser = 'admin';
					this.runnerProject = 'standards';
					this.runnerFileName = this.runnerChoice;
				},
				
				runnerStart: function() {
					// Rather than dispatching immediately, first refresh the measurement systems.
					// If a measurement system is already connected, it stays connected. But if not, the system will attempt to auto-acquire.
					this.autoAcquireMeasurementSystem(callback=this.runnerDispatch);	
				},
				runnerDispatch: function(userName=undefined, projectName=undefined, fileName=undefined) {
					userName    = userName?    userName    : this.runnerUser;
					projectName = projectName? projectName : this.runnerProject;
					fileName    = fileName?    fileName    : this.runnerFileName;
					var path = this.launchDispatcherPath(userName, projectName, fileName);
					this.getJSON(path, (response => {this.dispatcherRunning = true; this.dispatcherStopping = false;}), "Error dispatching schedule file");
				},
				runnerStop: function() {
					var path = this.stopDispatcherPath();
					this.getJSON(path, (response => {this.dispatcherStopping = true;}), "Error stopping dispatcher");
				},
				
				runnerLoadScheduleFile: function() {
					if(this.runnerUser && this.runnerProject && this.runnerFileName) {
						var path = this.loadBriefSchedulePath(this.runnerUser, this.runnerProject, this.runnerFileName, this.runnerLoadingFromDefaults);
						
						this.getJSON(path, (response => {this.runnerScheduleObjects = response}), "Error loading schedule file (experiment runner).");
						this.getJSON(path, (response => {this.runnerScheduleObjectDefaults = response}), "Error loading schedule file (experiment runner).");
						
						var path = this.loadSchedulePath(this.runnerUser, this.runnerProject, this.runnerFileName, this.runnerLoadingFromDefaults);

						this.getJSON(path, (response => {this.runnerVerboseScheduleObjects = response}), "Error loading schedule file (experiment runner).");
						this.getJSON(path, (response => {this.runnerVerboseScheduleObjectDefaults = response}), "Error loading schedule file (experiment runner).");
						
						console.log("Loaded the active experiment runner schedule file: " + path);
					}
				},
				runnerSaveScheduleFile: function(callback=undefined) {
					if(this.isNecessaryToSaveRunnerScheduleFile()) {
						// Sync basic and advanced options panels
						this.addAdvancedChangesToRunnerScheduleFile();
						
						// If we are running a default file that we don't have permission to modify, must change save location
						if(this.runnerLoadingFromDefaults) {
							var activeUser = '';
							var activeProject = '';
							try {
								activeUser = this.runnerScheduleObjects[0]['Identifiers']['user']['default'];
								activeProject = this.runnerScheduleObjects[0]['Identifiers']['project']['default'];
							} catch(err) {}
							if(activeUser === '') { activeUser = 'guest'; }
							if(activeProject === '') { activeProject = 'Project'; }
							this.runnerUser = activeUser;
							this.runnerProject = activeProject;
						} 
						
						// Save current file
						var path = this.saveSchedulePath(this.runnerUser, this.runnerProject, this.runnerFileName);
						this.postJSON(path, JSON.stringify(this.runnerScheduleLines), (response => {
							// After post completes and the data is saved, run the following:
							console.log("Saved experiment runner schedule file: " + path);
							this.runnerLoadingFromDefaults = false;
							this.runnerScheduleObjectsHasBeenModified = false;
							// Force re-load of schedule file to make sure everything is refreshed to its original state
							this.runnerLoadScheduleFile();
							// Clear the cache bust to reload any plots in the experiment page
							this.newCacheBust();
							// If a callback task was provided to be run when done saving, perform that now.
							if(callback) callback();
						}), "Error saving schedule file from the experiment runner.");
					} else {
						// If saving was unnecessary, go ahead and perform the callback
						if(callback) callback();
					}
				},
				isPossibleToSaveRunnerScheduleFile: function() {
					return (this.runnerUser && this.runnerProject && this.runnerFileName && 
						(this.runnerScheduleObjects.length === this.runnerScheduleObjectDefaults.length) && 
						(this.runnerVerboseScheduleObjects.length === this.runnerVerboseScheduleObjectDefaults.length) && 
						(this.runnerScheduleObjects.length === this.runnerVerboseScheduleObjects.length));
				}, 
				isNecessaryToSaveRunnerScheduleFile: function() {
					if(this.isPossibleToSaveRunnerScheduleFile()) {
						 return this.runnerScheduleObjectsHasBeenModified || 
						 (this.hasModifiedRunnerSchedule()) || 
						 (this.hasModifiedRunnerScheduleAdvanced());
					}
					return false;
				},
				addAdvancedChangesToRunnerScheduleFile: function() {
					if(this.runnerVerboseScheduleObjects.length === 1 && this.runnerScheduleObjects.length === 1) {
						// Update the advanced options to match any changes made to the non-advanced options
						if(this.hasModifiedRunnerSchedule()) {
							var basicChanges = objectDeepDiff(this.runnerScheduleObjects[0], this.runnerScheduleObjectDefaults[0]);
							this.runnerVerboseScheduleObjects = [objectDeepMerge(this.runnerVerboseScheduleObjects[0], basicChanges)]
							
							this.runnerScheduleObjectDefaults[0]        = JSON.parse(JSON.stringify(this.runnerScheduleObjects[0]));
							this.runnerVerboseScheduleObjectDefaults[0] = JSON.parse(JSON.stringify(this.runnerVerboseScheduleObjects[0]));
							
							console.log("Refreshed advanced settings.");
							this.runnerScheduleObjectsHasBeenModified = true;
						}
						
						// Apply changes to advanced options
						if(this.hasModifiedRunnerScheduleAdvanced()) {
							var advancedChanges = objectDeepDiff(this.runnerVerboseScheduleObjects[0], this.runnerVerboseScheduleObjectDefaults[0]);
							this.runnerScheduleObjects = [objectDeepMerge(this.runnerScheduleObjects[0], advancedChanges)];
							
							this.runnerScheduleObjectDefaults[0]        = JSON.parse(JSON.stringify(this.runnerScheduleObjects[0]));
							this.runnerVerboseScheduleObjectDefaults[0] = JSON.parse(JSON.stringify(this.runnerVerboseScheduleObjects[0]));
							
							console.log("Added advanced settings to experiment runner schedule file.");
							this.runnerScheduleObjectsHasBeenModified = true;
						}
					}
				},
				hasModifiedRunnerSchedule: function() {
					var basicChanges = {}
					for (var i = 0; i < this.runnerScheduleObjects.length; i++) {
						basicChanges = objectDeepDiff(this.runnerScheduleObjects[i], this.runnerScheduleObjectDefaults[i]);
						if(Object.keys(basicChanges).length > 0) return true;
					}
					return (Object.keys(basicChanges).length > 0);
				},
				hasModifiedRunnerScheduleAdvanced: function() {
					var advancedChanges = objectDeepDiff(this.runnerVerboseScheduleObjects[0], this.runnerVerboseScheduleObjectDefaults[0]);
					return (Object.keys(advancedChanges).length > 0);
				},
				
				// === AFM Registry ===
				
				updateAFMRegistry: function() {
					var path = '/updateAFMRegistry' + this.cacheBust;
					this.getJSON(path, (response => {
						if (response['success']) {
							this.updateAFMRegistryTime = new Date();
						}
					}), "Error updaing AFM registry");
				},
				
				// === Browser ===
				
				getRunTypeColor: function(runType) {
					if(Object.keys(this.runTypeThemeColors).includes(runType)) return this.runTypeThemeColors[runType];
					return undefined;
				},
				
				caseInsensitiveDataTableFilter: function(value, search, item) {
					if(search == undefined) return true;
					
					search = search.toString().toLowerCase();
					if (search.trim() === '') return true;
										
					return value.toString().toLowerCase().indexOf(search) !== -1;
				},
				
				copyHTMLStringToClip: function (str) {
					function listener(e) {
						e.clipboardData.setData("text/html", str);
						e.clipboardData.setData("text/plain", str);
						e.preventDefault();
					}
					document.addEventListener("copy", listener);
					document.execCommand("copy");
					document.removeEventListener("copy", listener);
				},
				
				copyHTMLImageToClip: function (path) {
					path = window.location.origin + path;
					this.copyHTMLStringToClip('<img src="' + path + '" width="200">');
				},
				
				removeValueFromArray: function(value, array) {
					while(array.includes(value)) { array.splice( array.indexOf(value), 1 ); }
				},
				
				addNote: function() {
					var path = '/addNote/' + this.user + '/' + this.project + '/' + this.wafer + '/' + this.chip + '/' + this.device + '/' 
						+ this.experiment['startIndexes']['experimentNumber'];
					
					this.postJSON(path, JSON.stringify({'noteAddition': this.noteAddition}), (response => {
						console.log('Saved changes to Note.')
						this.noteAddition = '';
						this.getNote();
					}), "Error adding to note");
				},
				getNote: function() {
					var path = '/getNote/' + this.user + '/' + this.project + '/' + this.wafer + '/' + this.chip + '/' + this.device + '/' 
						+ this.experiment['startIndexes']['experimentNumber'];
					
					this.getJSON(path, (response => {this.noteContent = response['text'];}), "Error getting note");
				},
				clearNote: function() {
					var path = '/clearNote/' + this.user + '/' + this.project + '/' + this.wafer + '/' + this.chip + '/' + this.device + '/' 
						+ this.experiment['startIndexes']['experimentNumber'];
					
					this.getJSON(path, (response => {this.noteContent = ''; console.log('Cleared note.');}), "Error clearing note");
				},
				
				// === Schedule Builder ===
				
				resetScheduleBuilder: function() {
					this.scheduleObjects = [JSON.parse(JSON.stringify(this.scheduleObjectDefault))];
					this.scheduleBuilderPreview = false;
				},
				
				addScheduleJob: function(index) {
					this.scheduleObjects.splice(index, 0, JSON.parse(JSON.stringify(this.scheduleObjects[index])));
					// this.scheduleObjects.push(JSON.parse(JSON.stringify(this.scheduleObjects.slice(-1)[0])));
				},
				removeScheduleJob: function(index) {
					this.scheduleObjects.splice(index, 1);
				},
				resetScheduleJob: function(index) {
					this.scheduleObjects.splice(index, 1, JSON.parse(JSON.stringify(this.scheduleObjectDefault)));
				},
				moveScheduleJobUp: function(index) {
					var job = this.scheduleObjects[index];
					this.scheduleObjects.splice(index, 1);
					this.scheduleObjects.splice(index-1, 0, job);
				},
				moveScheduleJobDown: function(index) {
					var job = this.scheduleObjects[index];
					this.scheduleObjects.splice(index, 1);
					this.scheduleObjects.splice(index+1, 0, job);
				},
				copyScheduleObject: function(index) {
					this.scheduleObjectClipboard = JSON.parse(JSON.stringify(this.scheduleObjects[index]));
				},
				pasteScheduleObject: function(index) {
					this.scheduleObjects.splice(index, 1, JSON.parse(JSON.stringify(this.scheduleObjectClipboard)))
				},
				scheduleObjectDiffFromPrevTwin: function(index) {
					var job = this.scheduleObjects[index];
					// var twin = 
				},
				
				hasModifiedScheduleObjects: function() {
					if(this.scheduleObjects.length !== 1) return true;
					var changes = objectDeepDiff(this.scheduleObjects[0], this.scheduleObjectDefault);
					return (Object.keys(changes).length > 0);
				},
				nonTrivialScheduleObjects: function() {
					return !((this.scheduleLines.length === 0) || _.isEqual(this.scheduleLines, [{}]));
				},
				
				resetScheduleSavePath: function() {
					this.builderSaveUser = '';	
					this.builderSaveProject = '';	
					this.builderSaveFileName = '';	
					this.scheduleBuilderSaveDialog = false;
				},
				resetScheduleLoadPath: function() {
					this.builderLoadUser = '';	
					this.builderLoadProject = '';	
					this.builderLoadFileName = '';	
				},
				
				isValidScheduleSavePath: function() {
					return (this.builderSaveUser != null) && (this.builderSaveProject != null) && (this.builderSaveFileName != null) &&
						   (this.builderSaveUser !== '') && (this.builderSaveProject !== '') && (this.builderSaveFileName !== '');	
				},
				isValidScheduleLoadPath: function() {
					return (this.builderLoadUser != null) && (this.builderLoadProject != null) && (this.builderLoadFileName != null) &&
						   (this.builderLoadUser !== '') && (this.builderLoadProject !== '') && (this.builderLoadFileName !== '');	
				},
				
				saveSchedule: function() {
					var path = this.saveSchedulePath(this.builderSaveUser, this.builderSaveProject, this.builderSaveFileName);
										
					console.log('saving path = ' + path);
					this.postJSON(path, JSON.stringify(this.scheduleLines), (response => {
						console.log('Saved schedule file.');
						this.scheduleBuilderSaveDialog = true;
					}), "Error saving schedule file.");
					
					if (this.runnerUser === '') this.runnerUser = this.builderSaveUser;
					if (this.runnerProject === '') this.runnerProject = this.builderSaveProject;
					if (this.runnerFileName === '') this.runnerFileName = this.builderSaveFileName;
					
					this.getScheduleNames();
				},
				loadSchedule: function() {
					var path = this.loadSchedulePath(this.builderLoadUser, this.builderLoadProject, this.builderLoadFileName);
					
					console.log('loading path = ' + path);
					this.getJSON(path, (response => {
						console.log('Loaded schedule file.')
						this.scheduleObjects = response;
					}), "Error loading schedule file");
					
					if (this.builderSaveUser === '') this.builderSaveUser = this.builderLoadUser;
					if (this.builderSaveProject === '') this.builderSaveProject = this.builderLoadProject;
					if (this.builderSaveFileName === '') this.builderSaveFileName = this.builderLoadFileName;
				},
				
				// === Settings ===
				
				plotSettingsModifications: function() {
					var primary_modifications = _.omitBy(this.primaryPlotSettings, (v,k) => {
						return _.isEqual(v['default'], this.primaryPlotSettingDefaults[k]['default']);
					});
					var mode_modifications = _.omitBy(this.modePlotSettings, (v,k) => {
						return _.isEqual(v['default'], this.modePlotSettingDefaults[k]['default']);
					});
					var chip_modifications = _.omitBy(this.chipSummarySettings, (v,k) => {
						return _.isEqual(v['default'], this.chipSummarySettingDefaults[k]['default']);
					});
					var device_modifications = _.omitBy(this.deviceSummarySettings, (v,k) => {
						return _.isEqual(v['default'], this.deviceSummarySettingDefaults[k]['default']);
					});
					
					Object.keys(primary_modifications).forEach(function(key) {
						primary_modifications[key] = primary_modifications[key]['default'];
					});
					Object.keys(mode_modifications).forEach(function(key) {
						mode_modifications[key] = mode_modifications[key]['default'];
					});
					Object.keys(chip_modifications).forEach(function(key) {
						chip_modifications[key] = chip_modifications[key]['default'];
					});
					Object.keys(device_modifications).forEach(function(key) {
						device_modifications[key] = device_modifications[key]['default'];
					});
					
					var all_modifications = {
						'primary':primary_modifications, 
						'mode_parameters':mode_modifications, 
						'chip':chip_modifications, 
						'device':device_modifications,
					};
					
					return all_modifications;
				},
				updatePlotSettings: function() {
					var all_modifications = this.plotSettingsModifications();
					
					this.plotSettings = all_modifications;
					
					console.log("Updated plot settings: " + JSON.stringify(all_modifications));
				},
				hasModifiedPlotSettings: function() {	
					if( this.primaryPlotSettingDefaults === undefined || this.modePlotSettingDefaults === undefined || 
						this.chipSummarySettingDefaults === undefined || this.deviceSummarySettingDefaults === undefined) { return false; }
					
					var all_modifications = this.plotSettingsModifications();
					
					var is_modified = false;
					Object.keys(all_modifications).forEach(function(key) {
						if(JSON.stringify(all_modifications[key]) !== "{}") {
							is_modified = true;
						}
					});
										
					return is_modified;	
				},
				
				initializePlotSettingDefaults: function() {
					this.primaryPlotSettingDefaults   = JSON.parse(JSON.stringify(this.primaryPlotSettings));	
					this.modePlotSettingDefaults      = JSON.parse(JSON.stringify(this.modePlotSettings));	
					this.chipSummarySettingDefaults   = JSON.parse(JSON.stringify(this.chipSummarySettings));	
					this.deviceSummarySettingDefaults = JSON.parse(JSON.stringify(this.deviceSummarySettings));	
				},
				
				resetPlotSettings: function() {
					this.primaryPlotSettings = JSON.parse(JSON.stringify(this.primaryPlotSettingDefaults));	
					this.modePlotSettings    = JSON.parse(JSON.stringify(this.modePlotSettingDefaults));	
				},
				resetChipSummarySettings: function() {
					this.chipSummarySettings = JSON.parse(JSON.stringify(this.chipSummarySettingDefaults));	
				},
				resetDeviceSummarySettings: function() {
					this.deviceSummarySettings = JSON.parse(JSON.stringify(this.deviceSummarySettingDefaults));	
				},
				resetAllPlotSettings: function() {
					this.resetPlotSettings();
					this.resetChipSummarySettings();
					this.resetDeviceSummarySettings();
				},
				
				// === Benchtop ===
				
				benchtopStart: function(system) {
					this.benchtopConnectToMeasurementSystem(system, callback=this.benchtopDispatch);
				},
				benchtopDispatch: function() {
					var path = this.launchDispatcherRunTypePath('Benchtop');
					this.getJSON(path, (response => {console.log('Starting benchtop.');}), "Error dispatching benchtop");
				},
				benchtopStop: function() {
					this.benchtopDisconnectFromMeasurementSystem();
					this.getAvailableMeasurementSystems();
					this.runnerStop();
				},
				
				benchtopConnectToMeasurementSystem: function(system, callback) {
					this.benchtop.system = system;
					this.specificallyAcquireMeasurementSystem(system, callback=callback, timeout=undefined);
				},
				benchtopDisconnectFromMeasurementSystem: function() {
					this.benchtop.system = undefined;
					this.benchtopDisableChannels();
				},
				
				benchtopToggleChannel1: function() {
					if(this.benchtop.channel1.enabled) {
						this.benchtopDisableChannel1();
					} else {
						this.benchtopEnableChannel1();
					}
				},
				benchtopToggleChannel2: function() {
					if(this.benchtop.channel2.enabled) {
						this.benchtopDisableChannel2();
					} else {
						this.benchtopEnableChannel2();
					}
				},
				benchtopEnableChannel1: function() {
					this.benchtop.channel1.enabled = true;
					this.benchtop.plot.traces.channel1.visible = true;
				},
				benchtopEnableChannel2: function() {
					this.benchtop.channel2.enabled = true;
					this.benchtop.plot.traces.channel2.visible = true;
				},
				benchtopDisableChannel1: function() {
					this.benchtop.channel1.enabled = false;
					this.benchtop.plot.traces.channel1.visible = false;
					this.benchtop.channel1.input = 0;
					this.benchtopApplyVoltageChannel1();
					if(!this.benchtop.channel2.enabled) this.benchtopClear();
				},
				benchtopDisableChannel2: function() {
					this.benchtop.channel2.enabled = false;
					this.benchtop.plot.traces.channel2.visible = false;
					this.benchtop.channel2.input = 0;
					this.benchtopApplyVoltageChannel2();
					if(!this.benchtop.channel1.enabled) this.benchtopClear();
				},
				benchtopDisableChannels: function() {
					this.benchtopDisableChannel1();
					this.benchtopDisableChannel2();
				},
				
				setBenchtopVoltagePath: function(channel, voltage) {
					return '/setBenchtopVoltage/' + channel + '/' + voltage + '/';
				},
				setBenchtopRefreshRatePath: function(refresh_rate) {
					return '/setBenchtopRefreshRate/' + refresh_rate + '/';
				},
				
				benchtopApplyVoltageChannel1: function() {
					this.benchtop.channel1.setpoint = this.benchtop.channel1.input;
					var path = this.setBenchtopVoltagePath(1, this.benchtop.channel1.setpoint);
					this.getJSON(path, (response => {console.log('Set Benchtop channel1 voltage.')}), "Error setting benchtop voltage");
				},
				benchtopApplyVoltageChannel2: function() {
					this.benchtop.channel2.setpoint = this.benchtop.channel2.input;
					var path = this.setBenchtopVoltagePath(2, this.benchtop.channel2.setpoint);
					this.getJSON(path, (response => {console.log('Set Benchtop channel2 voltage.')}), "Error setting benchtop voltage");
				},
				benchtopIncrementChannel1: function(increment) {
					if(!this.benchtop.channel1.input) this.benchtop.channel1.input = 0;
					this.benchtop.channel1.input = parseFloat((this.benchtop.channel1.input + increment).toFixed(3));
					this.benchtopApplyVoltageChannel1();
				},
				benchtopIncrementChannel2: function(increment) {
					if(!this.benchtop.channel1.input) this.benchtop.channel1.input = 0;
					this.benchtop.channel2.input = parseFloat((this.benchtop.channel2.input + increment).toFixed(3));
					this.benchtopApplyVoltageChannel2();
				},
				
				benchtopApplyRefreshRate: function() {
					var path = this.setBenchtopRefreshRatePath(this.benchtopRefreshRate);
					this.getJSON(path, (response => {console.log('Set Benchtop refresh rate.')}), "Error setting benchtop refresh rate");
				},
				benchtopResetRefreshRate: function() {
					this.benchtop.refresh_rate = 1;
					this.benchtopApplyRefreshRate();
				},
				
				benchtopClear: function() {
					this.benchtopResetRefreshRate();
					this.benchtopClearPlots();
				},
				benchtopClearPlots: function() {
					this.benchtop.plot_info.start_time = undefined;
					this.benchtop.plot_info.peak_value = 0;
					this.benchtop.plot.traces.channel1.xData = [];
					this.benchtop.plot.traces.channel1.yData = [];
					this.benchtop.plot.traces.channel2.xData = [];
					this.benchtop.plot.traces.channel2.yData = [];
				},
				
				// === Performance App ===
				
				performanceReset: function() {
					this.performanceShowOptions = undefined;
					this.performanceShowAdvanced = undefined;	
					this.performanceMetricsExtract = true;
					this.performanceMetricsShowOnPlot = true;
					this.getDefaultParameters();
					this.performanceClear();
				},
				performanceClear: function() {
					Object.entries(this.performancePlots).forEach(([plotID, plot]) => {
						plot['traces'] = {};
					});
					this.liveDataCounter = 0;
				},
				performanceSave: function(callback=undefined) {
					this.performanceScheduleObject['runType']['default'] = 'FreeRun';
					
					var path = this.saveSchedulePath('guest', 'Project', 'PerformanceApp');
					this.postJSON(path, JSON.stringify([extractDefaults(this.performanceScheduleObject)]), (response => {
						console.log("Saved performance app schedule file: " + path);
						//If a callback task was provided to be run when done saving, perform that now.
						if(callback) callback();
					}), "Error saving performance app schedule file.");
				},
				performanceEnablePlots: function() {
					var deviceID = this.performanceScheduleObject['Identifiers']['device']['default'];
					if(!deviceID) deviceID = 'Device';
					this.livePlots[0] = {};
					this.livePlots[0][deviceID] = {};
					this.livePlots[0][deviceID]['Transfer Curve'] = this.performancePlots['Transfer Curve'];
					this.livePlots[0][deviceID]['Subthreshold Curve'] = this.performancePlots['Subthreshold Curve'];
					this.livePlots[0][deviceID]['Output Curve'] = this.performancePlots['Output Curve'];
				},
				performanceStart: function() {
					this.autoAcquireMeasurementSystem(callback=this.performanceDispatch);
				},
				performanceDispatch: function() {
					this.performanceRunning = true;
					this.runnerDispatch('guest', 'Project', 'PerformanceApp');
				},
				performanceStop: function() {
					this.performanceRunning = false;
					this.runnerStop();
				},
				
				// === PT Sensor App ===
				
				ptSensorReset: function() {	
					this.getDefaultParameters();
				},
				ptSensorClear: function() {
					Object.entries(this.ptSensorPlots).forEach(([plotID, plot]) => {
						plot['traces'] = {};
					});
				},
				ptSensorSave: function(callback=undefined) {
					this.ptSensorScheduleObject['runType']['default'] = 'PTSensor';
					this.ptSensorScheduleObject['MeasurementSystem']['systemType']['default'] = 'Arduino'
					
					var path = this.saveSchedulePath('guest', 'Project', 'PTSensorApp');
					this.postJSON(path, JSON.stringify([extractDefaults(this.ptSensorScheduleObject)]), (response => {
						console.log("Saved PT sensor app schedule file: " + path);
						//If a callback task was provided to be run when done saving, perform that now.
						if(callback) callback();
					}), "Error saving PT sensor app schedule file.");
				},
				ptSensorEnablePlots: function() {
					var deviceID = this.ptSensorScheduleObject['Identifiers']['device']['default'];
					if(!deviceID) deviceID = 'Device';
					this.livePlots[0] = {};
					this.livePlots[0][deviceID] = {};
					this.livePlots[0][deviceID]['Impedance'] = this.ptSensorPlots['Impedance'];
				},
				ptSensorStart: function() {
					this.ptSensorDispatch();
				},
				ptSensorDispatch: function() {
					this.ptSensorRunning = true;
					this.runnerDispatch('guest', 'Project', 'PTSensorApp');
				},
				ptSensorStop: function() {
					this.ptSensorRunning = false;
					this.runnerStop();
				},
				
				// === Server Update ===
				
				handleServerMessage: function(message) {					
					if(message.type === 'ConnectionStatus') {
						// Obtain connection status update from the message
						this.availableMeasurementSystems = message.status.available_measurement_systems;
						this.connectedMeasurementSystem = message.status.connected_system? message.status.connected_system : undefined;
						
						// Inform Benchtop mode if connection was unsuccessful
						if(this.benchtop.system && !this.connectedMeasurementSystem) this.benchtopDisconnectFromMeasurementSystem();
						
						// If Step 2 of auto-acquiring just completed, it is time to call the finish-up function
						if(this.acquiringMeasurementSystem.status === 'connecting') {
							this.acquiringMeasurementSystem.status = undefined;
							this.finishAcquiringMeasurementSystem();
						}
						
						// If Step 1 of auto-acquiring just completed, decide how to proceed
						if(this.acquiringMeasurementSystem.status === 'scanning') {
							if ((!this.connectedMeasurementSystem) && (this.availableMeasurementSystems.length === 1)) {
								// If a system is available, immeditately tigger Step 2: a connection request
								this.acquiringMeasurementSystem.status = 'connecting';
								this.connectToMeasurementSystem(this.availableMeasurementSystems[0]);
							} else {
								// Otherwise, the auto-acquiring process is simply terminated early
								this.acquiringMeasurementSystem.status = undefined;
								this.finishAcquiringMeasurementSystem();
							}
						} 
					} else 
					
					if(message.type === 'DispatcherStatus') {
						this.dispatcherRunning = message.status.running? true : false;
					} else
					
					if (message.type === 'JobNumberUpdate') {
						if(!Object.keys(this.livePlots).includes("" + message.number)){
							Vue.set(this.livePlots, message.number, {}); 
							//this.livePlots[message.number] = {};
							console.log('New live job number added: ' + message.number);
						}
						this.jobSelectItems.push(message.number);
						this.jobSelectActive = message.number;
						this.jobSelectChoice = message.number;
					} else

					if (message.type === 'DeviceNumberUpdate') {
						if(this.jobSelectActive === '') return;
						
						if(!Object.keys(this.livePlots[this.jobSelectActive]).includes(message.number)){
							Vue.set(this.livePlots[this.jobSelectActive], message.number, {}); 
							//this.livePlots[this.jobSelectActive][message.number] = {};
							console.log('New live device number added: ' + message.number)
						}
						this.deviceSelectItems.push(message.number);
						this.deviceSelectActive = message.number;
						this.deviceSelectChoice = message.number;
					} else

					if (message.type === 'Progress') {
						// Enable progress bar display
						this.showProgress = true;
						
						// Update progress bar global timer
						this.experimentProgressTimer.current = message.progress.timestamp;
						if(this.experimentProgressTimer.start === 0) {
							this.experimentProgressTimer.start = message.progress.timestamp;
						}
						
						// Update "Procedure" bar's individual timer display
						if(message.progress.barType === "Procedure"){
							this.experimentProgressModel['Procedure'].time_start = this.checkStartTime(this.experimentProgressModel['Procedure'].time_start, this.experimentProgressModel['Procedure'].current, message.progress.timestamp, message.progress.current);
							this.experimentProgressModel['Procedure'].time_current = message.progress.timestamp;
						}
						
						// Enable the "View in Browser" feature of the progress bar 
						if(message.progress.barType === "Dispatcher"){
							this.dispatcherIdentifiers = (message.info)? message.info : undefined;
						}
						
						// Update individual progress bars
						if(Object.keys(this.experimentProgressModel).includes(message.progress.barType)){
							var progressBarModel = this.experimentProgressModel[message.progress.barType];
							
							progressBarModel.visible = true;
							progressBarModel.name = message.progress.name;
							progressBarModel.start = message.progress.start;
							progressBarModel.current = message.progress.current;
							progressBarModel.end = message.progress.end;
						}
					} else
					
					if (message.type === 'Data') {
						this.showProgress = true;
						
						this.liveDataCounter += 1;
						
						// Add any new live plots that are not currently being displayed
						this.addNewLivePlots(this.livePlots[this.jobSelectActive][this.deviceSelectActive], message.plots);
												
						// Add any new traces on live plots that are not currently being displayed
						this.addNewLiveTraces(this.livePlots[this.jobSelectActive][this.deviceSelectActive], message.plots);
						
						// Append data from this message to all relevant Live Plots
						this.addNewLiveData(this.livePlots[this.jobSelectActive][this.deviceSelectActive], message.plots);
					} else
					
					if (message.type === 'BenchtopMeasurement') {
						// Display measurements
						this.benchtop.channel1.voltage_measured = message.measurement['V_ds'];
						this.benchtop.channel2.voltage_measured = message.measurement['V_gs'];
						
						var channel1_magnitude = this.scale_and_units(message.measurement['I_d']);
						var channel2_magnitude = this.scale_and_units(message.measurement['I_g']);
						
						this.benchtop.channel1.current_measured = (message.measurement['I_d'] * channel1_magnitude.scale).toFixed(1);
						this.benchtop.channel2.current_measured = (message.measurement['I_g'] * channel2_magnitude.scale).toFixed(1);
						this.benchtop.channel1.current_units = channel1_magnitude.units + 'A';
						this.benchtop.channel2.current_units = channel2_magnitude.units + 'A';
						
						// Plot over time 
						if(this.benchtop.plot_info.start_time === undefined) this.benchtop.plot_info.start_time = message.timestamp;
						this.benchtop.plot_info.peak_value = Math.max(this.benchtop.plot_info.peak_value, Math.abs(message.measurement['I_d']));
						this.benchtop.plot_info.peak_value = Math.max(this.benchtop.plot_info.peak_value, Math.abs(message.measurement['I_g']));
						
						var timestamp = message.timestamp - this.benchtop.plot_info.start_time
						this.benchtop.plot.traces.channel1.xData.push(timestamp); 
						this.benchtop.plot.traces.channel1.yData.push(message.measurement['I_d']);
						this.benchtop.plot.traces.channel2.xData.push(timestamp);
						this.benchtop.plot.traces.channel2.yData.push(message.measurement['I_g']);
						
						// Adjust plot x-axis to always show the last 30 seconds of data
						this.benchtop.plot.xRange = (timestamp > this.benchtop.plot_info.tracking_window)? 
							[timestamp-this.benchtop.plot_info.tracking_window,timestamp] : [0,this.benchtop.plot_info.tracking_window];
						
						// Adjust plot y-axis to prevent auto-zooming in to closer than +/- 1 nA
						this.benchtop.plot.yRange = (this.benchtop.plot_info.peak_value > this.benchtop.plot_info.min_ylimit)? undefined : [-this.benchtop.plot_info.min_ylimit,this.benchtop.plot_info.min_ylimit];
						
						// When data gets longer than 500 entries, start discarding oldest data to preserve memory space
						if(this.benchtop.plot.traces.channel1.xData.length > this.benchtop.plot_info.max_data_length) {
							this.benchtop.plot.traces.channel1.xData.shift();
							this.benchtop.plot.traces.channel1.yData.shift();
						} 
						if(this.benchtop.plot.traces.channel2.xData.length > this.benchtop.plot_info.max_data_length) {
							this.benchtop.plot.traces.channel2.xData.shift();
							this.benchtop.plot.traces.channel2.yData.shift();
						} 
					}
				},

				// === Progress Bars ===
				
				clearProgressBars: function(){
					this.experimentProgressTimer.start = 0;
					this.experimentProgressTimer.current = 0;
					
					Object.entries(this.experimentProgressModel).forEach(([barID, barModel]) => {
						barModel.visible = false;
						barModel.name = '';
						barModel.start = 0;
						barModel.current = 0;
						barModel.end = 0;
					});
					
					this.experimentProgressModel['Procedure'].time_start = 0;
					this.experimentProgressModel['Procedure'].time_current = 0;
				},
				computeProgressPercent: function(start, current, end) {
					start = parseFloat(start);
					current = parseFloat(current);
					end = parseFloat(end);
					var result = (current - start)/(end - start);
					return result*100;
				},
				checkStartTime: function(prev_time, prev_value, current_time, current_value) {
					if((prev_time === 0) || (current_value < prev_value)){
						return current_time;
					}
					return prev_time;
				},
				
				// === Live Plots ===
			    
			    addNewLivePlots: function(livePlots, newPlotsData) {
			    	// Filter for any "newPlots" that are not found in Live Plots
			    	var missingPlots = newPlotsData.filter( p => !(Object.keys(livePlots).includes(p.plotID)) );
			    	if(missingPlots.length < 1) return;
			    	
			    	// Get a reference to a non-live copy of all current Live Plots
			    	var staticPlots = JSON.parse(JSON.stringify(livePlots));
			    	
			    	for(newPlot of missingPlots) {
			    		// Make a copy of newPlot to avoid corrupting it with modifications
				    	var plot = JSON.parse(JSON.stringify(newPlot));
				    	
				    	// Initialize all traces to have empty data arrays
				    	Object.entries(plot['traces']).forEach(([traceID, trace]) => {
				    		trace.xData = [];
				    		trace.yData = [];
				    	});
				    	
				    	// Put the new plot into place (in the non-live copy of Live Plots)
				    	staticPlots[plot.plotID] = plot;
				    	
				    	// Put the new plot into place (possible option if you don't want to use staticPlots)
				    	//livePlots[plot.plotID] = plot;
			    	}
			    	
			    	// Copy all changes over to Live Plots
			    	this.safeParseToVueVariable(staticPlots, livePlots);
			    },
			    addNewLiveTraces: function(livePlots, newPlotsData) {
			    	for(newPlot of newPlotsData) {
			    		var plotID = newPlot.plotID

			    		// Filter for any traces that are not found in this plot in Live Plots
			    		var missingTraceIDs = Object.keys(newPlot.traces).filter( traceID => !(Object.keys(livePlots[plotID].traces).includes(traceID)) );
			    		var missingTraces = missingTraceIDs.map( traceID => newPlot['traces'][traceID] );
			    		if(missingTraces.length < 1) continue;
			    		
			    		// Get a reference to a non-live copy of all current Live Plots
			    		var staticPlots = JSON.parse(JSON.stringify(livePlots));
			    		
			    		for(newTrace of missingTraces) {
			    			// Make a copy of newTrace to avoid corrupting it with modifications
			    			var trace = JSON.parse(JSON.stringify(newTrace));
			    			
			    			// Initialize new trace to have empty data arrays
			    			trace.xData = [];
			    			trace.yData = [];
			    			
			    			// Put the new trace into place (in the non-live copy of Live Plots)
				    		staticPlots[plotID]['traces'][trace.traceID] = trace;
			    			
			    			// Put the new trace into place (possible option if you don't want to use staticPlots)
				    		//livePlots[plotID]['traces'][trace.traceID] = trace;
			    		}
			    		
			    		// Copy all changes over to Live Plots
			    		this.safeParseToVueVariable(staticPlots, livePlots);
			    	}	
			    },
			    addNewLiveData: function(livePlots, newPlotsData) {
			    	for(newPlot of newPlotsData) {
			    		var plotID = newPlot.plotID;
			    		
			    		for(traceID of Object.keys(newPlot.traces)) {
			    			var newTrace = newPlot.traces[traceID];
			    			
			    			livePlots[plotID].traces[traceID].xData.push(newTrace.xData);
			    			livePlots[plotID].traces[traceID].yData.push(newTrace.yData);
			    		}
			    	}
			    },
			    
			    //Base case: originalVar is a primitive, empty array/object
			    //originalVar must be an Array or plain object, with nested fields that
			    //are arrays, plain objects, or strings.
			    safeParseToVueVariable: function(originalVar, vueVar){
			      	//console.log("Starting safeParseToVueVariable() with originialVar as:");
			        //console.log(originalVar);
			        //console.log("--------");
			      	if(typeof(originalVar) == "string" || typeof(originialVar) == "number"){
			        	//Will only be here if the top-level object is a simple string. Will never be
			          //here through recursion because the string case in parseIterableObject() never
			          //calls safeParseToVueVariable()
			          //Do nothing.
			        }
			        else if(typeof(originalVar) == "object" && originalVar != null){
			        	if(Array.isArray(originalVar)){
			          	  this.parseIterableObject(originalVar.keys(), originalVar, vueVar);
			          }
			          else{
			          		this.parseIterableObject(Object.keys(originalVar), originalVar, vueVar);
			          }
			        }
			        else{
			        	console.log("Error in safeParseToVueVariable() -- attempted to convert unsupported data type.");
			        }
			      },
			      
			    parseIterableObject: function(indicesOrKeys, originalVar, vueVar){
			      		//fieldName may be index or key name
			           for(var fieldName of indicesOrKeys){
			            	if(typeof(originalVar[fieldName]) == "string" || typeof(originalVar[fieldName]) == "number"){
			                if(!vueVar.hasOwnProperty(fieldName)){
			                  Vue.set(vueVar, fieldName, originalVar[fieldName]);
			                }
			              }
			              else if(typeof(originalVar[fieldName]) == "object" && originalVar != null){
			              	if(Array.isArray(originalVar[fieldName])){
			                  if(!vueVar.hasOwnProperty(fieldName)){
			                  	Vue.set(vueVar, fieldName, []);
			                   }
			                  this.safeParseToVueVariable(originalVar[fieldName], vueVar[fieldName]);
			                }
			                else{
			                  if(!vueVar.hasOwnProperty(fieldName)){
			                  	Vue.set(vueVar, fieldName, {});
			                  }
			                	this.safeParseToVueVariable(originalVar[fieldName], vueVar[fieldName]);
			                }
			              }
			              else{
			              	console.log("Error in parseIterableObject() -- attempted to convert unsupported data type.");
			          		return;
			              }
			      		}
			      
			    },

				clearLivePlot: function(plot) {
					plot['traces'] = {};
				},
				clearLivePlots: function() {
					this.clearJobSelect();
					this.clearDeviceSelect();
					this.livePlots = {};
				},
				clearJobSelect: function() {
					this.jobSelectChoice = '';
					this.jobSelectActive = ''
					this.jobSelectItems = [];
				},
				clearDeviceSelect: function() {
					this.deviceSelectChoice = '';
					this.deviceSelectActive = '';
					this.deviceSelectItems = [];
				},

				toggleLivePlotYAxisLog: function(plot){
					if(plot.yScale === "linear"){
						plot.yScale = "log";
					}
					else if(plot.yScale === "log"){
						plot.yScale = "linear";
					}
				},

				extractPlotlyData: function(plot, specificTraces=undefined) {
					var dataTraces = [];
					for([traceID, trace] of Object.entries(plot.traces)){
						if(!specificTraces || specificTraces.includes(traceID)){
							dataTraces.push({
								type: 'scatter',
								name: trace.traceID,
								x: trace.xData,
								y: trace.yData,
								mode: (trace.mode)? trace.mode : plot.plotMode,
								visible: (trace.visible !== undefined)? trace.visible : true, 
								line:   {width: 3, dash: 'solid',  color: (trace.color)? trace.color : plot.color},
								marker: {size: 9, symbol:'circle', color: (trace.color)? trace.color : plot.color},
								//showlegend: true,
							});
						}
					}
					return dataTraces;
				},
				extractPlotlyLayout: function(plot) {
					 return {
						xaxis: { 
							autorange: (plot.xRange)? false : true,
							range: (plot.xRange)? plot.xRange : undefined,
							title: plot.xAxisTitle,
							
							zeroline: false,
							zerolinewidth: 1,
							showgrid: (plot.theme === 'dark')? false : true,
							gridwidth: 1,
							showline: true,
							linewidth: 2,
							linecolor: 'rgb(200,200,200)',
							showticklabels: true,
							ticks:'outside',
							tickwidth: 2,
							ticklen: 5,
							tickcolor: 'rgb(200,200,200)',
						}, 
						yaxis: {
							type: plot.yScale, 
							autorange: (plot.yRange)? false : true,
							range: (plot.yRange)? plot.yRange : undefined,
							title: plot.yAxisTitle, 
							
							zeroline: false,
							zerolinewidth: 1,
							showgrid: true,
							gridwidth: 1,
							showline: true,
							linewidth: 2,
							linecolor: 'rgb(200,200,200)',
							showticklabels: true,
							ticks:'outside',
							tickwidth: 2,
							ticklen: 5,
							tickcolor: 'rgb(200,200,200)',
						}, 
						legend: {
							y: 1.0,
							orientation: 'v', 
							font:{
								family: 'Arial',
								size: 12,
							},
						}, 
						paper_bgcolor: 'rgba(0,0,0,0)',
						plot_bgcolor: 'rgba(0,0,0,0)',
						margin: {l: 75, r: 20, b: 75, t: 20, pad: 1}, 
						automargin: true, 
						autosize: true, 
						font:{
							family: 'Arial',
							size: 12,
							color: (plot.theme === 'dark')? 'rgb(250,250,250)' : '',
						},
						exponentformat:'SI',
					};
				},

				// === Documentation ===

				initializeDocumentation: function() {
					var path = "/loadAllDocumentation" + this.cacheBust;
					this.getJSON(path, (response => {
						//Response is a list of dictionaries
						if(response.length == 0){
							this.documentationInfo.push({
								'text': '',
								'title': '',
								'edit_mode': false,
								'readonly': false,
							});
							this.documentationProposedInfo.push({
								'text': '',
								'title': '',
							});
						}
						for(var i = 0; i < response.length; i++){
							this.documentationInfo.push({
								'text': response[i]["text"],
								'title': response[i]["title"],
								'edit_mode': false,
								'readonly': (response[i]["readonly"])? response[i]["readonly"] : false,
							});
							this.documentationProposedInfo.push({
								'text': '',
								'title': '',
							});
						}
					}), "Error loading documentation");
				},
				
				documentationEdit: function(index) {
					this.documentationInfo[index]['edit_mode'] = true;
					this.documentationProposedInfo[index]['text']  = this.documentationInfo[index]['text'];
					this.documentationProposedInfo[index]['title'] = this.documentationInfo[index]['title'];
				},
				documentationSave: function(index) {
					this.documentationInfo[index]['edit_mode'] = false;
					this.documentationInfo[index]['text']  = this.documentationProposedInfo[index]['text'];
					this.documentationInfo[index]['title'] = this.documentationProposedInfo[index]['title'];

					var path = "/saveDocumentation/" + index + this.cacheBust;
					this.postJSON(path, JSON.stringify(this.documentationInfo[index]), (response => {console.log('Saved documentation file.')}), "Error saving documentation");
				},
				documentationCancel: function(index) {
					this.documentationInfo[index]['edit_mode'] = false;
				},

				addDocumentationEntry: function(index) {
					var indexToAdd = index + 1;
					this.documentationInfo.splice(indexToAdd, 0, {'text': "", 'title':"", 'edit_mode':false, 'readonly':false});
					this.documentationProposedInfo.splice(indexToAdd, 0, {'text': "", 'title':""});

					var path = "/addDocumentation/" + indexToAdd + this.cacheBust;
					this.getJSON(path, (response => {console.log("Added documentation entry.")}), "Error adding documentation entry");
					this.documentationSave(indexToAdd);
				},
				removeDocumentationEntry: function(index) {
					if(index != -1){
						this.documentationInfo.splice(index, 1);
						this.documentationProposedInfo.splice(index, 1);

						var path = "/removeDocumentation/" + index + this.cacheBust;
						this.getJSON(path, (response => {console.log("Removed documentation entry.")}), "Error removing documentation entry");
					}
				},
				moveDocumentationEntryUp: function(index) {
					var text = this.documentationInfo[index];
					this.documentationInfo.splice(index, 1);
					this.documentationInfo.splice(index-1, 0, text);

					var proposedText = this.documentationProposedInfo[index];
					this.documentationProposedInfo.splice(index, 1);
					this.documentationProposedInfo.splice(index-1, 0, proposedText);

					var indexMinusOne = index-1;
					var path = "/swapDocumentationFilenames/" + indexMinusOne + "/" + index + this.cacheBust;
					this.getJSON(path, (response => {console.log("Moved documentation entry up.")}), "Error moving documentation entry up");
				},
				moveDocumentationEntryDown: function(index) {
					var text = this.documentationInfo[index];
					this.documentationInfo.splice(index, 1);
					this.documentationInfo.splice(index+1, 0, text);

					var proposedText = this.documentationProposedInfo[index];
					this.documentationProposedInfo.splice(index, 1);
					this.documentationProposedInfo.splice(index+1, 0, proposedText);

					var indexPlusOne = index + 1;
					var path = "/swapDocumentationFilenames/" + index + "/" + indexPlusOne + this.cacheBust;
					this.getJSON(path, (response => {console.log("Moved documentation entry down.")}), "Error moving documentation entry down");
				},
				
				getDocumentationColor: function(title) {
					if(Object.keys(this.documentationThemes).includes(title)) return this.documentationThemes[title]['color'];
					return undefined;
				},
				getDocumentationIcon: function(title) {
					if(Object.keys(this.documentationThemes).includes(title)) return this.documentationThemes[title]['icon'];
					return undefined;
				},
				
				// === Linear Regression & Metric Extraction ===
				linearFit: function(x, y, includedFittedData=false) {					
					var fit_results = {}
					
					var n = (x.length < y.length)? x.length : y.length;
					var sum_x = 0;
					var sum_y = 0;
					var sum_xx = 0;
					var sum_xy = 0;
					
					for(var i = 0; i < n; i++) {
						sum_x += x[i];
						sum_y += y[i];
						sum_xx += (x[i]*x[i]);
						sum_xy += (x[i]*y[i]);
					}
					
					var mean_x = sum_x/n;
					var mean_y = sum_y/n;
					var ss_xx = sum_xx - n*mean_x*mean_x;
					var ss_xy = sum_xy - n*mean_x*mean_y;
					
					fit_results['slope']       = ss_xy/ss_xx;
					fit_results['y_intercept'] = mean_y - fit_results['slope']*mean_x;
					fit_results['x_intercept'] = -(fit_results['y_intercept']/fit_results['slope']);
					if(includedFittedData) fit_results['fitted_data'] = x.map(xval => (fit_results['slope']*xval + fit_results['y_intercept']));
					
					return fit_results;
				},
				semilogFit: function(x, y, includedFittedData=false) {
					var y_log = y.map(val => Math.log10(val));
					
					fit_results = this.linearFit(x, y_log, includedFittedData=includedFittedData);
					if(includedFittedData) fit_results['fitted_data'] = fit_results['fitted_data'].map(val => (Math.pow(10, val)));

					return fit_results;
				},
				sortByA: function(a, b) {					
					a_sorted = [];
					b_sorted = [];
					a.map((val, i) => ({'a':val, 'b':b[i]}))
						.sort((p1, p2) => ((p1.a < p2.a)? -1 : (p1.a === p2.a)? 0 : 1))
						.forEach(function (pair, i) {a_sorted.push(pair.a); b_sorted.push(pair.b);});
					return {'a_sorted':a_sorted, 'b_sorted':b_sorted};
				},
				sortByAbsoluteA: function(a, b) {					
					a_sorted = [];
					b_sorted = [];
					a.map((val, i) => ({'a':val, 'b':b[i]}))
						.sort((p1, p2) => ((Math.abs(p1.a) < Math.abs(p2.a))? -1 : (Math.abs(p1.a) === Math.abs(p2.a))? 0 : 1))
						.forEach(function (pair, i) {a_sorted.push(pair.a); b_sorted.push(pair.b);});
					return {'a_sorted':a_sorted, 'b_sorted':b_sorted};
				},
				steepestRegionFind: function(x, y, region_length) {
					// Assumes x is sorted in ascending order, then return the steepest region of the data
					
					var numberOfPoints = region_length;
					if(numberOfPoints === undefined) numberOfPoints = parseInt(3 + 2*parseInt(y.length/20));
					numberOfPoints = Math.max(2, numberOfPoints);
					
					var maxSlope = 0;
					var index = 0;
					for(var i = 0; i < y.length + 1 - numberOfPoints; i++) {
						slope = Math.abs((y[i+numberOfPoints] - y[i]) / (x[i+numberOfPoints] - x[i]));
						if(slope > maxSlope) { maxSlope = slope; index = i; }
					}
					
					var startIndex = index;
					var endIndex   = index + numberOfPoints - 1;
					
					return {'x_region':x.slice(startIndex, endIndex+1), 'y_region':y.slice(startIndex, endIndex+1)};
				},
				extremeValuesFind: function(x, y, threshold, condition) {
					// [Private method]: return the region of x/y that meets the given threshold/condition combination
					
					var startIndex = -1;
					var endIndex   = -1;
					for(var i = 0; i < y.length; i++) {
						y_value = Math.abs(y[i]);
						if(condition(y_value, threshold)) {
							if(startIndex === -1) startIndex = i;
							endIndex = i;
						}
					}
										
					if(startIndex === -1) return {'x_region':[], 'y_region':[]}
					
					return {'x_region':x.slice(startIndex, endIndex+1), 'y_region':y.slice(startIndex, endIndex+1)};
				},
				largestValuesFind: function(x, y, minimumFloor=1e-12, maximumFloor=1e-11) {
					// Assumes y is sorted in ascending order, then return the region of x/y that is "large" (>25% of max)
					
					var percentile = parseInt(y.length/50);
					var y_abs_min = Math.max(Math.abs(y[percentile])               , minimumFloor);
					var y_abs_max = Math.max(Math.abs(y[y.length - 1 - percentile]), maximumFloor);
					var max_min_ratio = y_abs_max/y_abs_min;
					
					//var threshold = Math.pow(max_min_ratio, 0.5) * y_abs_min;
					var threshold = 0.25 * y_abs_max;
				
					return this.extremeValuesFind(x, y, threshold, (val, thresh) => (val > thresh));
				
				},
				smallestValuesFind: function(x, y, minimumFloor=1e-12, maximumFloor=1e-11) {
					// Assumes y is sorted in ascending order, then return the region of x/y that is "small" (<90% of max on log scale)
					
					var percentile = parseInt(y.length/50);
					var y_abs_min = Math.max(Math.abs(y[percentile])               , minimumFloor);
					var y_abs_max = Math.max(Math.abs(y[y.length - 1 - percentile]), maximumFloor);
					var max_min_ratio = y_abs_max/y_abs_min;
					
					var threshold = Math.pow(max_min_ratio, 0.9) * y_abs_min;
					//var threshold = 10 * y_abs_min;
					
					return this.extremeValuesFind(x, y, threshold, (val, thresh) => ((val > minimumFloor) && (val < thresh)));
				},
				transferCurveFit: function(vgs_data, id_data, includedFittedData=false) {
					// Perform fit and metric extraction for gm, VT, SS from a transistor transfer curve
					
					//if(region_length === undefined) region_length = parseInt(3 + 2*parseInt(id_data.length/20));
					if(id_data.length < 3) return {};
					
					// Sort data by drain current
					var sorted_data = this.sortByAbsoluteA(id_data, vgs_data);
					var vgs_sorted = sorted_data['b_sorted'];
					var id_sorted = sorted_data['a_sorted'];
					
					// Find the largest drain currents
					var largest_region = this.largestValuesFind(vgs_sorted, id_sorted);
					var vgs_linear_region = largest_region['x_region'];
					var id_linear_region  = largest_region['y_region'];
					
					// Find the smallest drain currents
					var smallest_region = this.smallestValuesFind(vgs_sorted, id_sorted);
					var vgs_subthreshold_region = smallest_region['x_region'];
					var id_subthreshold_region  = smallest_region['y_region'];
					
					// Fit linear and subthreshold regions
					var linear_region_fit = this.linearFit(vgs_linear_region, id_linear_region, includedFittedData);
					var subthreshold_fit = this.semilogFit(vgs_subthreshold_region, id_subthreshold_region, includedFittedData);
					
					// Add fit results to relevant plots
					var gmTrace = 'gm';
					var vtTrace = 'VT';
					var ssTrace = 'SS';
					if(this.performanceMetricsShowOnPlot) {
						if(!Object.keys(this.performancePlots['Transfer Curve']['traces']).includes(gmTrace)) { 
							this.performancePlots['Transfer Curve']['traces'][gmTrace] = {
								'traceID':gmTrace,'xData':[],'yData':[],'color':'black','mode':'lines','fitIgnore':true,
							}; 
							this.performancePlots['Transfer Curve']['traces'][vtTrace] = {
								'traceID':vtTrace,'xData':[],'yData':[],'color':'black','mode':'markers','fitIgnore':true,
							}; 
							this.performancePlots['Subthreshold Curve']['traces'][ssTrace] = {
								'traceID':ssTrace,'xData':[],'yData':[],'color':'black','mode':'lines','fitIgnore':true,
							}; 
						}
						this.performancePlots['Transfer Curve']['traces'][gmTrace].xData = vgs_linear_region;
						this.performancePlots['Transfer Curve']['traces'][gmTrace].yData = linear_region_fit['fitted_data'];
						this.performancePlots['Transfer Curve']['traces'][vtTrace].xData = [linear_region_fit['x_intercept']];
						this.performancePlots['Transfer Curve']['traces'][vtTrace].yData = [0];
						this.performancePlots['Subthreshold Curve']['traces'][ssTrace].xData = vgs_subthreshold_region;
						this.performancePlots['Subthreshold Curve']['traces'][ssTrace].yData = subthreshold_fit['fitted_data'];
					} else if(Object.keys(this.performancePlots['Transfer Curve']['traces']).includes(gmTrace)) {
						this.performancePlots['Transfer Curve']['traces'][gmTrace].xData = [];
						this.performancePlots['Transfer Curve']['traces'][gmTrace].yData = [];
						this.performancePlots['Transfer Curve']['traces'][vtTrace].xData = [];
						this.performancePlots['Transfer Curve']['traces'][vtTrace].yData = [];
						this.performancePlots['Subthreshold Curve']['traces'][ssTrace].xData = [];
						this.performancePlots['Subthreshold Curve']['traces'][ssTrace].yData = [];
					}
					
					// Return metrics and fitted regions
					return {
						'gm':Math.abs(linear_region_fit['slope']), 
						'VT':linear_region_fit['x_intercept'], 
						'SS':1000 / Math.abs(subthreshold_fit['slope']),
						
						'linear_fitted_id_data':linear_region_fit['fitted_data'], 
						'linear_fitted_vgs_data':vgs_linear_region,
						'subthreshold_fitted_id_data':subthreshold_fit['fitted_data'], 
						'subthreshold_fitted_vgs_data':vgs_subthreshold_region,
					};
				},
				scale_and_units: function(value) {
					if(Math.abs(value) > 1)     return {scale: 1,    units: ''}; 
					if(Math.abs(value) > 1e-3)  return {scale: 1e3,  units: 'm'}; 
					if(Math.abs(value) > 1e-6)  return {scale: 1e6,  units: 'µ'}; 
					if(Math.abs(value) > 1e-9)  return {scale: 1e9,  units: 'n'}; 
					if(Math.abs(value) > 1e-12) return {scale: 1e12, units: 'p'}; 
					return {scale: 1e15, units: 'f'}; 
				},
				
			},
			watch: {
				// Keep "localStorage" up to date
				stepperPage:             function(val) { localStorage.stepperPage = JSON.stringify(val); },
				scheduleObjects:         function(val) { localStorage.scheduleObjects = JSON.stringify(val); },
				scheduleObjectClipboard: function(val) { localStorage.scheduleObjectClipboard = JSON.stringify(val); },
				disabledPlots:           function(val) { localStorage.disabledPlots = JSON.stringify(val); },
				
				// Experiment Runner user input
				runnerChoice:                 function(val) { this.runnerUpdateChoice(); },
				runnerFileName:               function(val) { this.runnerLoadScheduleFile(); },
				runnerToggleAdvancedSettings: function(val) { this.addAdvancedChangesToRunnerScheduleFile(); },
				
				// Dashboard user input
				recentActivityProject: function(val) { this.getRecentActivity(); },
				recentActivityWafer:   function(val) { this.getRecentActivity(); },
				recentActivityChip:    function(val) { this.getRecentActivity(); },
				recentActivityDevice:  function(val) { this.getRecentActivity(); },
				
				// Let python backend know anytime workspace directory is modified
				workspaceDataFolderPath: function(val) { this.setWorkspaceDataFolder(val); this.goToUser(''); },
				
				experimentIndex: function(val) { this.getAssociatedAFMs(); },
			},
			computed: {
				experiment: function() {
					if (this.experimentIndex > this.experiments.length) this.experimentIndex = 0;
					return this.experiments[this.experimentIndex];
				},
				experimentsWithIndexes: function() {
					return this.experiments.map((x, i) => { return {...x, i} });
				},
				scheduleLines: function() {
					var modifications = this.scheduleObjects.map(obj => objectDeepDiff(obj, this.scheduleObjectDefault));
					
					// --- Force the schedule file to include the parameters marked as "essential" in defaults.py ---
					var modifications_with_essentials = modifications.map(obj => {
						var essentialsToInclude = {};
						if(obj['runType'] && this.essentialScheduleParameters['runConfigs'] && this.essentialScheduleParameters['runConfigs'][obj['runType']['default']]) {
							essentialsToInclude['runConfigs'] = {};
							essentialsToInclude['runConfigs'][obj['runType']['default']] = this.essentialScheduleParameters['runConfigs'][obj['runType']['default']]
							this.scheduleObjectDefault['runConfigs'][obj['runType']['default']]['dependencies']['value'].forEach(function(dependency) {
								if(Object.keys(app.$data.essentialScheduleParameters['runConfigs']).includes(dependency)) {
									essentialsToInclude['runConfigs'][dependency] = app.$data.essentialScheduleParameters['runConfigs'][dependency]
								}
							});
						}
						return objectDeepInclude(obj, essentialsToInclude);
					});
					
					var scheduleFileEntries = modifications_with_essentials.map(obj => extractDefaults(obj));
					return scheduleFileEntries
				},
				runnerScheduleLines: function() {
					return this.runnerScheduleObjects.map(obj => extractDefaults(obj));
				},
				
				dynamicRecentActivityTableHeaders: function() {
					return this.recentActivityHeaders.filter(h => h.visible);
				},
				
				benchtopRefreshRate: function() {
					if(this.benchtop.refresh_rate > 1) return this.benchtop.refresh_rate;
					if(this.benchtop.refresh_rate > 0) return 1;
					return (10 ** (this.benchtop.refresh_rate/5)).toFixed(2);
				},
				
				performanceMetrics: function() {
					if(!this.performanceMetricsExtract) return {};
					var transferTraces = Object.entries(this.performancePlots['Transfer Curve']['traces'])
											   .filter(([key, value]) => !value.fitIgnore).map(([key, value]) => value);
					if(!transferTraces.length) return {};
					
					var N = transferTraces.length
					var transferFits = transferTraces.map(trace => 
											this.transferCurveFit(trace.xData, trace.yData, this.performanceMetricsShowOnPlot));
							
					var gm = transferFits.map( fit => fit['gm'] ).reduce((sum, elem) => sum+elem) / N; //Average Trace gm
					var VT = transferFits.map( fit => fit['VT'] ).reduce((sum, elem) => sum+elem) / N; //Average Trace VT
					var SS = transferFits.map( fit => fit['SS'] ).reduce((sum, elem) => sum+elem) / N; //Average Trace SS
					return {'gm':gm, 'SS':SS, 'VT':VT};
				},
				
				ptSensorMaxImpedance: function() {
					var impedanceTraces = Object.entries(this.ptSensorPlots['Impedance']['traces']).map(([key, value]) => value);
					if(!impedanceTraces.length) return;
					return Math.max( ...(impedanceTraces.map(trace => Math.max( ...(trace.yData) ))) );	
				},
				ptSensorTimeOfMaxImpedance: function() {
					function indexOfMax(arr) {
				    	var maxIndex = 0; var max = arr[0];
					    for (var i = 1; i < arr.length; i++) {
					        if (arr[i] > max) { maxIndex = i; max = arr[i]; }
					    }
					    return maxIndex;
					}
					
					var impedanceTraces = Object.entries(this.ptSensorPlots['Impedance']['traces']).map(([key, value]) => value);
					if(!impedanceTraces.length) return;
					
					var maxTrace = impedanceTraces.filter(trace => Math.max(...(trace.yData)) === this.ptSensorMaxImpedance)[0]
					return maxTrace.xData[indexOfMax(maxTrace.yData)];
				},
			},
			filters:{
				// === Generic Text Filters ===
				capitalize: function(value) {
					if(!value) return '';
					value = value.toString();
					return value.charAt(0).toUpperCase() + value.slice(1);	
				},
				
				// === Numerical Text Filters ===
				hideNull: function(value) {
					if(!value) return '';
					return value
				},
				decimalPrecision: function(value, places) {
					if(!value) return '';
					return parseFloat(value).toFixed(places)
				},
				scientificPrecision: function(value, sig_figs) {
					if(!value) return '';
					
					// Explicitly handle value === 0 or Infinity separately (does not work well with the following)
					if(value === 0) return 0;
					if(value === Infinity || value === -Infinity) return '';
					
					// Compute exponent
					exponent = 0;
					if(Math.abs(value) < 1e-3 || Math.abs(value) > 1e3) {
						while((Math.abs(value) < 1) && (exponent > -15)) {
							value *= 1e3;
							exponent -= 3;
						}
						while((Math.abs(value) > 1e3) && (exponent < 15)) {
							value /= 1e3;
							exponent += 3;
						}
					}
					
					// Convert from sig-figs to decimal places
					places = sig_figs; 
					if(Math.abs(value) > 1) places -= 1;
					if(Math.abs(value) > 10) places -= 1;
					if(Math.abs(value) > 100) places -= 1;
					places = Math.max(places, 0);
					
					if(exponent === 0) return parseFloat(value).toFixed(places);
					return parseFloat(value).toFixed(places) + 'e' + exponent;
				},
				withUnits: function(value, units) {
					if(!value) return '';
					return value + units;
				},
				
				// === Specialized GUI Object Text Filters ===
				formatTimestamp: function(value) {
					if(!value) return '';
					value = parseFloat(value)
					hours = Math.floor(value/3600)
					value %= 3600
					minutes = Math.floor(value/60)
					value %= 60
					seconds = value
					return hours + ':' + ('0' + minutes).slice(-2) + ':' + ('0' + seconds.toFixed(2)).slice(-5);
				},
				formatCounter: function(value) {
					if(!value) return '';
					if(value > 200) value = 10*(Math.floor(value/10));
					return value;
				},
				formatFolderBaseName: function(value) {
					if(!value) return 'Data Folder';
					var folders = value.split('/'); // TODO: make this work for windows file separators
					var base = folders[folders.length - 1];
					if(!base && (folders.length > 1)) base = folders[folders.length - 2];
					return base + '/';
				},
				
				// === Dynamic Units ===
				formatVoltage: function(value) {
					if(value == undefined) return '';
					var units = " V";
					if(value < 0.9) {
						value *= 1e3;
						units = " mV";
					}
					return value + units;	
				},
				formatConductance: function(value) {
					if(value == undefined) return '';
					var units = " S";
					if(value < 1) {
						value *= 1e3;
						units = " mS";
					}
					if(value < 1) {
						value *= 1e3;
						units = " uS";
					}
					if(value < 1) {
						value *= 1e3;
						units = " nS";
					}
					return value + units;	
				},
				formatFileSize: function(value) {
					if(value == undefined) return '';
					var units = " bytes"
					if(value > 1e3) {
						value /= 1e3
						units = " KB"
					}
					if(value > 1e3) {
						value /= 1e3
						units = " MB"
					}
					if(value > 1e3) {
						value /= 1e3
						units = " GB"
					}
					return value.toFixed(0) + units
				},
			}
		});
		
		console.log('Vuetify app built.');
		
		// colors: ['#F4FFFD', '#E3E4DB', '#EDF4ED', '#CCDAD1', '#9CAEA9', '#8C9A9E', '#788585', '#656565', '#4C5760', '#2B3D41', '#1E3231'],
		// colors: ['#F0F7F4', '#9EC1A3', '#70A9A1', '#679289', '#40798C', '#B3BFB8', '#7E8D85', '#9AA0A8', '#465362', '#011936', '#673C4F'],
		
		// === Define Color Scheme ===
		
		// --- THEMES ---
		
		// Old theme
		app.$vuetify.theme.themes.light.primary = '#557A95';
		app.$vuetify.theme.themes.light.secondary = '#938E94';
		app.$vuetify.theme.themes.light.tertiary = '#0074E1';
		app.$vuetify.theme.themes.light.accent = '#7395AE';
		app.$vuetify.theme.themes.light.error = '#e83b2b';
		app.$vuetify.theme.themes.light.success = '#43a446';
		app.$vuetify.theme.themes.light.info = '#becdd9';
		app.$vuetify.theme.themes.light.warning = '#fe9100';
		
		// Mint theme
		app.$data.colors = ['#05386B', '#379683', '#5CDB95', '#8EE4AF', '#EDF5E1'];
		
		// Teals theme
		app.$data.colors = ['#10E7DC', '#0074E1', '#1B9CE5', '#6CDAEE', '#F79E02'];
		
		// Blue Red Theme
		app.$data.colors = ['#314455', '#644E5B', '#9E5A63', '#C96567', '#97AABD'];
		
		// Diverse pastels theme
		app.$data.colors = ['#E27D60','#85CDCB','#E8A87C','#C38D9E','#41B3A3']
		
		// Diverse pastels theme 2
		app.$data.colors = ['#A3D9FF','#96E6B3','#7E6B8F','#DA3E52','#F2E94E']
		
		// Diverse strongs theme
		app.$data.colors = ['#08415C','#436436','#CC5803','#4E0250','#721121','#403F4C']
		
		// Diverse strongs theme 2
		app.$data.colors = ['#235789','#A82919','#96437F','#DB7C00','#368254']
		
		// Diverse strongs theme 2 adjusted to 45% brightness
		app.$data.colors = ['#2f75b6','#c8321e','#9e4786','#e68200','#44a269']
		
		// Diverse pastels theme 2 adjusted to roughly 40% brightness
		app.$data.colors = ['#0077cc','#27a555','#9755ce','#b42236','#d19a10']
		
		// Mint theme adjusted
		app.$data.colors = ['#05386B', '#379683', '#5CDB95', '#8EE4AF', '#EDF5E1'];
		
		// Dark Business Theme
		app.$data.colors = ['#5981a6', '#509593', '#595ea6', '#3973ac', '#457da1'];
		
		// Final Theme 	   [grey-blue,   green  ,  purple  ,   blue   ,   gold   ,  orange  , blue-purp, red-purp ,   ]
		app.$data.colors = ['#5981A6', '#008888', '#595EA6', '#3973AC', '#C18C00', '#FBA100', '#3F51B5', '#880E7F',   ];
		
		// --- Apply Theme --- 
		
		for (var i = 0; i < app.$data.colors.length; i++) {
			app.$vuetify.theme.themes.light['color' + (i + 1)] = app.$data.colors[i];
		}
		app.$vuetify.theme.themes.light.primary = app.$vuetify.theme.themes.light.color3;
		app.$vuetify.theme.themes.light.secondary = app.$vuetify.theme.themes.light.color2;
		app.$vuetify.theme.themes.light.accent = app.$vuetify.theme.themes.light.color1;
		app.$vuetify.theme.themes.light.tertiary = app.$vuetify.theme.themes.light.color4;
		app.$vuetify.theme.themes.light.error = '#BF360C';
		app.$vuetify.theme.themes.light.success = '#00897B';
		app.$vuetify.theme.themes.light.info = '#BECDD9';
		app.$vuetify.theme.themes.light.warning = '#FFB300';
		
		// --- Custom Color Keywords ---
		
		app.$vuetify.theme.themes.light['color_base'] = app.$vuetify.theme.themes.light.color1;
		app.$vuetify.theme.themes.light['color_builder'] = app.$vuetify.theme.themes.light.color2;
		app.$vuetify.theme.themes.light['color_runner'] = app.$vuetify.theme.themes.light.color3;
		app.$vuetify.theme.themes.light['color_browser'] = app.$vuetify.theme.themes.light.color4;
		app.$vuetify.theme.themes.light['color_documentation'] = app.$vuetify.theme.themes.light.color5;
		app.$vuetify.theme.themes.light['color_benchtop'] = app.$vuetify.theme.themes.light.color6;
			
		app.$vuetify.theme.themes.light['color_performance'] = app.$vuetify.theme.themes.light.color7;
		app.$vuetify.theme.themes.light['color_ptsensor'] = app.$vuetify.theme.themes.light.color7;
				
		// colors = {
		// 	'dark': {
		// 		'japanese indigo': '2B3D41',
		// 		'deep space sparkle': '4C5F6B',
		// 		'weldon blue': '83A0A0',
		// 		'spanish grey': '969696',
		// 		'dim grey': '67697C',
		// 		'dark medium grey': 'AAAAAA',
		// 	}
		// 	'light': {
		// 		'platinum': 'DFE0E2',
		// 	}
		// };
		// colors2 = ['EDF4ED', 'E3E4DB', 'CCDAD1', '9CAEA9', '8C9A9E', '788585', '656565', '4C5760', '2A2B2A', '323031', '1E3231', '2B3D41', '1D1E18'];
		
		// '93B7BE', 'D4F5F5', '2B3D41', '8C9A9E', '747578', '041B15', '586A6A', '757780', '303633', '627264', '788475', '28536B', '817F82', 'B4B8AB', '9CAEA9', '788585'
		// 'F7F7F2', 'FCF7F8', 'C4DACF', 'F4F9E9', 'BBCBCB', 'FFFFFC', 'CCDAD1'
		// 'FFFACC', 'B5D6B2', 
		// 'D0D1AC', 'DDE0BD'
		
		function updateConnectionStatus() {
			app.$set(app, 'online', navigator.onLine);
		}

		window.addEventListener('online', updateConnectionStatus);
		window.addEventListener('offline', updateConnectionStatus);
		window.onhashchange = function() { app.$data.currentPage = location.hash; };
		
		if (typeof(Storage) !== 'undefined') {
			localStorage.exists = JSON.stringify('True');
		}
		
		// Finish getting everything ready to go
		app.initialize();
		
	</script>
</body>
</html>


