<script type="text/html" id="a-progress-bar-timed">
	
	<v-list-tile v-if="visible">
		
		<v-list-tile-content style="flex-direction:row;align-items:center;" class="mr-3">
			<v-list-tile-title>{{title}} {{valuecurrent}} of {{valuemaximum}} </v-list-tile-title>
			<v-progress-linear class="roundedcorners" height="10" color="success" v-model="progressPercent"></v-progress-linear>
		</v-list-tile-content>
		
		<v-list-tile-action style="text-align:right;">	
			<v-list-tile-sub-title>{{time | formatTimestamp}}</v-list-tile-sub-title>
		</v-list-tile-action>
	
	</v-list-tile>
	
</script>

<script type="text/javascript">
	Vue.component('a-progress-bar-timed', {
		template: '#a-progress-bar-timed',
		props: ['visible', 'title', 'time', 'valuestart', 'valuecurrent', 'valuemaximum'],
		filters:{
			formatTimestamp: function(value) {
				if(!value) return '';
				value = parseFloat(value)
				//hours = Math.floor(value/3600)
				//value %= 3600
				minutes = Math.floor(value/60)
				value %= 60
				seconds = value
				return ('0' + minutes).slice(-2) + ':' + ('0' + seconds.toFixed(2)).slice(-5);
			}
		},
		computed:{
			progressPercent: function() {
				if(!this.valuecurrent || !this.valuemaximum) return;
				
				if(this.valuestart){ 
					return (this.valuecurrent - this.valuestart)/(this.valuemaximum - this.valuestart)*100;
				} 
				
				return (this.valuecurrent)/(this.valuemaximum)*100;
			}
		},
	});
</script>

